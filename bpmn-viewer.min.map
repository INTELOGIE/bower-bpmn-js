{"version":3,"file":"bpmn-viewer.min.js","sources":["bpmn-viewer.js"],"names":["e","exports","module","define","amd","f","window","global","self","BpmnJS","t","n","r","s","o","u","a","require","i","Error","call","length",1,"_dereq_","failSafeAsync","fn","args","Array","prototype","slice","arguments","done","_","isFunction","apply","this",2,"getSvgContents","diagram","outerNode","get","getContainer","svg","innerHTML","replace","initListeners","listeners","events","forEach","l","on","event","handler","checkValidationError","err","pattern","match","exec","message","Viewer","options","parent","container","$","addClass","css","position","appendTo","logoData","bottom","right","zIndex","attr","Diagram","BpmnModel","Importer","util","importXML","xml","fromXML","definitions","importDefinitions","saveXML","toXML","SVG_HEADER","SVG_FOOTER","saveSVG","svgContents","name","invoke","clear","_createDiagram","modules","_init","importBpmnDiagram","__listeners","concat","getModules","unshift","bpmnjs","canvas","_modules","destroy","push","./Util","./core","./draw","./import/Importer","bpmn-moddle","diagram-js","diagram-js/lib/features/selection",3,"BpmnTreeWalker","contextual","ctx","is","element","type","$instanceOf","visit","gfx","id","visitRoot","root","visitIfDi","di","logError","context","error","registerDi","bpmnElement","diRefs","bind","$type","handleDiagram","handlePlane","plane","planeElement","handlePlaneElement","handleDefinitions","diagrams","indexOf","rootElement","handleProcess","handleCollaboration","handleUnhandledProcesses","rootElements","process","handleFlowElementsContainer","handleIoSpecification","ioSpecification","handleArtifacts","artifacts","handledProcesses","processes","filter","laneSets","handleMessageFlow","messageFlow","handleMessageFlows","messageFlows","handleDataAssociation","association","handleDataInput","dataInput","handleDataOutput","dataOutput","handleArtifact","artifact","dataInputs","dataOutputs","handleSubProcess","subProcess","handleFlowNode","flowNode","childCtx","dataInputAssociations","dataOutputAssociations","handleSequenceFlow","sequenceFlow","handleDataElement","dataObject","handleBoundaryElement","handleLane","lane","newContext","childLaneSet","handleLaneSet","filterList","flowNodeRef","handleFlowElements","laneSet","lanes","handleLaneSets","handleNonFlowNodes","flowElements","sequenceFlows","boundaryEvents","handleParticipant","participant","newCtx","processRef","collaboration","participants","Refs","enumerable","object-refs",4,"importer","warnings","visitor","add","parentShape","walker","./BpmnTreeWalker",5,"BpmnImporter","eventBus","elementFactory","_eventBus","_canvas","_elementFactory","hasExternalLabel","isExpanded","$inject","semantic","parentElement","createRoot","collapsed","hidden","createShape","addShape","createConnection","addConnection","addLabel","fire","label","createLabel","../util/Di","../util/Label",6,"ElementFactory","LabelUtil","getExternalLabelBounds","create","extend","businessObject","labelBounds","labelData","labelTarget","attrs","bounds","shapeData","x","y","width","height","waypoints","collect","waypoint","p",7,"bpmnImporter","./BpmnImporter","./ElementFactory",8,"BpmnRenderer","styles","pathMap","addMarker","markers","marker","initMarkers","paper","createMarker","fill","strokeWidth","strokeLinecap","strokeDasharray","ref","scale","markerWidth","markerHeight","path","circle","stroke","computeStyle","custom","traits","defaultStyles","isArray","style","drawCircle","offset","isObject","cx","cy","Math","round","drawRect","rect","drawDiamond","x_2","y_2","points","polygon","drawLine","flattenPoints","polyline","drawPath","d","as","handlers","renderer","renderEventContent","getSemantic","isThrowing","isThrowEvent","isTypedEvent","parallelMultiple","renderLabel","labelUtil","renderEmbeddedLabel","align","box","renderExternalLabel","fontSize","renderLaneLabel","text","textBox","top","transform","createPathFromWaypoints","pathData","attachTaskMarkers","taskMarkers","obj","subprocess","contains","seq","parallel","compensation","loop","adhoc","loopCharacteristics","undefined","isSequential","isForCompensation","drawShape","h","DefaultRenderer","drawConnection","renderDataItemCollection","yPosition","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","mx","my","isCollection","elementObjectRef","getDi","eventDefinitionType","matches","definition","all","val","key","any","eventDefinitions","TASK_BORDER_RADIUS","INNER_OUTER_DIST","LABEL_STYLE","fontFamily","size","bpmn:Event","bpmn:StartEvent","isInterrupting","bpmn:MessageEventDefinition","messagePath","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:LinkEventDefinition","bpmn:ErrorEventDefinition","bpmn:CancelEventDefinition","bpmn:CompensateEventDefinition","bpmn:SignalEventDefinition","bpmn:MultipleEventDefinition","bpmn:ParallelMultipleEventDefinition","bpmn:EndEvent","bpmn:TerminateEventDefinition","bpmn:IntermediateEvent","outer","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:Activity","bpmn:Task","bpmn:ServiceTask","task","pathDataBG","abspos","fillPathData","bpmn:UserTask","pathData2","pathData3","bpmn:ManualTask","bpmn:SendTask","bpmn:ReceiveTask","instantiate","bpmn:ScriptTask","bpmn:BusinessRuleTask","headerPathData","businessHeaderPath","headerData","businessPath","bpmn:SubProcess","expanded","DiUtil","isEventSubProcess","triggeredByEvent","bpmn:AdHocSubProcess","bpmn:Transaction","innerAttrs","bpmn:CallActivity","bpmn:Participant","expandedPool","isExpandedPool","text2","participantMultiplicity","bpmn:Lane","bpmn:InclusiveGateway","diamond","bpmn:ExclusiveGateway","bpmn:ComplexGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway","drawEvent","eventGatewayType","parallelPath","innerCircle","bpmn:Gateway","bpmn:SequenceFlow","markerEnd","source","sourceRef","conditionExpression","markerStart","default","bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:MessageFlow","messageVisibleKind","midPoint","getPointAtLength","getTotalLength","markerPathData","messageAttrs","bpmn:DataObject","elementObject","bpmn:DataObjectReference","bpmn:DataInput","arrowPathData","getRawPath","bpmn:DataOutput","bpmn:DataStoreReference","DATA_STORE_PATH","elementStore","bpmn:BoundaryEvent","cancel","cancelActivity","bpmn:Group","pointerEvents","bpmn:TextAnnotation","textPathData","ParticipantMultiplicityMarker","subProcessPath","SubProcessMarker","markerRect","ParallelMarker","SequentialMarker","sequentialPath","CompensationMarker","compensationPath","LoopMarker","loopPath","strokeMiterlimit","AdhocMarker","Object","diagram-js/lib/draw/Renderer","diagram-js/lib/util/LabelUtil",9,"PathMap","Snap","EVENT_MESSAGE","heightElements","widthElements","EVENT_SIGNAL","EVENT_ESCALATION","EVENT_CONDITIONAL","EVENT_LINK","EVENT_ERROR","EVENT_CANCEL_45","EVENT_COMPENSATION","EVENT_TIMER_WH","EVENT_MULTIPLE","EVENT_PARALLEL_MULTIPLE","GATEWAY_EXCLUSIVE","GATEWAY_PARALLEL","GATEWAY_EVENT_BASED","GATEWAY_COMPLEX","DATA_OBJECT_PATH","DATA_OBJECT_COLLECTION_PATH","DATA_ARROW","DATA_STORE","TEXT_ANNOTATION","MARKER_SUB_PROCESS","MARKER_PARALLEL","MARKER_SEQUENTIAL","MARKER_COMPENSATION","MARKER_LOOP","MARKER_ADHOC","TASK_TYPE_SEND","TASK_TYPE_SCRIPT","TASK_TYPE_USER_1","TASK_TYPE_USER_2","TASK_TYPE_USER_3","TASK_TYPE_MANUAL","TASK_TYPE_INSTANTIATING_SEND","TASK_TYPE_SERVICE","TASK_TYPE_SERVICE_FILL","TASK_TYPE_BUSINESS_RULE_HEADER","TASK_TYPE_BUSINESS_RULE_MAIN","MESSAGE_FLOW_MARKER","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","format",10,"__depends__","../core","./BpmnRenderer","./PathMap",11,12,"getWaypointsMid","mid","first","floor","second","ceil","max",13,"./lib/model/Simple",14,"createModel","packages","Moddle","Bpmn","xmlStr","typeName","callback","isString","reader","Reader","model","rootHandler","result","writer","Writer","instance","moddle","moddle-xml",15,"BpmnModdle","bpmn","bpmndi","dc","../../resources/bpmn/json/bpmn.json","../../resources/bpmn/json/bpmndi.json","../../resources/bpmn/json/dc.json","../../resources/bpmn/json/di.json","../Bpmn",16,"./lib/Reader","./lib/Writer",17,"parseNodeAttributes","node","nodeAttrs","attributes","reduce","v","ns","local","parseNameNs","prefix","value","normalizeNamespaces","defaultNsUri","uri","pkg","getPackage","Context","parseRoot","elementsById","references","addReference","reference","addElement","addWarning","w","BaseHandler","BodyHandler","ReferenceHandler","property","ValueHandler","propertyDesc","BaseElementHandler","ElementHandler","getType","GenericElementHandler","XMLReader","resolveReferences","$descriptor","propertiesByName","isMany","collection","idx","splice","set","parser","sax","xmlns","trim","stack","Stack","onerror","onopentag","peek","handleNode","line","column","ontext","oncdata","handleText","onclosetag","old","pop","handleEnd","onend","getElement","write","close","common","Types","types","parseName","aliasToName","body","createReference","coerceType","handleChild","createElement","descriptor","bodyProperty","Type","prop","isReference","getPropertyForElement","nameNs","propertyName","localName","$pkg","elementType","find","properties","isVirtual","isAttribute","hasType","effectiveType","toString","valueHandler","referenceHandler","childHandler","isSimple","newElement","$parent","createAny","children","$children","$body","./common","tiny-stack",18,"nsName","getElementNs","isGeneric","nameToAlias","getPropertyNs","getSerializableProperties","hasOwnProperty","escapeAttr","str","escapeMap","\n","\n\r","\"","filterAttributes","props","isAttr","filterContained","ReferenceSerializer","BodySerializer","ValueSerializer","ElementSerializer","TypeSerializer","SavingWriter","FormatingWriter","out","indent","append","appendNewLine","appendIndent","join","unindent","XMLWriter","tree","internalWriter","formatingWriter","preamble","XML_PREAMBLE","build","serializeTo","CDATA_ESCAPE","DEFAULT_NS_MAP","serializeValue","escape","test","otherAttrs","parseNsAttributes","nsTagName","parseGeneric","parseAttributes","parseContainments","parseGenericAttributes","effectiveNs","logNamespaceUsed","nsPropertyTagName","isLocalNs","nsAttributeName","child","genericAttrs","$attrs","logNamespace","addAttribute","console","warn","isBody","asType","serialize","serializer","getNamespaces","namespaces","prefixMap","uriMap","used","existing","$model","serializeAttributes","collectNsAttrs","hasBody","b","typeNs",19,"capitalize","string","charAt","toUpperCase","lower","toLowerCase","hasLowerCaseAlias","alias","xsi",20,"./lib/moddle","./lib/ns","./lib/types",21,"Base",22,"DescriptorBuilder","allTypes","pick","addProperty","addNamedProperty","replaceProperty","oldProperty","newProperty","oldNameNs","setBodyProperty","redefineProperty","nsPrefix","parts","redefines","split","attrName","redefinedProperty","validate","propsByName","assertNotDefined","removeNamedProperty","addIdProperty","definedProperty","definedBy","hasProperty","addTrait","defineProperty","./ns",23,"Factory","createType","ModdleElement","writable","defineModel","defineDescriptor","./base",24,"Properties","factory","registry","Registry","typeCache","cache","getEffectiveDescriptor","nsUri","uriOrPrefix","getPackages","getElementDescriptor","getPropertyDescriptor","./factory","./properties","./registry","./types",25,"defaultPrefix",26,"target",27,"generateId","packageMap","typeMap","registerPackage","registerType","propertyNs","isBuiltIn","definePackage","mapTypes","iterator","superClass","cls","parentNs","builder","./descriptor-builder",28,"BUILTINS","String","Boolean","Integer","Real","Element","TYPE_CONVERTERS","parseInt","parseFloat","converter",29,"TinyStack","data","arg",30,31,32,33,34,35,36,37,38,39,"associations","isAbstract","emumerations","literalValues",40,41,42,"isReadOnly","isUnique","subsettedProperty",43,"./lib/Diagram",44,"bootstrap","bootstrapModules","hasModule","m","addModule","__init__","c","components","injector","Injector","createInjector","configModule","config","coreModule","didi",45,"number","resolution","ensurePx","isNumber","createContainer","document","setAttribute","appendChild","Canvas","graphicsFactory","elementRegistry","snap","createPaper","sendToFront","shape","bubble","getGraphics","gfxParent","remove","getGraphicsByElement","getRoot","_snap","_elementRegistry","_graphicsFactory","_container","_paper","_root","group","class","parentNode","removeChild","updateShape","updateConnection","setCTM","mstr","Model","_ensureValidId","getById","connection","_removeElement","removeShape","removeConnection","_fireViewboxChange","viewbox","innerBox","matrix","outerBox","getSize","Matrix","translate","getBBox","localMatrix","inner","scroll","delta","getCTM","dx","dy","createSVGMatrix","multiply","zoom","newScale","center","vbox","min","_setZoom","centerPoint","originalPoint","currentMatrix","scaleMatrix","newMatrix","viewport","point","createSVGPoint","currentScale","matrixTransform","inverse","clientWidth","clientHeight","getAbsoluteBBox","transformBBox","bbox","../model","../util/Collections",46,"ElementRegistry","graphicsMap","elementMap","getByGraphics",47,"EventBus","getListeners","listenerMap","extendEvent","stopPropagation","propagationStopped","preventDefault","defaultPrevented","isPropagationStopped","isDefaultPrevented","priority","EventPriority","standard","addEventToArray","once","wrappedCallback","eventType","off","listener","shift","array","sort","overwrite",48,"gfxContainer","clearVisual","oldVisual","select","newVisual","before","createContainerFactory","GraphicsFactory","_renderer","createSnapAt","gfxGroup",49,"../draw","./Canvas","./ElementRegistry","./EventBus","./GraphicsFactory",50,"Renderer","CONNECTION_STYLE","SHAPE_STYLE",51,"snapsvg","./snapsvg-extensions",52,"Styles","defaultTraits","no-fill","no-border","strokeOpacity","no-events","className","additionalAttrs","inject",53,"./Renderer","./Snap","./Styles",54,"plugin","getClasses","setClasses","classes","current","hasClass","removeClass","createElementNS",55,"InteractionEvents","isCtxSwitch","relatedTarget","baseEvent","eventName","makeSelectable","hit","visual","GraphicsUtil","getVisual","clone","HIT_STYLE","prependTo","hover","click","dblclick","registerEvents","../../util/GraphicsUtil",56,"interactionEvents","./InteractionEvents",57,"Outline","createOutline","OUTLINE_STYLE","updateOutline","outline","OUTLINE_OFFSET",58,"./Outline",59,"Selection","getSelection","selectedElements","isSelected","elements","oldSelection","newSelection","deselect",60,"SelectionVisuals","selection","removeMarker","HOVER_CLS","SELECTED_CLS","shiftKey","srcElement",61,"selectionVisuals","../interaction-events","../outline","./Selection","./SelectionVisuals",62,"parentRefs","labelRefs","outgoingRefs","incomingRefs","Shape","Root","Label","Connection",63,64,65,"parseAlign","horizontal","vertical","parsePadding","padding","left","layoutNext","lines","fit","fitLine","originalLine","nextLine","remainder","textBBox","getTextBBox","textElement","semanticShorten","maxLength","part","shortenedParts","shortenLine","maxWidth","shortenedLine","approximateLength","merge","layouted","totalHeight","sum","DEFAULT_LABEL_SIZE","DEFAULT_BOX_PADDING",66,"annotate","FN_ARGS","FN_ARG","parse","map",67,"Module","./annotation","./injector","./module",68,"autoAnnotate","currentlyResolving","providers","_providers","instances","_instances","msg","pivot","returned","dependencies","dep","createPrivateInjectorFactory","privateChildInjector","createChild","forceNewInstances","provider","cacheIdx","privateChildInjectorFactory","fromParentModule","matchedScopes","privateInjectorsCache","privateChildInjectors","privateChildFactories","$scope","scope","factoryMap","arrayUnwrap","__exports__","clonedModule","keys","substring","privateInjector","__modules__","getFromPrivateInjector",69,70,"Collection","./lib/collection","./lib/refs",71,"refs","inverseProperty","unset",72,"defineCollectionProperty","_value","ensureBound","./collection",73,74,75],"mappings":"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","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.BpmnJS=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\nvar _  = (window._);\r\n\r\nfunction failSafeAsync(fn) {\r\n\r\n  return function() {\r\n\r\n    var args = Array.prototype.slice.call(arguments);\r\n\r\n    var done = args[args.length - 1];\r\n    if (!done || !_.isFunction(done)) {\r\n      done = function(e) {\r\n        throw e;\r\n      };\r\n    }\r\n\r\n    try {\r\n      fn.apply(this, args);\r\n    } catch (e) {\r\n      done(e);\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports.failSafeAsync = failSafeAsync;\n},{}],2:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Diagram = _dereq_('diagram-js'),\r\n    BpmnModel = _dereq_('bpmn-moddle'),\r\n    $ = (window.$),\r\n    _ = (window._);\r\n\r\nvar Importer = _dereq_('./import/Importer'),\r\n    util = _dereq_('./Util');\r\n\r\n\r\nfunction getSvgContents(diagram) {\r\n  var outerNode = diagram.get('canvas').getContainer();\r\n\r\n  var svg = outerNode.innerHTML;\r\n  return svg.replace(/^<svg[^>]*>|<\\/svg>$/g, '')\r\n            .replace('<desc>Created with Snap</desc>', '')\r\n            .replace(/<g class=\"viewport\"( transform=\"[^\"]*\")?/, '<g');\r\n}\r\n\r\nfunction initListeners(diagram, listeners) {\r\n  var events = diagram.get('eventBus');\r\n\r\n  listeners.forEach(function(l) {\r\n    events.on(l.event, l.handler);\r\n  });\r\n}\r\n\r\nfunction checkValidationError(err) {\r\n\r\n  // check if we can help the user by indicating wrong BPMN 2.0 xml\r\n  // (in case he or the exporting tool did not get that right)\r\n\r\n  var pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\r\n  var match = pattern.exec(err.message);\r\n\r\n  if (match) {\r\n    err.message =\r\n      'unparsable content <' + match[1] + '> detected; ' +\r\n      'this may indicate an invalid BPMN 2.0 diagram file' + match[2];\r\n  }\r\n\r\n  return err;\r\n}\r\n\r\n/**\r\n * @class\r\n *\r\n * A viewer for BPMN 2.0 diagrams\r\n *\r\n * @param {Object} [options] configuration options to pass to the viewer\r\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\r\n * @param {String|Number} [options.width] the width of the viewer\r\n * @param {String|Number} [options.height] the height of the viewer\r\n */\r\nfunction Viewer(options) {\r\n  this.options = options = options || {};\r\n\r\n  var parent = options.container || $('body');\r\n\r\n  var container = $('<div></div>').addClass('bjs-container').css({\r\n    position: 'relative'\r\n  }).appendTo(parent);\r\n\r\n  _.forEach([ 'width', 'height' ], function(a) {\r\n    if (options[a]) {\r\n      container.css(a, options[a]);\r\n    }\r\n  });\r\n\r\n  // unwrap jquery\r\n  this.container = container.get(0);\r\n\r\n  /**\r\n   * The code in the <project-logo></project-logo> area\r\n   * must not be changed, see http://bpmn.io/license for more information\r\n   *\r\n   * <project-logo>\r\n   */\r\n\r\n  /* jshint -W101 */\r\n\r\n  // inlined ../resources/bpmnjs.png\r\n  var logoData = 'iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC';\r\n\r\n  /* jshint +W101 */\r\n\r\n  var a = $('<a href=\"http://bpmn.io\" target=\"_blank\" class=\"bjs-powered-by\" title=\"Powered by bpmn.io\" />').css({\r\n    position: 'absolute',\r\n    bottom: 15,\r\n    right: 15,\r\n    zIndex: 100\r\n  });\r\n\r\n  var logo = $('<img/>').attr('src', 'data:image/png;base64,' + logoData).appendTo(a);\r\n\r\n  a.appendTo(container);\r\n\r\n  /* </project-logo> */\r\n}\r\n\r\nViewer.prototype.importXML = function(xml, done) {\r\n\r\n  var self = this;\r\n\r\n  BpmnModel.fromXML(xml, 'bpmn:Definitions', function(err, definitions) {\r\n\r\n    if (err) {\r\n      err = checkValidationError(err);\r\n      return done(err);\r\n    }\r\n\r\n    self.importDefinitions(definitions, done);\r\n  });\r\n};\r\n\r\nViewer.prototype.saveXML = function(options, done) {\r\n\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  var definitions = this.definitions;\r\n\r\n  if (!definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  BpmnModel.toXML(definitions, options, function(err, xml) {\r\n    done(err, xml);\r\n  });\r\n};\r\n\r\n\r\nvar SVG_HEADER =\r\n'<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n'<!-- created with bpmn-js / http://bpmn.io -->\\n' +\r\n'<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n'<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\">\\n';\r\n\r\nvar SVG_FOOTER = '</svg>';\r\n\r\nViewer.prototype.saveSVG = function(options, done) {\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  if (!this.definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  var svgContents = getSvgContents(this.diagram);\r\n\r\n  var svg = SVG_HEADER + svgContents + SVG_FOOTER;\r\n\r\n  done(null, svg);\r\n};\r\n\r\nViewer.prototype.get = function(name) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.get(name);\r\n};\r\n\r\nViewer.prototype.invoke = function(fn) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.invoke(fn);\r\n};\r\n\r\nViewer.prototype.importDefinitions = util.failSafeAsync(function(definitions, done) {\r\n\r\n  var diagram = this.diagram;\r\n\r\n  if (diagram) {\r\n    this.clear();\r\n  }\r\n\r\n  this.diagram = diagram = this._createDiagram(this.options.modules);\r\n  this.definitions = definitions;\r\n\r\n  this._init(diagram);\r\n\r\n  Importer.importBpmnDiagram(diagram, definitions, done);\r\n});\r\n\r\nViewer.prototype._init = function(diagram) {\r\n  initListeners(diagram, this.__listeners || []);\r\n};\r\n\r\nViewer.prototype._createDiagram = function(modules) {\r\n\r\n  modules = [].concat(modules || this.getModules());\r\n\r\n  // add self as an available service\r\n  modules.unshift({\r\n    bpmnjs: [ 'value', this ]\r\n  });\r\n\r\n  return new Diagram({\r\n    canvas: { container: this.container },\r\n    modules: modules\r\n  });\r\n};\r\n\r\n\r\nViewer.prototype.getModules = function() {\r\n  return this._modules;\r\n};\r\n\r\n/**\r\n * Remove all drawn elements from the viewer\r\n */\r\nViewer.prototype.clear = function() {\r\n  var diagram = this.diagram;\r\n\r\n  if (diagram) {\r\n    diagram.destroy();\r\n  }\r\n};\r\n\r\n/**\r\n * Register an event listener on the viewer\r\n *\r\n * @param {String} event\r\n * @param {Function} handler\r\n */\r\nViewer.prototype.on = function(event, handler) {\r\n  var diagram = this.diagram,\r\n      listeners = this.__listeners = this.__listeners || [];\r\n\r\n  listeners = this.__listeners || [];\r\n  listeners.push({ event: event, handler: handler });\r\n\r\n  if (diagram) {\r\n    diagram.get('eventBus').on(event, handler);\r\n  }\r\n};\r\n\r\n// modules the viewer is composed of\r\nViewer.prototype._modules = [\r\n  _dereq_('./core'),\r\n  _dereq_('./draw'),\r\n  _dereq_('diagram-js/lib/features/selection')\r\n];\r\n\r\nmodule.exports = Viewer;\r\n\n},{\"./Util\":1,\"./core\":7,\"./draw\":10,\"./import/Importer\":4,\"bpmn-moddle\":13,\"diagram-js\":43,\"diagram-js/lib/features/selection\":61}],3:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Refs = _dereq_('object-refs');\r\n\r\nvar diRefs = new Refs({ name: 'bpmnElement', enumerable: true }, { name: 'di' });\r\n\r\n\r\nfunction BpmnTreeWalker(handler) {\r\n\r\n  // list of containers already walked\r\n  var handledProcesses = [];\r\n\r\n  ///// Helpers /////////////////////////////////\r\n\r\n  function contextual(fn, ctx) {\r\n    return function(e) {\r\n      fn(e, ctx);\r\n    };\r\n  }\r\n\r\n  function is(element, type) {\r\n    return element.$instanceOf(type);\r\n  }\r\n\r\n  function visit(element, ctx) {\r\n\r\n    var gfx = element.gfx;\r\n\r\n    // avoid multiple rendering of elements\r\n    if (gfx) {\r\n      throw new Error('already rendered <' + element.id + '>');\r\n    }\r\n\r\n    // call handler\r\n    return handler.element(element, ctx);\r\n  }\r\n\r\n  function visitRoot(element, diagram) {\r\n    return handler.root(element, diagram);\r\n  }\r\n\r\n  function visitIfDi(element, ctx) {\r\n    if (element.di) {\r\n      return visit(element, ctx);\r\n    }\r\n  }\r\n\r\n  function logError(message, context) {\r\n    handler.error(message, context);\r\n  }\r\n\r\n  ////// DI handling ////////////////////////////\r\n\r\n  function registerDi(di) {\r\n    var bpmnElement = di.bpmnElement;\r\n\r\n    if (bpmnElement) {\r\n      diRefs.bind(bpmnElement, 'di');\r\n      bpmnElement.di = di;\r\n    } else {\r\n      logError('no bpmnElement for <' + di.$type + '#' + di.id + '>', { element: di });\r\n    }\r\n  }\r\n\r\n  function handleDiagram(diagram) {\r\n    handlePlane(diagram.plane);\r\n  }\r\n\r\n  function handlePlane(plane) {\r\n    registerDi(plane);\r\n\r\n    _.forEach(plane.planeElement, handlePlaneElement);\r\n  }\r\n\r\n  function handlePlaneElement(planeElement) {\r\n    registerDi(planeElement);\r\n  }\r\n\r\n\r\n  ////// Semantic handling //////////////////////\r\n\r\n  function handleDefinitions(definitions, diagram) {\r\n    // make sure we walk the correct bpmnElement\r\n\r\n    var diagrams = definitions.diagrams;\r\n\r\n    if (diagram && diagrams.indexOf(diagram) === -1) {\r\n      throw new Error('diagram not part of bpmn:Definitions');\r\n    }\r\n\r\n    if (!diagram && diagrams && diagrams.length) {\r\n      diagram = diagrams[0];\r\n    }\r\n\r\n    // no diagram -> nothing to import\r\n    if (!diagram) {\r\n      return;\r\n    }\r\n\r\n    // load DI from selected diagram only\r\n    handleDiagram(diagram);\r\n\r\n    var plane = diagram.plane,\r\n        rootElement = plane.bpmnElement;\r\n\r\n    if (!rootElement) {\r\n      throw new Error('no rootElement referenced in BPMNPlane <' + diagram.plane.id + '>');\r\n    }\r\n\r\n\r\n    var ctx = visitRoot(rootElement, plane);\r\n\r\n    if (is(rootElement, 'bpmn:Process')) {\r\n      handleProcess(rootElement, ctx);\r\n    } else if (is(rootElement, 'bpmn:Collaboration')) {\r\n      handleCollaboration(rootElement, ctx);\r\n\r\n      // force drawing of everything not yet drawn that is part of the target DI\r\n      handleUnhandledProcesses(definitions.rootElements, ctx);\r\n    } else {\r\n      throw new Error('unsupported root element for bpmndi:Diagram <' + rootElement.$type + '>');\r\n    }\r\n  }\r\n\r\n  function handleProcess(process, context) {\r\n    handleFlowElementsContainer(process, context);\r\n    handleIoSpecification(process.ioSpecification, context);\r\n\r\n    handleArtifacts(process.artifacts, context);\r\n\r\n    // log process handled\r\n    handledProcesses.push(process);\r\n  }\r\n\r\n  function handleUnhandledProcesses(rootElements) {\r\n\r\n    // walk through all processes that have not yet been drawn and draw them\r\n    // if they contain lanes with DI information.\r\n    // we do this to pass the free-floating lane test cases in the MIWG test suite\r\n    var processes = _.filter(rootElements, function(e) {\r\n      return is(e, 'bpmn:Process') && e.laneSets && handledProcesses.indexOf(e) === -1;\r\n    });\r\n\r\n    processes.forEach(contextual(handleProcess));\r\n  }\r\n\r\n  function handleMessageFlow(messageFlow, context) {\r\n    visitIfDi(messageFlow, context);\r\n  }\r\n\r\n  function handleMessageFlows(messageFlows, context) {\r\n    if (messageFlows) {\r\n      _.forEach(messageFlows, contextual(handleMessageFlow, context));\r\n    }\r\n  }\r\n\r\n  function handleDataAssociation(association, context) {\r\n    visitIfDi(association, context);\r\n  }\r\n\r\n  function handleDataInput(dataInput, context) {\r\n    visitIfDi(dataInput, context);\r\n  }\r\n\r\n  function handleDataOutput(dataOutput, context) {\r\n    visitIfDi(dataOutput, context);\r\n  }\r\n\r\n  function handleArtifact(artifact, context) {\r\n\r\n    // bpmn:TextAnnotation\r\n    // bpmn:Group\r\n    // bpmn:Association\r\n\r\n    visitIfDi(artifact, context);\r\n  }\r\n\r\n  function handleArtifacts(artifacts, context) {\r\n    _.forEach(artifacts, contextual(handleArtifact, context));\r\n  }\r\n\r\n  function handleIoSpecification(ioSpecification, context) {\r\n\r\n    if (!ioSpecification) {\r\n      return;\r\n    }\r\n\r\n    _.forEach(ioSpecification.dataInputs, contextual(handleDataInput, context));\r\n    _.forEach(ioSpecification.dataOutputs, contextual(handleDataOutput, context));\r\n  }\r\n\r\n  function handleSubProcess(subProcess, context) {\r\n    handleFlowElementsContainer(subProcess, context);\r\n    handleArtifacts(subProcess.artifacts, context);\r\n  }\r\n\r\n  function handleFlowNode(flowNode, context) {\r\n    var childCtx = visitIfDi(flowNode, context);\r\n\r\n    if (is(flowNode, 'bpmn:SubProcess')) {\r\n      handleSubProcess(flowNode, childCtx || context);\r\n    }\r\n\r\n    if (is(flowNode, 'bpmn:Activity')) {\r\n      _.forEach(flowNode.dataInputAssociations, contextual(handleDataAssociation, null));\r\n      _.forEach(flowNode.dataOutputAssociations, contextual(handleDataAssociation, null));\r\n\r\n      handleIoSpecification(flowNode.ioSpecification, context);\r\n    }\r\n  }\r\n\r\n  function handleSequenceFlow(sequenceFlow, context) {\r\n    visitIfDi(sequenceFlow, context);\r\n  }\r\n\r\n  function handleDataElement(dataObject, context) {\r\n    visitIfDi(dataObject, context);\r\n  }\r\n\r\n  function handleBoundaryElement(dataObject, context) {\r\n    visitIfDi(dataObject, context);\r\n  }\r\n\r\n  function handleLane(lane, context) {\r\n    var newContext = visitIfDi(lane, context);\r\n\r\n    if (lane.childLaneSet) {\r\n      handleLaneSet(lane.childLaneSet, newContext || context);\r\n    } else {\r\n      var filterList = _.filter(lane.flowNodeRef, function(e) {\r\n        return e.$type !== 'bpmn:BoundaryEvent';\r\n      });\r\n      handleFlowElements(filterList, newContext || context);\r\n    }\r\n  }\r\n\r\n  function handleLaneSet(laneSet, context) {\r\n    _.forEach(laneSet.lanes, contextual(handleLane, context));\r\n  }\r\n\r\n  function handleLaneSets(laneSets, context) {\r\n    _.forEach(laneSets, contextual(handleLaneSet, context));\r\n  }\r\n\r\n  function handleFlowElementsContainer(container, context) {\r\n\r\n    if (container.laneSets) {\r\n      handleLaneSets(container.laneSets, context);\r\n      handleNonFlowNodes(container.flowElements);\r\n    } else {\r\n      handleFlowElements(container.flowElements, context);\r\n    }\r\n  }\r\n\r\n  function handleNonFlowNodes(flowElements, context) {\r\n    var sequenceFlows = [];\r\n    var boundaryEvents = [];\r\n\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        sequenceFlows.push(e);\r\n      } else if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      } else if (is(e, 'bpmn:BoundaryEvent')) {\r\n        boundaryEvents.push(e);\r\n      }\r\n    });\r\n\r\n    // handle boundary events\r\n    _.forEach(boundaryEvents, contextual(handleBoundaryElement, context));\r\n\r\n    // handle SequenceFlows\r\n    _.forEach(sequenceFlows, contextual(handleSequenceFlow, context));\r\n  }\r\n\r\n  function handleFlowElements(flowElements, context) {\r\n    var sequenceFlows = [];\r\n    var boundaryEvents = [];\r\n\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        sequenceFlows.push(e);\r\n      } else if (is(e, 'bpmn:BoundaryEvent')) {\r\n        boundaryEvents.push(e);\r\n      } else if (is(e, 'bpmn:FlowNode')) {\r\n        handleFlowNode(e, context);\r\n      } else if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      } else {\r\n        logError(\r\n          'unrecognized flowElement <' + e.$type + '> in context ' + (context ? context.id : null),\r\n          { element: e, context: context });\r\n      }\r\n    });\r\n\r\n    // handle boundary events\r\n    _.forEach(boundaryEvents, contextual(handleBoundaryElement, context));\r\n\r\n    // handle SequenceFlows\r\n    _.forEach(sequenceFlows, contextual(handleSequenceFlow, context));\r\n  }\r\n\r\n  function handleParticipant(participant, context) {\r\n    var newCtx = visitIfDi(participant, context);\r\n\r\n    var process = participant.processRef;\r\n    if (process) {\r\n      handleProcess(process, newCtx || context);\r\n    }\r\n  }\r\n\r\n  function handleCollaboration(collaboration) {\r\n\r\n    _.forEach(collaboration.participants, contextual(handleParticipant));\r\n\r\n    handleArtifacts(collaboration.artifacts);\r\n\r\n    handleMessageFlows(collaboration.messageFlows);\r\n  }\r\n\r\n\r\n  ///// API ////////////////////////////////\r\n\r\n  return {\r\n    handleDefinitions: handleDefinitions\r\n  };\r\n}\r\n\r\nmodule.exports = BpmnTreeWalker;\n},{\"object-refs\":73}],4:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar BpmnTreeWalker = _dereq_('./BpmnTreeWalker');\r\n\r\n\r\n/**\r\n * Import the definitions into the given diagram, reporting errors and warnings\r\n * via the specified callback.\r\n *\r\n * @param  {Diagram} diagram\r\n * @param  {ModdleElement} definitions\r\n * @param  {Function} done the callback, invoked with (err, [ warning ]) once the import is done\r\n */\r\nfunction importBpmnDiagram(diagram, definitions, done) {\r\n\r\n  var importer = diagram.get('bpmnImporter');\r\n\r\n  var warnings = [];\r\n\r\n  var visitor = {\r\n\r\n    root: function(element) {\r\n      return importer.add(element);\r\n    },\r\n\r\n    element: function(element, parentShape) {\r\n      return importer.add(element, parentShape);\r\n    },\r\n\r\n    error: function(message, context) {\r\n      warnings.push({ message: message, context: context });\r\n    }\r\n  };\r\n\r\n  var walker = new BpmnTreeWalker(visitor);\r\n\r\n  try {\r\n    // import\r\n    walker.handleDefinitions(definitions);\r\n\r\n    done(null, warnings);\r\n  } catch (e) {\r\n    done(e);\r\n  }\r\n}\r\n\r\nmodule.exports.importBpmnDiagram = importBpmnDiagram;\n},{\"./BpmnTreeWalker\":3}],5:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar hasExternalLabel = _dereq_('../util/Label').hasExternalLabel,\r\n    isExpanded = _dereq_('../util/Di').isExpanded;\r\n\r\n/**\r\n * An importer that adds bpmn elements to the canvas\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nfunction BpmnImporter(eventBus, canvas, elementFactory) {\r\n  this._eventBus = eventBus;\r\n  this._canvas = canvas;\r\n\r\n  this._elementFactory = elementFactory;\r\n}\r\n\r\nBpmnImporter.$inject = [ 'eventBus', 'canvas', 'elementFactory' ];\r\n\r\n\r\n/**\r\n * Add bpmn element (semantic) to the canvas onto the\r\n * specified parent shape.\r\n */\r\nBpmnImporter.prototype.add = function(semantic, parentElement) {\r\n\r\n  var di = semantic.di,\r\n      element;\r\n\r\n  // handle the special case that we deal with a\r\n  // invisible root element (process or collaboration)\r\n  if (di.$instanceOf('bpmndi:BPMNPlane')) {\r\n\r\n    // add a virtual element (not being drawn)\r\n    element = this._elementFactory.createRoot(semantic);\r\n  }\r\n\r\n  // SHAPE\r\n  else if (di.$instanceOf('bpmndi:BPMNShape')) {\r\n\r\n    var collapsed = !isExpanded(semantic);\r\n    var hidden = parentElement && (parentElement.hidden || parentElement.collapsed);\r\n\r\n    element = this._elementFactory.createShape(semantic, {\r\n      collapsed: collapsed,\r\n      hidden: hidden\r\n    });\r\n\r\n    this._canvas.addShape(element, parentElement);\r\n  }\r\n\r\n  // CONNECTION\r\n  else {\r\n    element = this._elementFactory.createConnection(semantic, parentElement);\r\n    this._canvas.addConnection(element, parentElement);\r\n  }\r\n\r\n  // (optional) LABEL\r\n  if (hasExternalLabel(semantic)) {\r\n    this.addLabel(semantic, element);\r\n  }\r\n\r\n  this._eventBus.fire('bpmnElement.added', { element: element });\r\n\r\n  return element;\r\n};\r\n\r\n\r\n/**\r\n * add label for an element\r\n */\r\nBpmnImporter.prototype.addLabel = function (semantic, element) {\r\n  var label = this._elementFactory.createLabel(semantic, element);\r\n  return this._canvas.addShape(label, element.parent);\r\n};\r\n\r\n\r\nmodule.exports = BpmnImporter;\n},{\"../util/Di\":11,\"../util/Label\":12}],6:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\nvar LabelUtil = _dereq_('../util/Label');\r\n\r\nvar getExternalLabelBounds = LabelUtil.getExternalLabelBounds;\r\n\r\n\r\n/**\r\n * A factory for diagram-js shapes\r\n *\r\n * @param {ElementFactory} canvas\r\n */\r\nfunction ElementFactory(canvas) {\r\n  this._canvas = canvas;\r\n}\r\n\r\nElementFactory.$inject = [ 'canvas' ];\r\n\r\nmodule.exports = ElementFactory;\r\n\r\n\r\nElementFactory.prototype.createRoot = function(semantic) {\r\n\r\n  return this._canvas.create('root', _.extend({\r\n    id: semantic.id,\r\n    type: semantic.$type,\r\n    businessObject: semantic\r\n  }));\r\n};\r\n\r\n\r\nElementFactory.prototype.createLabel = function(semantic, element) {\r\n  var labelBounds = getExternalLabelBounds(semantic, element);\r\n\r\n  var labelData = _.extend({\r\n    id: semantic.id + '_label',\r\n    labelTarget: element,\r\n    type: 'label',\r\n    hidden: element.hidden,\r\n    businessObject: semantic\r\n  }, labelBounds);\r\n\r\n  return this._canvas.create('label', labelData);\r\n};\r\n\r\n\r\nElementFactory.prototype.createShape = function(semantic, attrs) {\r\n  var bounds = semantic.di.bounds;\r\n\r\n  var shapeData = _.extend({\r\n    id: semantic.id,\r\n    type: semantic.$type,\r\n    x: bounds.x,\r\n    y: bounds.y,\r\n    width: bounds.width,\r\n    height: bounds.height,\r\n    businessObject: semantic\r\n  }, attrs);\r\n\r\n  return this._canvas.create('shape', shapeData);\r\n};\r\n\r\n\r\nElementFactory.prototype.createConnection = function(semantic) {\r\n  var waypoints = _.collect(semantic.di.waypoint, function(p) {\r\n    return { x: p.x, y: p.y };\r\n  });\r\n\r\n  return this._canvas.create('connection', {\r\n    id: semantic.id,\r\n    type: semantic.$type,\r\n    waypoints: waypoints,\r\n    businessObject: semantic\r\n  });\r\n};\n},{\"../util/Label\":12}],7:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  bpmnImporter: [ 'type', _dereq_('./BpmnImporter') ],\r\n  elementFactory: [ 'type', _dereq_('./ElementFactory') ]\r\n};\n},{\"./BpmnImporter\":5,\"./ElementFactory\":6}],8:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar DefaultRenderer = _dereq_('diagram-js/lib/draw/Renderer');\r\nvar LabelUtil = _dereq_('diagram-js/lib/util/LabelUtil');\r\n\r\nvar DiUtil = _dereq_('../util/Di');\r\n\r\nvar flattenPoints = DefaultRenderer.flattenPoints;\r\n\r\n\r\nfunction BpmnRenderer(events, styles, pathMap) {\r\n\r\n  DefaultRenderer.call(this, styles);\r\n\r\n  var TASK_BORDER_RADIUS = 10;\r\n  var INNER_OUTER_DIST = 3;\r\n\r\n  var LABEL_STYLE = {\r\n    fontFamily: 'Arial, sans-serif',\r\n    fontSize: '12px'\r\n  };\r\n\r\n  var labelUtil = new LabelUtil({\r\n    style: LABEL_STYLE,\r\n    size: { width: 100 }\r\n  });\r\n\r\n  var markers = {};\r\n\r\n  function addMarker(id, element) {\r\n    markers[id] = element;\r\n  }\r\n\r\n  function marker(id) {\r\n    return markers[id];\r\n  }\r\n\r\n  function initMarkers(paper) {\r\n\r\n    function createMarker(id, options) {\r\n      var attrs = _.extend({\r\n        fill: 'black',\r\n        strokeWidth: 1,\r\n        strokeLinecap: 'round',\r\n        strokeDasharray: 'none'\r\n      }, options.attrs);\r\n\r\n      var ref = options.ref || { x: 0, y: 0 };\r\n\r\n      var scale = options.scale || 1;\r\n\r\n      // fix for safari / chrome / firefox bug not correctly\r\n      // resetting stroke dash array\r\n      if (attrs.strokeDasharray === 'none') {\r\n        attrs.strokeDasharray = [10000, 1];\r\n      }\r\n\r\n      var marker = options.element\r\n                     .attr(attrs)\r\n                     .marker(0, 0, 20, 20, ref.x, ref.y)\r\n                     .attr({\r\n                       markerWidth: 20 * scale,\r\n                       markerHeight: 20 * scale\r\n                     });\r\n\r\n      return addMarker(id, marker);\r\n    }\r\n\r\n\r\n    createMarker('sequenceflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('messageflow-start', {\r\n      element: paper.circle(6, 6, 5),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 6, y: 6 }\r\n    });\r\n\r\n    createMarker('messageflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 }\r\n    });\r\n\r\n    createMarker('data-association-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-flow-marker', {\r\n      element: paper.path('M 0 10 L 8 6 L 16 10 L 8 14 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -1, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-default-flow-marker', {\r\n      element: paper.path('M 1 4 L 5 16'),\r\n      attrs: {\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -5, y: 10 },\r\n      scale: 0.5\r\n    });\r\n  }\r\n\r\n  function computeStyle(custom, traits, defaultStyles) {\r\n    if (!_.isArray(traits)) {\r\n      defaultStyles = traits;\r\n      traits = [];\r\n    }\r\n\r\n    return styles.style(traits || [], _.extend(defaultStyles, custom || {}));\r\n  }\r\n\r\n  function drawCircle(p, width, height, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    var cx = width / 2,\r\n        cy = height / 2;\r\n\r\n    return p.circle(cx, cy, Math.round((width + height) / 4 - offset)).attr(attrs);\r\n  }\r\n\r\n  function drawRect(p, width, height, r, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.rect(offset, offset, width - offset * 2, height - offset * 2, r).attr(attrs);\r\n  }\r\n\r\n  function drawDiamond(p, width, height, attrs) {\r\n\r\n    var x_2 = width / 2;\r\n    var y_2 = height / 2;\r\n\r\n    var points = [x_2, 0, width, y_2, x_2, height, 0, y_2 ];\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.polygon(points).attr(attrs);\r\n  }\r\n\r\n  function drawLine(p, waypoints, attrs) {\r\n    var points = flattenPoints(waypoints);\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'none'\r\n    });\r\n\r\n    return p.polyline(points).attr(attrs);\r\n  }\r\n\r\n  function drawPath(p, d, attrs) {\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      strokeWidth: 2,\r\n      stroke: 'black'\r\n    });\r\n\r\n    return p.path(d).attr(attrs);\r\n  }\r\n\r\n  function as(type) {\r\n    return function(p, element) {\r\n      return handlers[type](p, element);\r\n    };\r\n  }\r\n\r\n  function renderer(type) {\r\n    return handlers[type];\r\n  }\r\n\r\n  function renderEventContent(element, p) {\r\n\r\n    var event = getSemantic(element);\r\n    var isThrowing = isThrowEvent(event);\r\n\r\n    if (isTypedEvent(event, 'bpmn:MessageEventDefinition')) {\r\n      return renderer('bpmn:MessageEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TimerEventDefinition')) {\r\n      return renderer('bpmn:TimerEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ConditionalEventDefinition')) {\r\n      return renderer('bpmn:ConditionalEventDefinition')(p, element);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:SignalEventDefinition')) {\r\n      return renderer('bpmn:SignalEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: false })) {\r\n      return renderer('bpmn:MultipleEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: true })) {\r\n      return renderer('bpmn:ParallelMultipleEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:EscalationEventDefinition')) {\r\n      return renderer('bpmn:EscalationEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:LinkEventDefinition')) {\r\n      return renderer('bpmn:LinkEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ErrorEventDefinition')) {\r\n      return renderer('bpmn:ErrorEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition')) {\r\n      return renderer('bpmn:CancelEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CompensateEventDefinition')) {\r\n      return renderer('bpmn:CompensateEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TerminateEventDefinition')) {\r\n      return renderer('bpmn:TerminateEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  function renderLabel(p, label, options) {\r\n    return labelUtil.createLabel(p, label || '', options).addClass('djs-label');\r\n  }\r\n\r\n  function renderEmbeddedLabel(p, element, align) {\r\n    var semantic = getSemantic(element);\r\n    return renderLabel(p, semantic.name, { box: element, align: align });\r\n  }\r\n\r\n  function renderExternalLabel(p, element, align) {\r\n    var semantic = getSemantic(element);\r\n    return renderLabel(p, semantic.name, { box: element, align: align, style: { fontSize: '11px' } });\r\n  }\r\n\r\n  function renderLaneLabel(p, text, element) {\r\n    var textBox = renderLabel(p, text, {\r\n      box: { height: 30, width: element.height },\r\n      align: 'center-middle'\r\n    });\r\n\r\n    var top = -1 * element.height;\r\n    textBox.transform(\r\n      'rotate(270) ' +\r\n      'translate(' + top + ',' + 0 + ')'\r\n    );\r\n  }\r\n\r\n  function createPathFromWaypoints(waypoints) {\r\n    var pathData = 'm  ' + waypoints[0].x + ',' + waypoints[0].y;\r\n    for (var i = 1; i < waypoints.length; i++) {\r\n      pathData += 'L' + waypoints[i].x + ',' + waypoints[i].y + ' ';\r\n    }\r\n    return pathData;\r\n  }\r\n\r\n  var handlers = {\r\n    'bpmn:Event': function(p, element, attrs) {\r\n      return drawCircle(p, element.width, element.height,  attrs);\r\n    },\r\n    'bpmn:StartEvent': function(p, element) {\r\n      var attrs = {};\r\n      var semantic = getSemantic(element);\r\n\r\n      if (!semantic.isInterrupting) {\r\n        attrs = {\r\n          strokeDasharray: '6',\r\n          strokeLinecap: 'round'\r\n        };\r\n      }\r\n\r\n      var circle = renderer('bpmn:Event')(p, element, attrs);\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:MessageEventDefinition': function(p, element, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MESSAGE', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.235,\r\n          my: 0.315\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n      var stroke = isThrowing ? 'white' : 'black';\r\n\r\n      var messagePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill,\r\n        stroke: stroke\r\n      });\r\n\r\n      return messagePath;\r\n    },\r\n    'bpmn:TimerEventDefinition': function(p, element) {\r\n\r\n      var circle = drawCircle(p, element.width, element.height, 0.2 * element.height, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('EVENT_TIMER_WH', {\r\n        xScaleFactor: 0.75,\r\n        yScaleFactor: 0.75,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.5\r\n        }\r\n      });\r\n\r\n      var path = drawPath(p, pathData, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:EscalationEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ESCALATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.555\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ConditionalEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CONDITIONAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.222\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:LinkEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_LINK', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.57,\r\n          my: 0.263\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:ErrorEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ERROR', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.2,\r\n          my: 0.722\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:CancelEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CANCEL_45', {\r\n        xScaleFactor: 1.0,\r\n        yScaleFactor: 1.0,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.638,\r\n          my: -0.055\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      }).transform('rotate(45)');\r\n    },\r\n    'bpmn:CompensateEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.201,\r\n          my: 0.472\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:SignalEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_SIGNAL', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:MultipleEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MULTIPLE', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.222,\r\n          my: 0.36\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ParallelMultipleEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_PARALLEL_MULTIPLE', {\r\n        xScaleFactor: 1.2,\r\n        yScaleFactor: 1.2,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.458,\r\n          my: 0.194\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:EndEvent': function(p, element) {\r\n      var circle = renderer('bpmn:Event')(p, element, {\r\n        strokeWidth: 4\r\n      });\r\n\r\n      renderEventContent(element, p, true);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:TerminateEventDefinition': function(p, element) {\r\n      var circle = drawCircle(p, element.width, element.height, 8, {\r\n        strokeWidth: 4,\r\n        fill: 'black'\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:IntermediateEvent': function(p, element) {\r\n      var outer = renderer('bpmn:Event')(p, element, { strokeWidth: 1 });\r\n      var inner = drawCircle(p, element.width, element.height, INNER_OUTER_DIST, { strokeWidth: 1 });\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:IntermediateCatchEvent': as('bpmn:IntermediateEvent'),\r\n    'bpmn:IntermediateThrowEvent': as('bpmn:IntermediateEvent'),\r\n\r\n    'bpmn:Activity': function(p, element, attrs) {\r\n      return drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, attrs);\r\n    },\r\n\r\n    'bpmn:Task': function(p, element) {\r\n      var rect = renderer('bpmn:Activity')(p, element);\r\n      renderEmbeddedLabel(p, element, 'center-middle');\r\n      attachTaskMarkers(p, element);\r\n      return rect;\r\n    },\r\n    'bpmn:ServiceTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathDataBG = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 12,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var servicePathBG = drawPath(p, pathDataBG, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var fillPathData = pathMap.getScaledPath('TASK_TYPE_SERVICE_FILL', {\r\n        abspos: {\r\n          x: 17.2,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var serviceFillPath = drawPath(p, fillPathData, {\r\n        strokeWidth: 0,\r\n        stroke: 'none',\r\n        fill: 'white'\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 22\r\n        }\r\n      });\r\n\r\n      var servicePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:UserTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var x = 15;\r\n      var y = 12;\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_USER_1', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath2 = drawPath(p, pathData2, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath3 = drawPath(p, pathData3, {\r\n        strokeWidth: 0.5,\r\n        fill: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ManualTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_MANUAL', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 15\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.25,\r\n        fill: 'none',\r\n        stroke: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SendTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: 21,\r\n        containerHeight: 14,\r\n        position: {\r\n          mx: 0.285,\r\n          my: 0.357\r\n        }\r\n      });\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black',\r\n        stroke: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ReceiveTask' : function(p, element) {\r\n      var semantic = getSemantic(element);\r\n\r\n      var task = renderer('bpmn:Task')(p, element);\r\n      var pathData;\r\n\r\n      if (semantic.instantiate) {\r\n        drawCircle(p, 28, 28, 20 * 0.22, { strokeWidth: 1 });\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_INSTANTIATING_SEND', {\r\n          abspos: {\r\n            x: 7.77,\r\n            y: 9.52\r\n          }\r\n        });\r\n      } else {\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n          xScaleFactor: 0.9,\r\n          yScaleFactor: 0.9,\r\n          containerWidth: 21,\r\n          containerHeight: 14,\r\n          position: {\r\n            mx: 0.3,\r\n            my: 0.4\r\n          }\r\n        });\r\n      }\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ScriptTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SCRIPT', {\r\n        abspos: {\r\n          x: 15,\r\n          y: 20\r\n        }\r\n      });\r\n\r\n      var scriptPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:BusinessRuleTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var headerPathData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_HEADER', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessHeaderPath = drawPath(p, headerPathData);\r\n      businessHeaderPath.attr({\r\n        strokeWidth: 1,\r\n        fill: 'AAA'\r\n      });\r\n\r\n      var headerData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_MAIN', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessPath = drawPath(p, headerData);\r\n      businessPath.attr({\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SubProcess': function(p, element, attrs) {\r\n      var rect = renderer('bpmn:Activity')(p, element, attrs);\r\n\r\n      var semantic = getSemantic(element),\r\n          di = getDi(element);\r\n\r\n      var expanded = DiUtil.isExpanded(semantic);\r\n\r\n      var isEventSubProcess = !!getSemantic(element).triggeredByEvent;\r\n      if (isEventSubProcess) {\r\n        rect.attr({\r\n          strokeDasharray: '1,2'\r\n        });\r\n      }\r\n\r\n      renderEmbeddedLabel(p, element, expanded ? 'center-top' : 'center-middle');\r\n\r\n      if (expanded) {\r\n        attachTaskMarkers(p, element);\r\n      } else {\r\n        attachTaskMarkers(p, element, ['SubProcessMarker']);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:AdHocSubProcess': function(p, element) {\r\n      return renderer('bpmn:SubProcess')(p, element);\r\n    },\r\n    'bpmn:Transaction': function(p, element) {\r\n      var outer = renderer('bpmn:SubProcess')(p, element);\r\n\r\n      var innerAttrs = styles.style([ 'no-fill', 'no-events' ]);\r\n      var inner = drawRect(p, element.width, element.height, TASK_BORDER_RADIUS - 2, INNER_OUTER_DIST, innerAttrs);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:CallActivity': function(p, element) {\r\n      return renderer('bpmn:SubProcess')(p, element, {\r\n        strokeWidth: 5\r\n      });\r\n    },\r\n    'bpmn:Participant': function(p, element) {\r\n\r\n      var lane = renderer('bpmn:Lane')(p, element);\r\n\r\n      var expandedPool = DiUtil.isExpandedPool(getSemantic(element));\r\n\r\n      if (expandedPool) {\r\n        drawLine(p, [\r\n          {x: 30, y: 0},\r\n          {x: 30, y: element.height}\r\n        ]);\r\n        var text = getSemantic(element).name;\r\n        renderLaneLabel(p, text, element);\r\n      } else {\r\n        // Collapsed pool draw text inline\r\n        var text2 = getSemantic(element).name;\r\n        renderLabel(p, text2, { box: element, align: 'center-middle' });\r\n      }\r\n\r\n      var participantMultiplicity = !!(getSemantic(element).participantMultiplicity);\r\n\r\n      if(participantMultiplicity) {\r\n        renderer('ParticipantMultiplicityMarker')(p, element);\r\n      }\r\n\r\n      return lane;\r\n    },\r\n    'bpmn:Lane': function(p, element) {\r\n      var rect = drawRect(p, element.width, element.height, 0, {\r\n        fill: 'none'\r\n      });\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      if (semantic.$type === 'bpmn:Lane') {\r\n        var text = semantic.name;\r\n        renderLaneLabel(p, text, element);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:InclusiveGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var circle = drawCircle(p, element.width, element.height, element.height * 0.24, {\r\n        strokeWidth: 2.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ExclusiveGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_EXCLUSIVE', {\r\n        xScaleFactor: 0.4,\r\n        yScaleFactor: 0.4,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.32,\r\n          my: 0.3\r\n        }\r\n      });\r\n\r\n      if (!!(getDi(element).isMarkerVisible)) {\r\n        drawPath(p, pathData, {\r\n          strokeWidth: 1,\r\n          fill: 'black'\r\n        });\r\n      }\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ComplexGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_COMPLEX', {\r\n        xScaleFactor: 0.5,\r\n        yScaleFactor:0.5,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.26\r\n        }\r\n      });\r\n\r\n      var complexPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ParallelGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n        xScaleFactor: 0.6,\r\n        yScaleFactor:0.6,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var parallelPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:EventBasedGateway': function(p, element) {\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var outerCircle = drawCircle(p, element.width, element.height, element.height * 0.20, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var type = semantic.eventGatewayType;\r\n      var instantiate = !!semantic.instantiate;\r\n\r\n      function drawEvent() {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_EVENT_BASED', {\r\n          xScaleFactor: 0.18,\r\n          yScaleFactor: 0.18,\r\n          containerWidth: element.width,\r\n          containerHeight: element.height,\r\n          position: {\r\n            mx: 0.36,\r\n            my: 0.44\r\n          }\r\n        });\r\n\r\n        var eventPath = drawPath(p, pathData, {\r\n          strokeWidth: 2,\r\n          fill: 'none'\r\n        });\r\n      }\r\n\r\n      if (type === 'Parallel') {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n          xScaleFactor: 0.4,\r\n          yScaleFactor:0.4,\r\n          containerWidth: element.width,\r\n          containerHeight: element.height,\r\n          position: {\r\n            mx: 0.474,\r\n            my: 0.296\r\n          }\r\n        });\r\n\r\n        var parallelPath = drawPath(p, pathData);\r\n        parallelPath.attr({\r\n          strokeWidth: 1,\r\n          fill: 'none'\r\n        });\r\n      } else if (type === 'Exclusive') {\r\n\r\n        if (!instantiate) {\r\n          var innerCircle = drawCircle(p, element.width, element.height, element.height * 0.26);\r\n          innerCircle.attr({\r\n            strokeWidth: 1,\r\n            fill: 'none'\r\n          });\r\n        }\r\n\r\n        drawEvent();\r\n      }\r\n\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:Gateway': function(p, element) {\r\n      return drawDiamond(p, element.width, element.height);\r\n    },\r\n    'bpmn:SequenceFlow': function(p, element) {\r\n      var pathData = createPathFromWaypoints(element.waypoints);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('sequenceflow-end')\r\n      });\r\n\r\n      var sequenceFlow = getSemantic(element);\r\n      var source = sequenceFlow.sourceRef;\r\n\r\n      // conditional flow marker\r\n      if (sequenceFlow.conditionExpression && source.$instanceOf('bpmn:Task')) {\r\n        path.attr({\r\n          markerStart: marker('conditional-flow-marker')\r\n        });\r\n      }\r\n\r\n      // default marker\r\n      if (source.default && source.$instanceOf('bpmn:Gateway') && source.default === sequenceFlow) {\r\n        path.attr({\r\n          markerStart: marker('conditional-default-flow-marker')\r\n        });\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:Association': function(p, element, attrs) {\r\n\r\n      attrs = _.extend({\r\n        strokeDasharray: '1,6',\r\n        strokeLinecap: 'round'\r\n      }, attrs || {});\r\n\r\n      // TODO(nre): style according to directed state\r\n      return drawLine(p, element.waypoints, attrs);\r\n    },\r\n    'bpmn:DataInputAssociation': function(p, element) {\r\n      return renderer('bpmn:Association')(p, element, {\r\n        markerEnd: marker('element-association-end')\r\n      });\r\n    },\r\n    'bpmn:DataOutputAssociation': function(p, element) {\r\n      return renderer('bpmn:Association')(p, element, {\r\n        markerEnd: marker('element-association-end')\r\n      });\r\n    },\r\n    'bpmn:MessageFlow': function(p, element) {\r\n\r\n      var di = getDi(element);\r\n\r\n      var pathData = createPathFromWaypoints(element.waypoints);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('messageflow-end'),\r\n        markerStart: marker('messageflow-start'),\r\n        strokeDasharray: '10',\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      });\r\n\r\n      if (!!di.messageVisibleKind) {\r\n        var midPoint = path.getPointAtLength(path.getTotalLength() / 2);\r\n\r\n        var markerPathData = pathMap.getScaledPath('MESSAGE_FLOW_MARKER', {\r\n          abspos: {\r\n            x: midPoint.x,\r\n            y: midPoint.y\r\n          }\r\n        });\r\n\r\n        var messageAttrs = { strokeWidth: 1 };\r\n\r\n        if (di.messageVisibleKind === 'initiating') {\r\n          messageAttrs.fill = 'white';\r\n          messageAttrs.stroke = 'black';\r\n        } else {\r\n          messageAttrs.fill = '#888';\r\n          messageAttrs.stroke = 'white';\r\n        }\r\n\r\n        drawPath(p, markerPathData, messageAttrs);\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:DataObject': function(p, element) {\r\n      var pathData = pathMap.getScaledPath('DATA_OBJECT_PATH', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.474,\r\n          my: 0.296\r\n        }\r\n      });\r\n\r\n      var elementObject = drawPath(p, pathData, { fill: 'white' });\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      if (isCollection(semantic)) {\r\n        renderDataItemCollection(p, element);\r\n      }\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataObjectReference': as('bpmn:DataObject'),\r\n    'bpmn:DataInput': function(p, element) {\r\n\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var elementObject = renderer('bpmn:DataObject')(p, element);\r\n\r\n      // arrow\r\n      var elementInput = drawPath(p, arrowPathData, { strokeWidth: 1 });\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataOutput': function(p, element) {\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var elementObject = renderer('bpmn:DataObject')(p, element);\r\n\r\n      // arrow\r\n      var elementInput = drawPath(p, arrowPathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataStoreReference': function(p, element) {\r\n      var DATA_STORE_PATH = pathMap.getScaledPath('DATA_STORE', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0,\r\n          my: 0.133\r\n        }\r\n      });\r\n\r\n      var elementStore = drawPath(p, DATA_STORE_PATH, {\r\n        strokeWidth: 2,\r\n        fill: 'white'\r\n      });\r\n\r\n      return elementStore;\r\n    },\r\n    'bpmn:BoundaryEvent': function(p, element) {\r\n\r\n      var semantic = getSemantic(element),\r\n          cancel = semantic.cancelActivity;\r\n\r\n      var attrs = {\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      };\r\n\r\n      if (!cancel) {\r\n        attrs.strokeDasharray = '6';\r\n      }\r\n\r\n      var outer = renderer('bpmn:Event')(p, element, attrs);\r\n      var inner = drawCircle(p, element.width, element.height, INNER_OUTER_DIST, attrs);\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:Group': function(p, element) {\r\n      return drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, {\r\n        strokeWidth: 1,\r\n        strokeDasharray: '8,3,1,3',\r\n        fill: 'none',\r\n        pointerEvents: 'none'\r\n      });\r\n    },\r\n    'label': function(p, element) {\r\n      return renderExternalLabel(p, element, '');\r\n    },\r\n    'bpmn:TextAnnotation': function(p, element) {\r\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.0,\r\n          my: 0.0\r\n        }\r\n      });\r\n      drawPath(p, textPathData);\r\n\r\n      var text = getSemantic(element).text || '';\r\n      var label = renderLabel(p, text, { box: element, align: 'left-middle' });\r\n\r\n      return label;\r\n    },\r\n    'ParticipantMultiplicityMarker': function(p, element) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2) / element.width),\r\n          my: (element.height - 15) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SubProcessMarker': function(p, element) {\r\n      var markerRect = drawRect(p, 14, 14, 0, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      // Process marker is placed in the middle of the box\r\n      // therefore fixed values can be used here\r\n      markerRect.transform('translate(' + (element.width / 2 - 7.5) + ',' + (element.height - 20) + ')');\r\n\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_SUB_PROCESS', {\r\n        xScaleFactor: 1.5,\r\n        yScaleFactor: 1.5,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: (element.width / 2 - 7.5) / element.width,\r\n          my: (element.height - 20) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'ParallelMarker': function(p, element, position) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.parallel) / element.width),\r\n          my: (element.height - 20) / element.height\r\n        }\r\n      });\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SequentialMarker': function(p, element, position) {\r\n      var sequentialPath = pathMap.getScaledPath('MARKER_SEQUENTIAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.seq) / element.width),\r\n          my: (element.height - 19) / element.height\r\n        }\r\n      });\r\n      drawPath(p, sequentialPath);\r\n    },\r\n    'CompensationMarker': function(p, element, position) {\r\n      var compensationPath = pathMap.getScaledPath('MARKER_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.compensation) / element.width),\r\n          my: (element.height - 13) / element.height\r\n        }\r\n      });\r\n      drawPath(p, compensationPath, { strokeWidth: 1 });\r\n    },\r\n    'LoopMarker': function(p, element, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_LOOP', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.loop) / element.width),\r\n          my: (element.height - 7) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'none',\r\n        strokeLinecap: 'round',\r\n        strokeMiterlimit: 0.5\r\n      });\r\n    },\r\n    'AdhocMarker': function(p, element, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_ADHOC', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.adhoc) / element.width),\r\n          my: (element.height - 15) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n    }\r\n  };\r\n\r\n  function attachTaskMarkers(p, element, taskMarkers) {\r\n    var obj = getSemantic(element);\r\n\r\n    var subprocess = _.contains(taskMarkers, 'SubProcessMarker');\r\n    var position;\r\n\r\n    if (subprocess) {\r\n      position = {\r\n        seq: -21,\r\n        parallel: -22,\r\n        compensation: -42,\r\n        loop: -18,\r\n        adhoc: 10\r\n      };\r\n    } else {\r\n      position = {\r\n        seq: -3,\r\n        parallel: -6,\r\n        compensation: -27,\r\n        loop: 0,\r\n        adhoc: 10\r\n      };\r\n    }\r\n\r\n    _.forEach(taskMarkers, function(marker) {\r\n      renderer(marker)(p, element, position);\r\n    });\r\n\r\n    if (obj.$type === 'bpmn:AdHocSubProcess') {\r\n      renderer('AdhocMarker')(p, element, position);\r\n    }\r\n    if (obj.loopCharacteristics && obj.loopCharacteristics.isSequential === undefined) {\r\n      renderer('LoopMarker')(p, element, position);\r\n      return;\r\n    }\r\n    if (obj.loopCharacteristics &&\r\n      obj.loopCharacteristics.isSequential !== undefined &&\r\n      !obj.loopCharacteristics.isSequential) {\r\n      renderer('ParallelMarker')(p, element, position);\r\n    }\r\n    if (obj.loopCharacteristics && !!obj.loopCharacteristics.isSequential) {\r\n      renderer('SequentialMarker')(p, element, position);\r\n    }\r\n    if (!!obj.isForCompensation) {\r\n      renderer('CompensationMarker')(p, element, position);\r\n    }\r\n  }\r\n\r\n  function drawShape(parent, element) {\r\n    var type = element.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawShape.apply(this, [ parent, element ]);\r\n    } else {\r\n      return h(parent, element);\r\n    }\r\n  }\r\n\r\n  function drawConnection(parent, element) {\r\n    var type = element.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawConnection.apply(this, [ parent, element ]);\r\n    } else {\r\n      return h(parent, element);\r\n    }\r\n  }\r\n\r\n  function renderDataItemCollection(p, element) {\r\n\r\n    var yPosition = (element.height - 16) / element.height;\r\n\r\n    var pathData = pathMap.getScaledPath('DATA_OBJECT_COLLECTION_PATH', {\r\n      xScaleFactor: 1,\r\n      yScaleFactor: 1,\r\n      containerWidth: element.width,\r\n      containerHeight: element.height,\r\n      position: {\r\n        mx: 0.451,\r\n        my: yPosition\r\n      }\r\n    });\r\n\r\n    var collectionPath = drawPath(p, pathData, {\r\n      strokeWidth: 2\r\n    });\r\n  }\r\n\r\n  function isCollection(element, filter) {\r\n    return element.isCollection ||\r\n           (element.elementObjectRef && element.elementObjectRef.isCollection);\r\n  }\r\n\r\n  function getDi(element) {\r\n    return element.businessObject.di;\r\n  }\r\n\r\n  function getSemantic(element) {\r\n    return element.businessObject;\r\n  }\r\n\r\n  /**\r\n   * Checks if eventDefinition of the given element matches with semantic type.\r\n   *\r\n   * @return {boolean} true if element is of the given semantic type\r\n   */\r\n  function isTypedEvent(event, eventDefinitionType, filter) {\r\n\r\n    function matches(definition, filter) {\r\n      return _.all(filter, function(val, key) {\r\n\r\n        // we want a == conversion here, to be able to catch\r\n        // undefined == false and friends\r\n        /* jshint -W116 */\r\n        return definition[key] == val;\r\n      });\r\n    }\r\n\r\n    return _.any(event.eventDefinitions, function(definition) {\r\n      return definition.$type === eventDefinitionType && matches(event, filter);\r\n    });\r\n  }\r\n\r\n  function isThrowEvent(event) {\r\n    return (event.$type === 'bpmn:IntermediateThrowEvent') || (event.$type === 'bpmn:EndEvent');\r\n  }\r\n\r\n  // hook onto canvas init event to initialize\r\n  // connection start/end markers on paper\r\n  events.on('canvas.init', function(event) {\r\n    var paper = event.paper;\r\n\r\n    initMarkers(paper);\r\n  });\r\n\r\n  this.drawShape = drawShape;\r\n  this.drawConnection = drawConnection;\r\n}\r\n\r\nBpmnRenderer.prototype = Object.create(DefaultRenderer.prototype);\r\n\r\n\r\nBpmnRenderer.$inject = [ 'eventBus', 'styles', 'pathMap' ];\r\n\r\nmodule.exports = BpmnRenderer;\n},{\"../util/Di\":11,\"diagram-js/lib/draw/Renderer\":50,\"diagram-js/lib/util/LabelUtil\":65}],9:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Map containing SVG paths needed by BpmnRenderer.\r\n */\r\n\r\nfunction PathMap(Snap) {\r\n\r\n  /**\r\n   * Contains a map of path elements\r\n   *\r\n   * <h1>Path definition</h1>\r\n   * A parameterized path is defined like this:\r\n   * <pre>\r\n   * 'GATEWAY_PARALLEL': {\r\n   *   d: 'm {mx},{my} {e.x0},0 0,{e.x1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n          '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n   *   height: 17.5,\r\n   *   width:  17.5,\r\n   *   heightElements: [2.5, 7.5],\r\n   *   widthElements: [2.5, 7.5]\r\n   * }\r\n   * </pre>\r\n   * <p>It's important to specify a correct <b>height and width</b> for the path as the scaling\r\n   * is based on the ratio between the specified height and width in this object and the\r\n   * height and width that is set as scale target (Note x,y coordinates will be scaled with\r\n   * individual ratios).</p>\r\n   * <p>The '<b>heightElements</b>' and '<b>widthElements</b>' array must contain the values that will be scaled.\r\n   * The scaling is based on the computed ratios.\r\n   * Coordinates on the y axis should be in the <b>heightElement</b>'s array, they will be scaled using\r\n   * the computed ratio coefficient.\r\n   * In the parameterized path the scaled values can be accessed through the 'e' object in {} brackets.\r\n   *   <ul>\r\n   *    <li>The values for the y axis can be accessed in the path string using {e.y0}, {e.y1}, ....</li>\r\n   *    <li>The values for the x axis can be accessed in the path string using {e.x0}, {e.x1}, ....</li>\r\n   *   </ul>\r\n   *   The numbers x0, x1 respectively y0, y1, ... map to the corresponding array index.\r\n   * </p>\r\n   */\r\n  this.pathMap = {\r\n    'EVENT_MESSAGE': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'EVENT_SIGNAL': {\r\n      d: 'M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [18],\r\n      widthElements: [10, 20]\r\n    },\r\n    'EVENT_ESCALATION': {\r\n      d: 'm {mx},{my} c -{e.x1},{e.y0} -{e.x3},{e.y1} -{e.x5},{e.y4} {e.x1},-{e.y3} {e.x3},-{e.y5} {e.x5},-{e.y6} ' +\r\n        '{e.x0},{e.y3} {e.x2},{e.y5} {e.x4},{e.y6} -{e.x0},-{e.y0} -{e.x2},-{e.y1} -{e.x4},-{e.y4} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [2.382, 4.764, 4.926, 6.589333, 7.146, 13.178667, 19.768],\r\n      widthElements: [2.463, 2.808, 4.926, 5.616, 7.389, 8.424]\r\n    },\r\n    'EVENT_CONDITIONAL': {\r\n      d: 'M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z ' +\r\n         'M {e.x2},{e.y3} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y4} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y5} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y6} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y7} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y8} l {e.x0},0 ',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [8.5, 14.5, 18, 11.5, 14.5, 17.5, 20.5, 23.5, 26.5],\r\n      widthElements:  [10.5, 14.5, 12.5]\r\n    },\r\n    'EVENT_LINK': {\r\n      d: 'm {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.4375, 6.75, 7.8125],\r\n      widthElements: [9.84375, 13.5]\r\n    },\r\n    'EVENT_ERROR': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [0.023, 8.737, 8.151, 16.564, 10.591, 8.714],\r\n      widthElements: [0.085, 6.672, 6.97, 4.273, 5.337, 6.636]\r\n    },\r\n    'EVENT_CANCEL_45': {\r\n      d: 'm {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.75, 8.5],\r\n      widthElements: [4.75, 8.5]\r\n    },\r\n    'EVENT_COMPENSATION': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x0},0 {e.x0},-{e.y0} 0,{e.y1} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [5, 10],\r\n      widthElements: [10]\r\n    },\r\n    'EVENT_TIMER_WH': {\r\n      d: 'M {mx},{my} m -{e.x1},-{e.y1} l {e.x1},{e.y1} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [3.5,4],\r\n      widthElements: [8.75,10.5]\r\n    },\r\n    'EVENT_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6.28099, 12.56199],\r\n      widthElements: [3.1405, 9.42149, 12.56198]\r\n    },\r\n    'EVENT_PARALLEL_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n        '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [2.56228, 7.68683],\r\n      widthElements: [2.56228, 7.68683]\r\n    },\r\n    'GATEWAY_EXCLUSIVE': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} ' +\r\n                    '{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} ' +\r\n                    '{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z',\r\n      height: 17.5,\r\n      width:  17.5,\r\n      heightElements: [8.5, 6.5312, -6.5312, -8.5],\r\n      widthElements:  [6.5, -6.5, 3, -3, 5, -5]\r\n    },\r\n    'GATEWAY_PARALLEL': {\r\n      d:'m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 30,\r\n      width:  30,\r\n      heightElements: [5, 12.5],\r\n      widthElements: [5, 12.5]\r\n    },\r\n    'GATEWAY_EVENT_BASED': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z',\r\n      height: 11,\r\n      width:  11,\r\n      heightElements: [-6, 6, 12, -12],\r\n      widthElements: [9, -3, -12]\r\n    },\r\n    'GATEWAY_COMPLEX': {\r\n      d:'m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} ' +\r\n        '{e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} ' +\r\n        '{e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} ' +\r\n        '-{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z',\r\n      height: 17.125,\r\n      width:  17.125,\r\n      heightElements: [4.875, 3.4375, 2.125, 3],\r\n      widthElements: [3.4375, 2.125, 4.875, 3]\r\n    },\r\n    'DATA_OBJECT_PATH': {\r\n      d:'m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [10, 50, 60],\r\n      widthElements: [10, 40, 50, 60]\r\n    },\r\n    'DATA_OBJECT_COLLECTION_PATH': {\r\n      d:'m {mx}, {my} ' +\r\n        'm  0 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [12],\r\n      widthElements: [1, 6, 12, 15]\r\n    },\r\n    'DATA_ARROW': {\r\n      d:'m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'DATA_STORE': {\r\n      d:'m  {mx},{my} ' +\r\n        'l  0,{e.y2} ' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'l  0,-{e.y2} ' +\r\n        'c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'm  0,{e.y0}' +\r\n        'c -{e.x0},{e.y1} -{e.x1},{e.y1} -{e.x2},0' +\r\n        'm  0,{e.y0}' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0',\r\n      height: 61,\r\n      width:  61,\r\n      heightElements: [7, 10, 45],\r\n      widthElements:  [2, 58, 60]\r\n    },\r\n    'TEXT_ANNOTATION': {\r\n      d: 'm {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',\r\n      height: 30,\r\n      width: 10,\r\n      heightElements: [30],\r\n      widthElements: [10]\r\n    },\r\n    'MARKER_SUB_PROCESS': {\r\n      d: 'm{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_PARALLEL': {\r\n      d: 'm{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_SEQUENTIAL': {\r\n      d: 'm{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_COMPENSATION': {\r\n      d: 'm {mx},{my} 8,-5 0,10 z m 9,0 8,-5 0,10 z',\r\n      height: 10,\r\n      width: 21,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_LOOP': {\r\n      d: 'm {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 ' +\r\n        '-6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 ' +\r\n        '0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 ' +\r\n        'l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902',\r\n      height: 13.9,\r\n      width: 13.7,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_ADHOC': {\r\n      d: 'm {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 ' +\r\n        '3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 ' +\r\n        '1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 ' +\r\n        '-3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 ' +\r\n        '-2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z',\r\n      height: 4,\r\n      width: 15,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'TASK_TYPE_SEND': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 14,\r\n      width:  21,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_SCRIPT': {\r\n      d: 'm {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 ' +\r\n        'c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z ' +\r\n        'm -7,-12 l 5,0 ' +\r\n        'm -4.5,3 l 4.5,0 ' +\r\n        'm -3,3 l 5,0' +\r\n        'm -4,3 l 5,0',\r\n      height: 15,\r\n      width:  12.6,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_USER_1': {\r\n      d: 'm {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 ' +\r\n        '-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 ' +\r\n        '0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 ' +\r\n        'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z' +\r\n        'm -8,6 l 0,5.5 m 11,0 l 0,-5'\r\n    },\r\n    'TASK_TYPE_USER_2': {\r\n      d: 'm {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 ' +\r\n        '-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 '\r\n    },\r\n    'TASK_TYPE_USER_3': {\r\n      d: 'm {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 ' +\r\n        '4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 ' +\r\n        '-4.20799998,3.36699999 -4.20699998,4.34799999 z'\r\n    },\r\n    'TASK_TYPE_MANUAL': {\r\n      d: 'm {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 ' +\r\n        '-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 ' +\r\n        '0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 ' +\r\n        '-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 ' +\r\n        '0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 ' +\r\n        '-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 ' +\r\n        '2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 ' +\r\n        '-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 ' +\r\n        '-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 ' +\r\n        '-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 ' +\r\n        '0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 ' +\r\n        '-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z'\r\n    },\r\n    'TASK_TYPE_INSTANTIATING_SEND': {\r\n      d: 'm {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6'\r\n    },\r\n    'TASK_TYPE_SERVICE': {\r\n      d: 'm {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 ' +\r\n        '0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 ' +\r\n        '-1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 ' +\r\n        'v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 ' +\r\n        '-0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 ' +\r\n        '-1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 ' +\r\n        'h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 ' +\r\n        '-0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 ' +\r\n        'c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 ' +\r\n        'l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 ' +\r\n        '0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 ' +\r\n        'c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z ' +\r\n        'm 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_SERVICE_FILL': {\r\n      d: 'm {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_HEADER': {\r\n      d: 'm {mx},{my} 0,4 20,0 0,-4 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_MAIN': {\r\n      d: 'm {mx},{my} 0,12 20,0 0,-12 z' +\r\n        'm 0,8 l 20,0 ' +\r\n        'm -13,-4 l 0,8'\r\n    },\r\n    'MESSAGE_FLOW_MARKER': {\r\n      d: 'm {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6'\r\n    }\r\n  };\r\n\r\n  this.getRawPath = function getRawPath(pathId) {\r\n    return this.pathMap[pathId].d;\r\n  };\r\n\r\n  /**\r\n   * Scales the path to the given height and width.\r\n   * <h1>Use case</h1>\r\n   * <p>Use case is to scale the content of elements (event, gateways) based\r\n   * on the element bounding box's size.\r\n   * </p>\r\n   * <h1>Why not transform</h1>\r\n   * <p>Scaling a path with transform() will also scale the stroke and IE does not support\r\n   * the option 'non-scaling-stroke' to prevent this.\r\n   * Also there are use cases where only some parts of a path should be\r\n   * scaled.</p>\r\n   *\r\n   * @param {String} pathId The ID of the path.\r\n   * @param {Object} param <p>\r\n   *   Example param object scales the path to 60% size of the container (data.width, data.height).\r\n   *   <pre>\r\n   *   {\r\n   *     xScaleFactor: 0.6,\r\n   *     yScaleFactor:0.6,\r\n   *     containerWidth: data.width,\r\n   *     containerHeight: data.height,\r\n   *     position: {\r\n   *       mx: 0.46,\r\n   *       my: 0.2,\r\n   *     }\r\n   *   }\r\n   *   </pre>\r\n   *   <ul>\r\n   *    <li>targetpathwidth = xScaleFactor * containerWidth</li>\r\n   *    <li>targetpathheight = yScaleFactor * containerHeight</li>\r\n   *    <li>Position is used to set the starting coordinate of the path. M is computed:\r\n    *    <ul>\r\n    *      <li>position.x * containerWidth</li>\r\n    *      <li>position.y * containerHeight</li>\r\n    *    </ul>\r\n    *    Center of the container <pre> position: {\r\n   *       mx: 0.5,\r\n   *       my: 0.5,\r\n   *     }</pre>\r\n   *     Upper left corner of the container\r\n   *     <pre> position: {\r\n   *       mx: 0.0,\r\n   *       my: 0.0,\r\n   *     }</pre>\r\n   *    </li>\r\n   *   </ul>\r\n   * </p>\r\n   *\r\n   */\r\n  this.getScaledPath = function getScaledPath(pathId, param) {\r\n    var rawPath = this.pathMap[pathId];\r\n\r\n    // positioning\r\n    // compute the start point of the path\r\n    var mx, my;\r\n\r\n    if(!!param.abspos) {\r\n      mx = param.abspos.x;\r\n      my = param.abspos.y;\r\n    } else {\r\n      mx = param.containerWidth * param.position.mx;\r\n      my = param.containerHeight * param.position.my;\r\n    }\r\n\r\n    var coordinates = {}; //map for the scaled coordinates\r\n    if(param.position) {\r\n\r\n      // path\r\n      var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;\r\n      var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;\r\n\r\n\r\n      //Apply height ratio\r\n      for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {\r\n        coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;\r\n      }\r\n\r\n      //Apply width ratio\r\n      for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {\r\n        coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;\r\n      }\r\n    }\r\n\r\n    //Apply value to raw path\r\n    var path = Snap.format(\r\n      rawPath.d, {\r\n        mx: mx,\r\n        my: my,\r\n        e: coordinates\r\n      }\r\n    );\r\n    return path;\r\n  };\r\n}\r\n\r\n\r\nPathMap.$inject = [ 'snap' ];\r\n\r\nmodule.exports = PathMap;\n},{}],10:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __depends__: [ _dereq_('../core') ],\r\n  renderer: [ 'type', _dereq_('./BpmnRenderer') ],\r\n  pathMap: [ 'type', _dereq_('./PathMap') ]\r\n};\n},{\"../core\":7,\"./BpmnRenderer\":8,\"./PathMap\":9}],11:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports.isExpandedPool = function(semantic) {\r\n  return !!semantic.processRef;\r\n};\r\n\r\nmodule.exports.isExpanded = function(semantic) {\r\n  return !semantic.$instanceOf('bpmn:SubProcess') || semantic.di.isExpanded;\r\n};\n},{}],12:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * Returns true if the given semantic has an external label\r\n *\r\n * @param {BpmnElement} semantic\r\n * @return {Boolean} true if has label\r\n */\r\nmodule.exports.hasExternalLabel = function(semantic) {\r\n\r\n  return semantic.$instanceOf('bpmn:Event') ||\r\n         semantic.$instanceOf('bpmn:Gateway') ||\r\n         semantic.$instanceOf('bpmn:DataStoreReference') ||\r\n         semantic.$instanceOf('bpmn:DataObjectReference') ||\r\n         semantic.$instanceOf('bpmn:SequenceFlow') ||\r\n         semantic.$instanceOf('bpmn:MessageFlow');\r\n};\r\n\r\n\r\n/**\r\n * Get the middle of a number of waypoints\r\n *\r\n * @param  {Array<Point>} waypoints\r\n * @return {Point} the mid point\r\n */\r\nmodule.exports.getWaypointsMid = function(waypoints) {\r\n\r\n  var mid = waypoints.length / 2 - 1;\r\n\r\n  var first = waypoints[Math.floor(mid)];\r\n  var second = waypoints[Math.ceil(mid + 0.01)];\r\n\r\n  return {\r\n    x: first.x + (second.x - first.x) / 2,\r\n    y: first.y + (second.y - first.y) / 2\r\n  };\r\n};\r\n\r\n\r\n/**\r\n * Returns the bounds of an elements label, parsed from the elements DI or\r\n * generated from its bounds.\r\n *\r\n * @param {BpmnElement} semantic\r\n * @param {djs.model.Base} element\r\n */\r\nmodule.exports.getExternalLabelBounds = function(semantic, element) {\r\n\r\n  var mid,\r\n      size,\r\n      bounds,\r\n      di = semantic.di,\r\n      label = di.label;\r\n\r\n  if (label && label.bounds) {\r\n    bounds = label.bounds;\r\n\r\n    size = {\r\n      width: Math.max(150, bounds.width),\r\n      height: bounds.height\r\n    };\r\n\r\n    mid = {\r\n      x: bounds.x + bounds.width / 2,\r\n      y: bounds.y\r\n    };\r\n  } else {\r\n\r\n    if (element.waypoints) {\r\n      mid = module.exports.getWaypointsMid(element.waypoints);\r\n    } else {\r\n      mid = {\r\n        x: element.x + element.width / 2,\r\n        y: element.y + element.height - 5\r\n      };\r\n    }\r\n\r\n    size = {\r\n      width: 90,\r\n      height: 50\r\n    };\r\n  }\r\n\r\n  return _.extend({\r\n    x: mid.x - size.width / 2,\r\n    y: mid.y\r\n  }, size);\r\n};\n},{}],13:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/model/Simple');\n},{\"./lib/model/Simple\":15}],14:[function(_dereq_,module,exports){\nvar _ = (window._);\r\n\r\nvar Moddle = _dereq_('moddle'),\r\n    xml = _dereq_('moddle-xml');\r\n\r\n\r\nfunction createModel(packages) {\r\n  return new Moddle(packages);\r\n}\r\n\r\n/**\r\n * @class Bpmn\r\n *\r\n * A wrapper around {@link Moddle} with support for import and export of BPMN 2.0 xml files.\r\n *\r\n * @param {Object|Array} packages to use for instantiating the model\r\n */\r\nfunction Bpmn(packages) {\r\n\r\n  var model = createModel(packages);\r\n\r\n  /**\r\n   * Instantiates a BPMN model tree from a given xml string.\r\n   *\r\n   * @method Bpmn#fromXML\r\n   *\r\n   * @param  {String}   xmlStr\r\n   * @param  {String}   [typeName] name of the root element, defaults to 'bpmn:Definitions'\r\n   * @param  {Object}   [options] options to pass to the underlying reader\r\n   * @param  {Function} callback callback that is invoked with (err, result, parseContext) once the import completes\r\n   */\r\n  function fromXML(xmlStr, typeName, options, callback) {\r\n\r\n    if (!_.isString(typeName)) {\r\n      callback = options;\r\n      options = typeName;\r\n      typeName = 'bpmn:Definitions';\r\n    }\r\n\r\n    if (_.isFunction(options)) {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    var reader = new xml.Reader(model, options);\r\n    var rootHandler = reader.handler(typeName);\r\n\r\n    reader.fromXML(xmlStr, rootHandler, function(err, result) {\r\n      callback(err, result, rootHandler.context);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Serializes a BPMN 2.0 object tree to XML.\r\n   *\r\n   * @method Bpmn#toXML\r\n   *\r\n   * @param  {String}   element the root element, typically an instance of `bpmn:Definitions`\r\n   * @param  {Object}   [options] to pass to the underlying writer\r\n   * @param  {Function} callback invoked with (err, xmlStr) once the import completes\r\n   */\r\n  function toXML(element, options, callback) {\r\n\r\n    if (_.isFunction(options)) {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    var writer = new xml.Writer(options);\r\n    try {\r\n      var result = writer.toXML(element);\r\n      callback(null, result);\r\n    } catch (e) {\r\n      callback(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the underlying moddle instance.\r\n   *\r\n   * @method  Bpmn#instance\r\n   *\r\n   * @return {Moddle}\r\n   */\r\n  function instance() {\r\n    return model;\r\n  }\r\n\r\n\r\n  // API\r\n  this.instance = instance;\r\n\r\n  this.fromXML = fromXML;\r\n  this.toXML = toXML;\r\n}\r\n\r\n\r\nmodule.exports = Bpmn;\n},{\"moddle\":30,\"moddle-xml\":16}],15:[function(_dereq_,module,exports){\nvar BpmnModdle = _dereq_('../Bpmn');\r\n\r\nvar packages = {\r\n  bpmn: _dereq_('../../resources/bpmn/json/bpmn.json'),\r\n  bpmndi: _dereq_('../../resources/bpmn/json/bpmndi.json'),\r\n  dc: _dereq_('../../resources/bpmn/json/dc.json'),\r\n  di: _dereq_('../../resources/bpmn/json/di.json')\r\n};\r\n\r\nmodule.exports = new BpmnModdle(packages);\n},{\"../../resources/bpmn/json/bpmn.json\":39,\"../../resources/bpmn/json/bpmndi.json\":40,\"../../resources/bpmn/json/dc.json\":41,\"../../resources/bpmn/json/di.json\":42,\"../Bpmn\":14}],16:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports.Reader = _dereq_('./lib/Reader');\r\nmodule.exports.Writer = _dereq_('./lib/Writer');\n},{\"./lib/Reader\":17,\"./lib/Writer\":18}],17:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar sax = (window.sax),\r\n    _ = (window._);\r\n\r\nvar common = _dereq_('./common'),\r\n    Types = _dereq_('moddle').types,\r\n    Stack = _dereq_('tiny-stack'),\r\n    parseNameNs = _dereq_('moddle').ns.parseName,\r\n    aliasToName = common.aliasToName;\r\n\r\n\r\nfunction parseNodeAttributes(node) {\r\n  var nodeAttrs = node.attributes;\r\n\r\n  return _.reduce(nodeAttrs, function(result, v, k) {\r\n    var name, ns;\r\n\r\n    if (!v.local) {\r\n      name = v.prefix;\r\n    } else {\r\n      ns = parseNameNs(v.name, v.prefix);\r\n      name = ns.name;\r\n    }\r\n\r\n    result[name] = v.value;\r\n    return result;\r\n  }, {});\r\n}\r\n\r\n/**\r\n * Normalizes namespaces for a node given an optional default namespace and a\r\n * number of mappings from uris to default prefixes.\r\n *\r\n * @param  {XmlNode} node\r\n * @param  {Model} model the model containing all registered namespaces\r\n * @param  {Uri} defaultNsUri\r\n */\r\nfunction normalizeNamespaces(node, model, defaultNsUri) {\r\n  var uri, childUri, prefix;\r\n\r\n  uri = node.uri || defaultNsUri;\r\n\r\n  if (uri) {\r\n    var pkg = model.getPackage(uri);\r\n\r\n    if (pkg) {\r\n      prefix = pkg.prefix;\r\n    } else {\r\n      prefix = node.prefix;\r\n    }\r\n\r\n    node.prefix = prefix;\r\n    node.uri = uri;\r\n  }\r\n\r\n  _.forEach(node.attributes, function(attr) {\r\n    normalizeNamespaces(attr, model, null);\r\n  });\r\n}\r\n\r\n/**\r\n * A parse context.\r\n *\r\n * @class\r\n *\r\n * @param {ElementHandler} parseRoot the root handler for parsing a document\r\n */\r\nfunction Context(parseRoot) {\r\n\r\n  var elementsById = {};\r\n  var references = [];\r\n\r\n  var warnings = [];\r\n\r\n  this.addReference = function(reference) {\r\n    references.push(reference);\r\n  };\r\n\r\n  this.addElement = function(id, element) {\r\n\r\n    if (!id || !element) {\r\n      throw new Error('[xml-reader] id or ctx must not be null');\r\n    }\r\n\r\n    elementsById[id] = element;\r\n  };\r\n\r\n  this.addWarning = function (w) {\r\n    warnings.push(w);\r\n  };\r\n\r\n  this.warnings = warnings;\r\n  this.references = references;\r\n\r\n  this.elementsById = elementsById;\r\n\r\n  this.parseRoot = parseRoot;\r\n}\r\n\r\n\r\nfunction BaseHandler() {}\r\n\r\nBaseHandler.prototype.handleEnd = function() {};\r\nBaseHandler.prototype.handleText = function() {};\r\nBaseHandler.prototype.handleNode = function() {};\r\nBaseHandler.prototype.getElement = function() {\r\n  return this.element;\r\n};\r\n\r\nfunction BodyHandler() {}\r\n\r\nBodyHandler.prototype = new BaseHandler();\r\n\r\nBodyHandler.prototype.handleText = function(text) {\r\n  this.body = (this.body || '') + text;\r\n};\r\n\r\nfunction ReferenceHandler(property, context) {\r\n  this.property = property;\r\n  this.context = context;\r\n}\r\n\r\nReferenceHandler.prototype = new BodyHandler();\r\n\r\nReferenceHandler.prototype.handleNode = function(node) {\r\n\r\n  if (this.element) {\r\n    throw new Error('expected no sub nodes');\r\n  } else {\r\n    this.element = this.createReference(node);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nReferenceHandler.prototype.handleEnd = function() {\r\n  this.element.id = this.body;\r\n};\r\n\r\nReferenceHandler.prototype.createReference = function() {\r\n  return {\r\n    property: this.property.ns.name,\r\n    id: ''\r\n  };\r\n};\r\n\r\nfunction ValueHandler(propertyDesc, element) {\r\n  this.element = element;\r\n  this.propertyDesc = propertyDesc;\r\n}\r\n\r\nValueHandler.prototype = new BodyHandler();\r\n\r\nValueHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      propertyDesc = this.propertyDesc;\r\n\r\n  value = Types.coerceType(propertyDesc.type, value);\r\n\r\n  if (propertyDesc.isMany) {\r\n    element.get(propertyDesc.name).push(value);\r\n  } else {\r\n    element.set(propertyDesc.name, value);\r\n  }\r\n};\r\n\r\n\r\nfunction BaseElementHandler() {}\r\n\r\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\r\n\r\nBaseElementHandler.prototype.handleNode = function(node) {\r\n  var parser = this;\r\n\r\n  if (!this.element) {\r\n    this.element = this.createElement(node);\r\n    var id = this.element.id;\r\n\r\n    if (id) {\r\n      this.context.addElement(id, this.element);\r\n    }\r\n  } else {\r\n    parser = this.handleChild(node);\r\n  }\r\n\r\n  return parser;\r\n};\r\n\r\n/**\r\n * @class XMLReader.ElementHandler\r\n *\r\n */\r\nfunction ElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.type = model.getType(type);\r\n  this.context = context;\r\n}\r\n\r\nElementHandler.prototype = new BaseElementHandler();\r\n\r\nElementHandler.prototype.addReference = function(reference) {\r\n  this.context.addReference(reference);\r\n};\r\n\r\nElementHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      descriptor = element.$descriptor,\r\n      bodyProperty = descriptor.bodyProperty;\r\n\r\n  if (bodyProperty && value !== undefined) {\r\n    value = Types.coerceType(bodyProperty.type, value);\r\n    element.set(bodyProperty.name, value);\r\n  }\r\n};\r\n\r\n/**\r\n * Create an instance of the model from the given node.\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.createElement = function(node) {\r\n  var attributes = parseNodeAttributes(node),\r\n      Type = this.type,\r\n      descriptor = Type.$descriptor,\r\n      context = this.context,\r\n      instance = new Type({});\r\n\r\n  _.forEach(attributes, function(value, name) {\r\n\r\n    var prop = descriptor.propertiesByName[name];\r\n\r\n    if (prop && prop.isReference) {\r\n      context.addReference({\r\n        element: instance,\r\n        property: prop.ns.name,\r\n        id: value\r\n      });\r\n    } else {\r\n      if (prop) {\r\n        value = Types.coerceType(prop.type, value);\r\n      }\r\n\r\n      instance.set(name, value);\r\n    }\r\n  });\r\n\r\n  return instance;\r\n};\r\n\r\nElementHandler.prototype.getPropertyForElement = function(nameNs) {\r\n  if (_.isString(nameNs)) {\r\n    nameNs = parseNameNs(nameNs);\r\n  }\r\n\r\n  var type = this.type,\r\n      model = this.model,\r\n      descriptor = type.$descriptor;\r\n\r\n  var propertyName = nameNs.name;\r\n\r\n  var property = descriptor.propertiesByName[propertyName];\r\n\r\n  // search for properties by name first\r\n  if (property) {\r\n    return property;\r\n  }\r\n\r\n  var pkg = model.getPackage(nameNs.prefix);\r\n\r\n  if (pkg) {\r\n    var typeName = nameNs.prefix + ':' + aliasToName(nameNs.localName, descriptor.$pkg),\r\n        elementType = model.getType(typeName);\r\n\r\n    // search for collection members later\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.hasType(p.type);\r\n    });\r\n\r\n    if (property) {\r\n      return _.extend({}, property, { effectiveType: elementType.$descriptor.name });\r\n    }\r\n  } else {\r\n    // parse unknown element (maybe extension)\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\r\n    });\r\n\r\n    if (property) {\r\n      return property;\r\n    }\r\n  }\r\n\r\n  throw new Error('unrecognized element <' + nameNs.name + '>');\r\n};\r\n\r\nElementHandler.prototype.toString = function() {\r\n  return 'ElementDescriptor[' + this.type.$descriptor.name + ']';\r\n};\r\n\r\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\r\n  return new ValueHandler(propertyDesc, element);\r\n};\r\n\r\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\r\n  return new ReferenceHandler(propertyDesc, this.context);\r\n};\r\n\r\nElementHandler.prototype.handler = function(type) {\r\n  if (type === 'Element') {\r\n    return new GenericElementHandler(this.model, type, this.context);\r\n  } else {\r\n    return new ElementHandler(this.model, type, this.context);\r\n  }\r\n};\r\n\r\n/**\r\n * Handle the child element parsing\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.handleChild = function(node) {\r\n  var nameNs = parseNameNs(node.local, node.prefix);\r\n\r\n  var propertyDesc, type, element, childHandler;\r\n\r\n  propertyDesc = this.getPropertyForElement(nameNs);\r\n  element = this.element;\r\n\r\n  type = propertyDesc.effectiveType || propertyDesc.type;\r\n\r\n  if (Types.isSimple(propertyDesc.type)) {\r\n    return this.valueHandler(propertyDesc, element);\r\n  }\r\n\r\n  if (propertyDesc.isReference) {\r\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\r\n  } else {\r\n    childHandler = this.handler(type).handleNode(node);\r\n  }\r\n\r\n  var newElement = childHandler.getElement();\r\n\r\n  // child handles may decide to skip elements\r\n  // by not returning anything\r\n  if (newElement !== undefined) {\r\n\r\n    if (propertyDesc.isMany) {\r\n      element.get(propertyDesc.name).push(newElement);\r\n    } else {\r\n      element.set(propertyDesc.name, newElement);\r\n    }\r\n\r\n    if (propertyDesc.isReference) {\r\n      _.extend(newElement, {\r\n        element: element\r\n      });\r\n\r\n      this.context.addReference(newElement);\r\n    } else {\r\n      // establish child -> parent relationship\r\n      newElement.$parent = element;\r\n    }\r\n  }\r\n\r\n  return childHandler;\r\n};\r\n\r\n\r\nfunction GenericElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.context = context;\r\n}\r\n\r\nGenericElementHandler.prototype = new BaseElementHandler();\r\n\r\nGenericElementHandler.prototype.createElement = function(node) {\r\n\r\n  var name = node.name,\r\n      prefix = node.prefix,\r\n      uri = node.ns[prefix],\r\n      attributes = node.attributes;\r\n\r\n  return this.model.createAny(name, uri, attributes);\r\n};\r\n\r\nGenericElementHandler.prototype.handleChild = function(node) {\r\n\r\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node),\r\n      element = this.element;\r\n\r\n  var newElement = handler.getElement(),\r\n      children;\r\n\r\n  if (newElement !== undefined) {\r\n    children = element.$children = element.$children || [];\r\n    children.push(newElement);\r\n\r\n    // establish child -> parent relationship\r\n    newElement.$parent = element;\r\n  }\r\n\r\n  return handler;\r\n};\r\n\r\nGenericElementHandler.prototype.handleText = function(text) {\r\n  this.body = this.body || '' + text;\r\n};\r\n\r\nGenericElementHandler.prototype.handleEnd = function() {\r\n  if (this.body) {\r\n    this.element.$body = this.body;\r\n  }\r\n};\r\n\r\n/**\r\n * A reader for a meta-model\r\n *\r\n * @class XMLReader\r\n *\r\n * @param {Model} model used to read xml files\r\n */\r\nfunction XMLReader(model) {\r\n\r\n  function resolveReferences(context) {\r\n\r\n    var elementsById = context.elementsById;\r\n    var references = context.references;\r\n\r\n    _.forEach(references, function(r) {\r\n      var element = r.element;\r\n      var reference = elementsById[r.id];\r\n      var property = element.$descriptor.propertiesByName[r.property];\r\n\r\n      if (!reference) {\r\n        context.addWarning({\r\n          message: 'unresolved reference <' + r.id + '>',\r\n          element: r.element,\r\n          property: r.property,\r\n          value: r.id\r\n        });\r\n      }\r\n\r\n      if (property.isMany) {\r\n        var collection = element.get(property.name),\r\n            idx = collection.indexOf(r);\r\n\r\n        if (!reference) {\r\n          // remove unresolvable reference\r\n          collection.splice(idx, 1);\r\n        } else {\r\n          // update reference\r\n          collection[idx] = reference;\r\n        }\r\n      } else {\r\n        element.set(property.name, reference);\r\n      }\r\n    });\r\n  }\r\n\r\n  function fromXML(xml, rootHandler, done) {\r\n\r\n    var context = new Context(rootHandler);\r\n\r\n    var parser = sax.parser(true, { xmlns: true, trim: true }),\r\n        stack = new Stack();\r\n\r\n    rootHandler.context = context;\r\n\r\n    // push root handler\r\n    stack.push(rootHandler);\r\n\r\n    // error handling\r\n    parser.onerror = function (e) {\r\n      // just throw\r\n      throw e;\r\n    };\r\n\r\n    parser.onopentag = function(node) {\r\n      var handler = stack.peek();\r\n\r\n      normalizeNamespaces(node, model);\r\n\r\n      try {\r\n        stack.push(handler.handleNode(node));\r\n      } catch (e) {\r\n\r\n        var line = this.line,\r\n            column = this.column;\r\n\r\n        throw new Error(\r\n          'unparsable content <' + node.name + '> detected\\n\\t' +\r\n            'line: ' + line + '\\n\\t' +\r\n            'column: ' + column + '\\n\\t' +\r\n            'nested error: ' + e.message);\r\n      }\r\n    };\r\n\r\n    parser.ontext = parser.oncdata = function(text) {\r\n      var handler = stack.peek();\r\n      handler.handleText(text);\r\n    };\r\n\r\n    parser.onclosetag = function(tagName) {\r\n      var old = stack.pop();\r\n      old.handleEnd();\r\n    };\r\n\r\n    parser.onend = function () {\r\n      resolveReferences(context);\r\n      done(null, rootHandler.getElement(), context);\r\n    };\r\n\r\n    try {\r\n      parser.write(xml).close();\r\n    } catch (e) {\r\n      // handle errors\r\n      done(e, undefined, context);\r\n    }\r\n  }\r\n\r\n  return {\r\n    fromXML: fromXML,\r\n\r\n    handler: function(name) {\r\n      return new ElementHandler(model, name);\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = XMLReader;\r\nmodule.exports.ElementHandler = ElementHandler;\n},{\"./common\":19,\"moddle\":20,\"tiny-stack\":29}],18:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('moddle').types,\r\n    common = _dereq_('./common'),\r\n    parseNameNs = _dereq_('moddle').ns.parseName,\r\n    nameToAlias = common.nameToAlias;\r\n\r\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\r\n\r\nvar CDATA_ESCAPE = /[<>\"&]+/;\r\n\r\nvar DEFAULT_NS_MAP = common.DEFAULT_NS_MAP;\r\n\r\n\r\nfunction nsName(ns) {\r\n  if (_.isString(ns)) {\r\n    return ns;\r\n  } else {\r\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\r\n  }\r\n}\r\n\r\nfunction getElementNs(ns, descriptor) {\r\n  if (descriptor.isGeneric) {\r\n    return descriptor.name;\r\n  } else {\r\n    return _.extend({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\r\n  }\r\n}\r\n\r\nfunction getPropertyNs(ns, descriptor) {\r\n  return _.extend({ localName: descriptor.ns.localName }, ns);\r\n}\r\n\r\nfunction getSerializableProperties(element) {\r\n  var descriptor = element.$descriptor;\r\n\r\n  return _.filter(descriptor.properties, function(p) {\r\n    var name = p.name;\r\n\r\n    // do not serialize defaults\r\n    if (!element.hasOwnProperty(name)) {\r\n      return false;\r\n    }\r\n\r\n    var value = element[name];\r\n\r\n    // do not serialize default equals\r\n    if (value === p.default) {\r\n      return false;\r\n    }\r\n\r\n    return p.isMany ? value.length : true;\r\n  });\r\n}\r\n\r\n/**\r\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\r\n *\r\n * @param {String} str the string to escape\r\n * @return {String} the escaped string\r\n */\r\nfunction escapeAttr(str) {\r\n  var escapeMap = {\r\n    '\\n': '&#10;',\r\n    '\\n\\r': '&#10;',\r\n    '\"': '&quot;'\r\n  };\r\n\r\n  // ensure we are handling strings here\r\n  str = _.isString(str) ? str : '' + str;\r\n\r\n  return str.replace(/(\\n|\\n\\r|\")/g, function(str) {\r\n    return escapeMap[str];\r\n  });\r\n}\r\n\r\nfunction filterAttributes(props) {\r\n  return _.filter(props, function(p) { return p.isAttr; });\r\n}\r\n\r\nfunction filterContained(props) {\r\n  return _.filter(props, function(p) { return !p.isAttr; });\r\n}\r\n\r\n\r\nfunction ReferenceSerializer(parent, ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nReferenceSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  return this;\r\n};\r\n\r\nReferenceSerializer.prototype.serializeTo = function(writer) {\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>' + this.element.id + '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction BodySerializer() {}\r\n\r\nBodySerializer.prototype.serializeValue = BodySerializer.prototype.serializeTo = function(writer) {\r\n  var value = this.value,\r\n      escape = this.escape;\r\n\r\n  if (escape) {\r\n    writer.append('<![CDATA[');\r\n  }\r\n\r\n  writer.append(this.value);\r\n\r\n  if (escape) {\r\n    writer.append(']]>');\r\n  }\r\n};\r\n\r\nBodySerializer.prototype.build = function(prop, value) {\r\n  this.value = value;\r\n\r\n  if (prop.type === 'String' && CDATA_ESCAPE.test(value)) {\r\n    this.escape = true;\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nfunction ValueSerializer(ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nValueSerializer.prototype = new BodySerializer();\r\n\r\nValueSerializer.prototype.serializeTo = function(writer) {\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>');\r\n\r\n  this.serializeValue(writer);\r\n\r\n  writer\r\n    .append( '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction ElementSerializer(parent, ns) {\r\n  this.body = [];\r\n  this.attrs = [];\r\n\r\n  this.parent = parent;\r\n  this.ns = ns;\r\n}\r\n\r\nElementSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n\r\n  var otherAttrs = this.parseNsAttributes(element);\r\n\r\n  if (!this.ns) {\r\n    this.ns = this.nsTagName(element.$descriptor);\r\n  }\r\n\r\n  if (element.$descriptor.isGeneric) {\r\n    this.parseGeneric(element);\r\n  } else {\r\n    var properties = getSerializableProperties(element);\r\n\r\n    this.parseAttributes(filterAttributes(properties));\r\n    this.parseContainments(filterContained(properties));\r\n\r\n    this.parseGenericAttributes(element, otherAttrs);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nElementSerializer.prototype.nsTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getElementNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getPropertyNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.ns.uri;\r\n};\r\n\r\nElementSerializer.prototype.nsAttributeName = function(element) {\r\n\r\n  var ns;\r\n\r\n  if (_.isString(element)) {\r\n    ns = parseNameNs(element);\r\n  } else\r\n  if (element.ns) {\r\n    ns = element.ns;\r\n  }\r\n\r\n  var effectiveNs = this.logNamespaceUsed(ns);\r\n\r\n  // strip prefix if same namespace like parent\r\n  if (this.isLocalNs(effectiveNs)) {\r\n    return { localName: ns.localName };\r\n  } else {\r\n    return _.extend({ localName: ns.localName }, effectiveNs);\r\n  }\r\n};\r\n\r\nElementSerializer.prototype.parseGeneric = function(element) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      attrs = this.attrs;\r\n\r\n  _.forEach(element, function(val, key) {\r\n\r\n    if (key === '$body') {\r\n      body.push(new BodySerializer().build({ type: 'String' }, val));\r\n    } else\r\n    if (key === '$children') {\r\n      _.forEach(val, function(child) {\r\n        body.push(new ElementSerializer(self).build(child));\r\n      });\r\n    } else\r\n    if (key.indexOf('$') !== 0) {\r\n      attrs.push({ name: key, value: escapeAttr(val) });\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Parse namespaces and return a list of left over generic attributes\r\n *\r\n * @param  {Object} element\r\n * @return {Array<Object>}\r\n */\r\nElementSerializer.prototype.parseNsAttributes = function(element) {\r\n  var self = this;\r\n\r\n  var genericAttrs = element.$attrs;\r\n\r\n  var attributes = [];\r\n\r\n  // parse namespace attributes first\r\n  // and log them. push non namespace attributes to a list\r\n  // and process them later\r\n  _.forEach(genericAttrs, function(value, name) {\r\n    var nameNs = parseNameNs(name);\r\n\r\n    if (nameNs.prefix === 'xmlns') {\r\n      self.logNamespace({ prefix: nameNs.localName, uri: value });\r\n    } else\r\n    if (!nameNs.prefix && nameNs.localName === 'xmlns') {\r\n      self.logNamespace({ uri: value });\r\n    } else {\r\n      attributes.push({ name: name, value: value });\r\n    }\r\n  });\r\n\r\n  return attributes;\r\n};\r\n\r\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\r\n\r\n  var self = this;\r\n\r\n  _.forEach(attributes, function(attr) {\r\n    try {\r\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\r\n    } catch (e) {\r\n      console.warn('[writer] missing namespace information for ', attr.name, '=', attr.value, 'on', element, e);\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.parseContainments = function(properties) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      element = this.element,\r\n      typeDesc = element.$descriptor;\r\n\r\n  _.forEach(properties, function(p) {\r\n    var value = element.get(p.name),\r\n        isReference = p.isReference,\r\n        isMany = p.isMany;\r\n\r\n    var ns = self.nsPropertyTagName(p);\r\n\r\n    if (!isMany) {\r\n      value = [ value ];\r\n    }\r\n\r\n    if (p.isBody) {\r\n      body.push(new BodySerializer().build(p, value[0]));\r\n    } else\r\n    if (Types.isSimple(p.type)) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ValueSerializer(ns).build(p, v));\r\n      });\r\n    } else\r\n    if (isReference) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ReferenceSerializer(self, ns).build(v));\r\n      });\r\n    } else {\r\n      // allow serialization via type\r\n      // rather than element name\r\n      var asType = p.serialize === 'xsi:type';\r\n\r\n      _.forEach(value, function(v) {\r\n        var serializer;\r\n\r\n        if (asType) {\r\n          serializer = new TypeSerializer(self, ns);\r\n        } else {\r\n          serializer = new ElementSerializer(self);\r\n        }\r\n\r\n        body.push(serializer.build(v));\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.getNamespaces = function() {\r\n  if (!this.parent) {\r\n    if (!this.namespaces) {\r\n      this.namespaces = {\r\n        prefixMap: {},\r\n        uriMap: {},\r\n        used: {}\r\n      };\r\n    }\r\n  } else {\r\n    this.namespaces = this.parent.getNamespaces();\r\n  }\r\n\r\n  return this.namespaces;\r\n};\r\n\r\nElementSerializer.prototype.logNamespace = function(ns) {\r\n  var namespaces = this.getNamespaces();\r\n\r\n  var existing = namespaces.uriMap[ns.uri];\r\n\r\n  if (!existing) {\r\n    namespaces.uriMap[ns.uri] = ns;\r\n  }\r\n\r\n  namespaces.prefixMap[ns.prefix] = ns.uri;\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.logNamespaceUsed = function(ns) {\r\n  var element = this.element,\r\n      model = element.$model,\r\n      namespaces = this.getNamespaces();\r\n\r\n  // ns may be\r\n  //\r\n  //   * prefix only\r\n  //   * prefix:uri\r\n\r\n  var prefix = ns.prefix;\r\n  var uri = ns.uri || DEFAULT_NS_MAP[prefix] ||\r\n            namespaces.prefixMap[prefix] || (model ? (model.getPackage(prefix) || {}).uri : null);\r\n\r\n  if (!uri) {\r\n    throw new Error('no namespace uri given for prefix <' + ns.prefix + '>');\r\n  }\r\n\r\n  ns = namespaces.uriMap[uri];\r\n\r\n  if (!ns) {\r\n    ns = this.logNamespace({ prefix: prefix, uri: uri });\r\n  }\r\n\r\n  if (!namespaces.used[ns.uri]) {\r\n    namespaces.used[ns.uri] = ns;\r\n  }\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.parseAttributes = function(properties) {\r\n  var self = this,\r\n      element = this.element;\r\n\r\n  _.forEach(properties, function(p) {\r\n    self.logNamespaceUsed(p.ns);\r\n\r\n    var value = element.get(p.name);\r\n\r\n    if (p.isReference) {\r\n      value = value.id;\r\n    }\r\n\r\n    self.addAttribute(self.nsAttributeName(p), value);\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.addAttribute = function(name, value) {\r\n  var attrs = this.attrs;\r\n\r\n  if (_.isString(value)) {\r\n    value = escapeAttr(value);\r\n  }\r\n\r\n  attrs.push({ name: name, value: value });\r\n};\r\n\r\nElementSerializer.prototype.serializeAttributes = function(writer) {\r\n  var element = this.element,\r\n      attrs = this.attrs,\r\n      root = !this.parent,\r\n      namespaces = this.namespaces;\r\n\r\n  function collectNsAttrs() {\r\n    return _.collect(namespaces.used, function(ns) {\r\n      var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\r\n      return { name: name, value: ns.uri };\r\n    });\r\n  }\r\n\r\n  if (root) {\r\n    attrs = collectNsAttrs().concat(attrs);\r\n  }\r\n\r\n  _.forEach(attrs, function(a) {\r\n    writer\r\n      .append(' ')\r\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.serializeTo = function(writer) {\r\n  var hasBody = this.body.length;\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns));\r\n\r\n  this.serializeAttributes(writer);\r\n\r\n  writer\r\n    .append(hasBody ? '>' : ' />')\r\n    .appendNewLine();\r\n\r\n  writer.indent();\r\n\r\n  _.forEach(this.body, function(b) {\r\n    b.serializeTo(writer);\r\n  });\r\n\r\n  writer.unindent();\r\n\r\n  if (hasBody) {\r\n    writer\r\n      .appendIndent()\r\n      .append('</' + nsName(this.ns) + '>')\r\n      .appendNewLine();\r\n  }\r\n};\r\n\r\n/**\r\n * A serializer for types that handles serialization of data types\r\n */\r\nfunction TypeSerializer(parent, ns) {\r\n  ElementSerializer.call(this, parent, ns);\r\n}\r\n\r\nTypeSerializer.prototype = new ElementSerializer();\r\n\r\nTypeSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  this.typeNs = this.nsTagName(element.$descriptor);\r\n\r\n  return ElementSerializer.prototype.build.call(this, element);\r\n};\r\n\r\nTypeSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.typeNs.uri;\r\n};\r\n\r\nfunction SavingWriter() {\r\n  this.value = '';\r\n\r\n  this.write = function(str) {\r\n    this.value += str;\r\n  };\r\n}\r\n\r\nfunction FormatingWriter(out, format) {\r\n\r\n  var indent = [''];\r\n\r\n  this.append = function(str) {\r\n    out.write(str);\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendNewLine = function() {\r\n    if (format) {\r\n      out.write('\\n');\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendIndent = function() {\r\n    if (format) {\r\n      out.write(indent.join('  '));\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.indent = function() {\r\n    indent.push('');\r\n    return this;\r\n  };\r\n\r\n  this.unindent = function() {\r\n    indent.pop();\r\n    return this;\r\n  };\r\n}\r\n\r\n/**\r\n * A writer for meta-model backed document trees\r\n *\r\n * @class XMLWriter\r\n */\r\nfunction XMLWriter(options) {\r\n\r\n  options = _.extend({ format: false, preamble: true }, options || {});\r\n\r\n  function toXML(tree, writer) {\r\n    var internalWriter = writer || new SavingWriter();\r\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\r\n\r\n    if (options.preamble) {\r\n      formatingWriter.append(XML_PREAMBLE);\r\n    }\r\n\r\n    new ElementSerializer().build(tree).serializeTo(formatingWriter);\r\n\r\n    if (!writer) {\r\n      return internalWriter.value;\r\n    }\r\n  }\r\n\r\n  return {\r\n    toXML: toXML\r\n  };\r\n}\r\n\r\nmodule.exports = XMLWriter;\n},{\"./common\":19,\"moddle\":20}],19:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nfunction capitalize(string) {\r\n  return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction lower(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nfunction hasLowerCaseAlias(pkg) {\r\n  return pkg.xml && pkg.xml.alias === 'lowerCase';\r\n}\r\n\r\n\r\nmodule.exports.aliasToName = function(alias, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return capitalize(alias);\r\n  } else {\r\n    return alias;\r\n  }\r\n};\r\n\r\nmodule.exports.nameToAlias = function(name, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return lower(name);\r\n  } else {\r\n    return name;\r\n  }\r\n};\r\n\r\nmodule.exports.DEFAULT_NS_MAP = {\r\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance'\r\n};\n},{}],20:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = _dereq_('./lib/moddle');\r\n\r\nmodule.exports.types = _dereq_('./lib/types');\r\n\r\nmodule.exports.ns = _dereq_('./lib/ns');\n},{\"./lib/moddle\":24,\"./lib/ns\":25,\"./lib/types\":28}],21:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nfunction Base() { }\r\n\r\nBase.prototype.get = function(name) {\r\n  return this.$model.properties.get(this, name);\r\n};\r\n\r\nBase.prototype.set = function(name, value) {\r\n  this.$model.properties.set(this, name, value);\r\n};\r\n\r\n\r\nmodule.exports = Base;\n},{}],22:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\nfunction DescriptorBuilder(nameNs) {\r\n  this.ns = nameNs;\r\n  this.name = nameNs.name;\r\n  this.allTypes = [];\r\n  this.properties = [];\r\n  this.propertiesByName = {};\r\n}\r\n\r\nmodule.exports = DescriptorBuilder;\r\n\r\n\r\nDescriptorBuilder.prototype.build = function() {\r\n  return _.pick(this, [ 'ns', 'name', 'allTypes', 'properties', 'propertiesByName', 'bodyProperty' ]);\r\n};\r\n\r\nDescriptorBuilder.prototype.addProperty = function(p, idx) {\r\n  this.addNamedProperty(p, true);\r\n\r\n  var properties = this.properties;\r\n\r\n  if (idx !== undefined) {\r\n    properties.splice(idx, 0, p);\r\n  } else {\r\n    properties.push(p);\r\n  }\r\n};\r\n\r\n\r\nDescriptorBuilder.prototype.replaceProperty = function(oldProperty, newProperty) {\r\n  var oldNameNs = oldProperty.ns;\r\n\r\n  var props = this.properties,\r\n      propertiesByName = this.propertiesByName;\r\n\r\n  if (oldProperty.isBody) {\r\n\r\n    if (!newProperty.isBody) {\r\n      throw new Error(\r\n        'property <' + newProperty.ns.name + '> must be body property ' +\r\n        'to refine <' + oldProperty.ns.name + '>');\r\n    }\r\n\r\n    // TODO: Check compatibility\r\n    this.setBodyProperty(newProperty, false);\r\n  }\r\n\r\n  this.addNamedProperty(newProperty, true);\r\n\r\n  // replace old property at index with new one\r\n  var idx = props.indexOf(oldProperty);\r\n  if (idx === -1) {\r\n    throw new Error('property <' + oldNameNs.name + '> not found in property list');\r\n  }\r\n\r\n  props[idx] = newProperty;\r\n\r\n  // replace propertiesByName entry with new property\r\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] = newProperty;\r\n};\r\n\r\n\r\nDescriptorBuilder.prototype.redefineProperty = function(p) {\r\n\r\n  var nsPrefix = p.ns.prefix;\r\n  var parts = p.redefines.split('#');\r\n\r\n  var name = parseNameNs(parts[0], nsPrefix);\r\n  var attrName = parseNameNs(parts[1], name.prefix).name;\r\n\r\n  var redefinedProperty = this.propertiesByName[attrName];\r\n  if (!redefinedProperty) {\r\n    throw new Error('refined property <' + attrName + '> not found');\r\n  } else {\r\n    this.replaceProperty(redefinedProperty, p);\r\n  }\r\n\r\n  delete p.redefines;\r\n};\r\n\r\nDescriptorBuilder.prototype.addNamedProperty = function(p, validate) {\r\n  var ns = p.ns,\r\n      propsByName = this.propertiesByName;\r\n\r\n  if (validate) {\r\n    this.assertNotDefined(p, ns.name);\r\n    this.assertNotDefined(p, ns.localName);\r\n  }\r\n\r\n  propsByName[ns.name] = propsByName[ns.localName] = p;\r\n};\r\n\r\nDescriptorBuilder.prototype.removeNamedProperty = function(p) {\r\n  var ns = p.ns,\r\n      propsByName = this.propertiesByName;\r\n\r\n  delete propsByName[ns.name];\r\n  delete propsByName[ns.localName];\r\n};\r\n\r\nDescriptorBuilder.prototype.setBodyProperty = function(p, validate) {\r\n\r\n  if (validate && this.bodyProperty) {\r\n    throw new Error(\r\n      'body property defined multiple times ' +\r\n      '(<' + this.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\r\n  }\r\n\r\n  this.bodyProperty = p;\r\n};\r\n\r\nDescriptorBuilder.prototype.addIdProperty = function(name) {\r\n  var nameNs = parseNameNs(name, this.ns.prefix);\r\n\r\n  var p = {\r\n    name: nameNs.localName,\r\n    type: 'String',\r\n    isAttr: true,\r\n    ns: nameNs\r\n  };\r\n\r\n  // ensure that id is always the first attribute (if present)\r\n  this.addProperty(p, 0);\r\n};\r\n\r\nDescriptorBuilder.prototype.assertNotDefined = function(p, name) {\r\n  var propertyName = p.name,\r\n      definedProperty = this.propertiesByName[propertyName];\r\n\r\n  if (definedProperty) {\r\n    throw new Error(\r\n      'property <' + propertyName + '> already defined; ' +\r\n      'override of <' + definedProperty.definedBy.ns.name + '#' + definedProperty.ns.name + '> by ' +\r\n      '<' + p.definedBy.ns.name + '#' + p.ns.name + '> not allowed without redefines');\r\n  }\r\n};\r\n\r\nDescriptorBuilder.prototype.hasProperty = function(name) {\r\n  return this.propertiesByName[name];\r\n};\r\n\r\nDescriptorBuilder.prototype.addTrait = function(t) {\r\n\r\n  var allTypes = this.allTypes;\r\n\r\n  if (allTypes.indexOf(t) !== -1) {\r\n    return;\r\n  }\r\n\r\n  _.forEach(t.properties, function(p) {\r\n\r\n    // clone property to allow extensions\r\n    p = _.extend({}, p, {\r\n      name: p.ns.localName\r\n    });\r\n\r\n    Object.defineProperty(p, 'definedBy', {\r\n      value: t\r\n    });\r\n\r\n    // add redefine support\r\n    if (p.redefines) {\r\n      this.redefineProperty(p);\r\n    } else {\r\n      if (p.isBody) {\r\n        this.setBodyProperty(p);\r\n      }\r\n      this.addProperty(p);\r\n    }\r\n  }, this);\r\n\r\n  allTypes.push(t);\r\n};\r\n\n},{\"./ns\":25}],23:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Base = _dereq_('./base');\r\n\r\n\r\nfunction Factory(model, properties) {\r\n  this.model = model;\r\n  this.properties = properties;\r\n}\r\n\r\nmodule.exports = Factory;\r\n\r\n\r\nFactory.prototype.createType = function(descriptor) {\r\n\r\n  var model = this.model;\r\n\r\n  var props = this.properties,\r\n      prototype = Object.create(Base.prototype);\r\n\r\n  // initialize default values\r\n  _.forEach(descriptor.properties, function(p) {\r\n    if (!p.isMany && p.default !== undefined) {\r\n      prototype[p.name] = p.default;\r\n    }\r\n  });\r\n\r\n  props.defineModel(prototype, model);\r\n  props.defineDescriptor(prototype, descriptor);\r\n\r\n  var name = descriptor.ns.name;\r\n\r\n  /**\r\n   * The new type constructor\r\n   */\r\n  function ModdleElement(attrs) {\r\n    props.define(this, '$type', { value: name, enumerable: true });\r\n    props.define(this, '$attrs', { value: {} });\r\n    props.define(this, '$parent', { writable: true });\r\n\r\n    _.forEach(attrs, function(val, key) {\r\n      this.set(key, val);\r\n    }, this);\r\n  }\r\n\r\n  ModdleElement.prototype = prototype;\r\n\r\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\r\n\r\n  // static links\r\n  props.defineModel(ModdleElement, model);\r\n  props.defineDescriptor(ModdleElement, descriptor);\r\n\r\n  return ModdleElement;\r\n};\n},{\"./base\":21}],24:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('./types'),\r\n    Factory = _dereq_('./factory'),\r\n    Registry = _dereq_('./registry'),\r\n    Properties = _dereq_('./properties');\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\n//// Moddle implementation /////////////////////////////////////////////////\r\n\r\n/**\r\n * @class Moddle\r\n *\r\n * A model that can be used to create elements of a specific type.\r\n *\r\n * @example\r\n *\r\n * var Moddle = require('moddle');\r\n *\r\n * var pkg = {\r\n *   name: 'mypackage',\r\n *   prefix: 'my',\r\n *   types: [\r\n *     { name: 'Root' }\r\n *   ]\r\n * };\r\n *\r\n * var moddle = new Moddle([pkg]);\r\n *\r\n * @param {Array<Package>} packages  the packages to contain\r\n * @param {Object} options  additional options to pass to the model\r\n */\r\nfunction Moddle(packages, options) {\r\n\r\n  options = options || [];\r\n\r\n  this.properties = options.properties || new Properties(this);\r\n\r\n  this.factory = options.factory || new Factory(this, this.properties);\r\n  this.registry = options.registry || new Registry(packages, this.properties, options);\r\n\r\n  this.typeCache = {};\r\n}\r\n\r\nmodule.exports = Moddle;\r\n\r\n\r\n/**\r\n * Create an instance of the specified type.\r\n *\r\n * @method Moddle#create\r\n *\r\n * @example\r\n *\r\n * var foo = moddle.create('my:Foo');\r\n * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\r\n *\r\n * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\r\n * @return {Object}         model instance\r\n */\r\nModdle.prototype.create = function(descriptor, attrs) {\r\n  var Type = this.getType(descriptor);\r\n\r\n  if (!Type) {\r\n    throw new Error('unknown type <' + descriptor + '>');\r\n  }\r\n\r\n  return new Type(attrs);\r\n};\r\n\r\n\r\n/**\r\n * Returns the type representing a given descriptor\r\n *\r\n * @method Moddle#getType\r\n *\r\n * @example\r\n *\r\n * var Foo = moddle.getType('my:Foo');\r\n * var foo = new Foo({ 'id' : 'FOO_1' });\r\n *\r\n * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n * @return {Object}         the type representing the descriptor\r\n */\r\nModdle.prototype.getType = function(descriptor) {\r\n\r\n  var cache = this.typeCache;\r\n\r\n  var name = _.isString(descriptor) ? descriptor : descriptor.ns.name;\r\n\r\n  var type = cache[name];\r\n\r\n  if (!type) {\r\n    descriptor = this.registry.getEffectiveDescriptor(name);\r\n    type = cache[descriptor.name] = this.factory.createType(descriptor);\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\n\r\n/**\r\n * Creates an any-element type to be used within model instances.\r\n *\r\n * This can be used to create custom elements that lie outside the meta-model.\r\n * The created element contains all the meta-data required to serialize it\r\n * as part of meta-model elements.\r\n *\r\n * @method Moddle#createAny\r\n *\r\n * @example\r\n *\r\n * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\r\n *   value: 'bar'\r\n * });\r\n *\r\n * var container = moddle.create('my:Container', 'http://my', {\r\n *   any: [ foo ]\r\n * });\r\n *\r\n * // go ahead and serialize the stuff\r\n *\r\n *\r\n * @param  {String} name  the name of the element\r\n * @param  {String} nsUri the namespace uri of the element\r\n * @param  {Object} [properties] a map of properties to initialize the instance with\r\n * @return {Object} the any type instance\r\n */\r\nModdle.prototype.createAny = function(name, nsUri, properties) {\r\n\r\n  var nameNs = parseNameNs(name);\r\n\r\n  var element = {\r\n    $type: name\r\n  };\r\n\r\n  var descriptor = {\r\n    name: name,\r\n    isGeneric: true,\r\n    ns: {\r\n      prefix: nameNs.prefix,\r\n      localName: nameNs.localName,\r\n      uri: nsUri\r\n    }\r\n  };\r\n\r\n  this.properties.defineDescriptor(element, descriptor);\r\n  this.properties.defineModel(element, this);\r\n  this.properties.define(element, '$parent', { enumerable: false, writable: true });\r\n\r\n  _.forEach(properties, function(a, key) {\r\n    if (_.isObject(a) && a.value !== undefined) {\r\n      element[a.name] = a.value;\r\n    } else {\r\n      element[key] = a;\r\n    }\r\n  });\r\n\r\n  return element;\r\n};\r\n\r\n/**\r\n * Returns a registered package by uri or prefix\r\n *\r\n * @return {Object} the package\r\n */\r\nModdle.prototype.getPackage = function(uriOrPrefix) {\r\n  return this.registry.getPackage(uriOrPrefix);\r\n};\r\n\r\n/**\r\n * Returns a snapshot of all known packages\r\n *\r\n * @return {Object} the package\r\n */\r\nModdle.prototype.getPackages = function() {\r\n  return this.registry.getPackages();\r\n};\r\n\r\n/**\r\n * Returns the descriptor for an element\r\n */\r\nModdle.prototype.getElementDescriptor = function(element) {\r\n  return element.$descriptor;\r\n};\r\n\r\n/**\r\n * Returns true if the given descriptor or instance\r\n * represents the given type.\r\n *\r\n * May be applied to this, if element is omitted.\r\n */\r\nModdle.prototype.hasType = function(element, type) {\r\n  if (type === undefined) {\r\n    type = element;\r\n    element = this;\r\n  }\r\n\r\n  var descriptor = element.$model.getElementDescriptor(element);\r\n\r\n  return !!_.find(descriptor.allTypes, function(t) {\r\n    return t.name === type;\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Returns the descriptor of an elements named property\r\n */\r\nModdle.prototype.getPropertyDescriptor = function(element, property) {\r\n  return this.getElementDescriptor(element).propertiesByName[property];\r\n};\r\n\n},{\"./factory\":23,\"./ns\":25,\"./properties\":26,\"./registry\":27,\"./types\":28}],25:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\r\n * given a default prefix to assume in case no explicit namespace is given.\r\n *\r\n * @param {String} name\r\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\r\n *\r\n * @return {Object} the parsed name\r\n */\r\nmodule.exports.parseName = function(name, defaultPrefix) {\r\n  var parts = name.split(/:/),\r\n      localName, prefix;\r\n\r\n  // no prefix (i.e. only local name)\r\n  if (parts.length === 1) {\r\n    localName = name;\r\n    prefix = defaultPrefix;\r\n  } else\r\n  // prefix + local name\r\n  if (parts.length === 2) {\r\n    localName = parts[1];\r\n    prefix = parts[0];\r\n  } else {\r\n    throw new Error('expected <prefix:localName> or <localName>, got ' + name);\r\n  }\r\n\r\n  name = (prefix ? prefix + ':' : '') + localName;\r\n\r\n  return {\r\n    name: name,\r\n    prefix: prefix,\r\n    localName: localName\r\n  };\r\n};\n},{}],26:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\n/**\r\n * A utility that gets and sets properties of model elements.\r\n *\r\n * @param {Model} model\r\n */\r\nfunction Properties(model) {\r\n  this.model = model;\r\n}\r\n\r\nmodule.exports = Properties;\r\n\r\n\r\n/**\r\n * Sets a named property on the target element\r\n *\r\n * @param {Object} target\r\n * @param {String} name\r\n * @param {Object} value\r\n */\r\nProperties.prototype.set = function(target, name, value) {\r\n\r\n  var property = this.model.getPropertyDescriptor(target, name);\r\n\r\n  if (!property) {\r\n    target.$attrs[name] = value;\r\n  } else {\r\n    Object.defineProperty(target, property.name, {\r\n      enumerable: !property.isReference,\r\n      writable: true,\r\n      value: value\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Returns the named property of the given element\r\n *\r\n * @param  {Object} target\r\n * @param  {String} name\r\n *\r\n * @return {Object}\r\n */\r\nProperties.prototype.get = function(target, name) {\r\n\r\n  var property = this.model.getPropertyDescriptor(target, name),\r\n      propertyName = property.name;\r\n\r\n  if (!property) {\r\n    return target[name];\r\n  }\r\n\r\n  // check if access to collection property and lazily initialize it\r\n  if (!target[propertyName] && property.isMany) {\r\n    Object.defineProperty(target, propertyName, {\r\n      enumerable: !property.isReference,\r\n      writable: true,\r\n      value: []\r\n    });\r\n  }\r\n\r\n  return target[propertyName];\r\n};\r\n\r\n\r\n/**\r\n * Define a property on the target element\r\n *\r\n * @param  {Object} target\r\n * @param  {String} name\r\n * @param  {Object} options\r\n */\r\nProperties.prototype.define = function(target, name, options) {\r\n  Object.defineProperty(target, name, options);\r\n};\r\n\r\n\r\n/**\r\n * Define the descriptor for an element\r\n */\r\nProperties.prototype.defineDescriptor = function(target, descriptor) {\r\n  this.define(target, '$descriptor', { value: descriptor });\r\n};\r\n\r\n/**\r\n * Define the model for an element\r\n */\r\nProperties.prototype.defineModel = function(target, model) {\r\n  this.define(target, '$model', { value: model });\r\n};\n},{}],27:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('./types'),\r\n    DescriptorBuilder = _dereq_('./descriptor-builder');\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\nfunction Registry(packages, properties, options) {\r\n  this.options = _.extend({ generateId: 'id' }, options || {});\r\n\r\n  this.packageMap = {};\r\n  this.typeMap = {};\r\n\r\n  this.packages = [];\r\n\r\n  this.properties = properties;\r\n\r\n  _.forEach(packages, this.registerPackage, this);\r\n}\r\n\r\nmodule.exports = Registry;\r\n\r\n\r\nRegistry.prototype.getPackage = function(uriOrPrefix) {\r\n  return this.packageMap[uriOrPrefix];\r\n};\r\n\r\nRegistry.prototype.getPackages = function() {\r\n  return this.packages;\r\n};\r\n\r\n\r\nRegistry.prototype.registerPackage = function(pkg) {\r\n\r\n  // register types\r\n  _.forEach(pkg.types, function(descriptor) {\r\n    this.registerType(descriptor, pkg);\r\n  }, this);\r\n\r\n  this.packageMap[pkg.uri] = this.packageMap[pkg.prefix] = pkg;\r\n  this.packages.push(pkg);\r\n};\r\n\r\n\r\n/**\r\n * Register a type from a specific package with us\r\n */\r\nRegistry.prototype.registerType = function(type, pkg) {\r\n\r\n  var ns = parseNameNs(type.name, pkg.prefix),\r\n      name = ns.name,\r\n      propertiesByName = {};\r\n\r\n  // parse properties\r\n  _.forEach(type.properties, function(p) {\r\n\r\n    // namespace property names\r\n    var propertyNs = parseNameNs(p.name, ns.prefix),\r\n        propertyName = propertyNs.name;\r\n\r\n    // namespace property types\r\n    if (!Types.isBuiltIn(p.type)) {\r\n      p.type = parseNameNs(p.type, propertyNs.prefix).name;\r\n    }\r\n\r\n    _.extend(p, {\r\n      ns: propertyNs,\r\n      name: propertyName\r\n    });\r\n\r\n    propertiesByName[propertyName] = p;\r\n  });\r\n\r\n  // update ns + name\r\n  _.extend(type, {\r\n    ns: ns,\r\n    name: name,\r\n    propertiesByName: propertiesByName\r\n  });\r\n\r\n  // link to package\r\n  this.definePackage(type, pkg);\r\n\r\n  // register\r\n  this.typeMap[name] = type;\r\n};\r\n\r\n\r\n/**\r\n * Traverse the type hierarchy from bottom to top.\r\n */\r\nRegistry.prototype.mapTypes = function(nsName, iterator) {\r\n\r\n  var type = this.typeMap[nsName.name];\r\n\r\n  if (!type) {\r\n    throw new Error('unknown type <' + nsName.name + '>');\r\n  }\r\n\r\n  _.forEach(type.superClass, function(cls) {\r\n    var parentNs = parseNameNs(cls, nsName.prefix);\r\n    this.mapTypes(parentNs, iterator);\r\n  }, this);\r\n\r\n  iterator(type);\r\n};\r\n\r\n\r\n/**\r\n * Returns the effective descriptor for a type.\r\n *\r\n * @param  {String} type the namespaced name (ns:localName) of the type\r\n *\r\n * @return {Descriptor} the resulting effective descriptor\r\n */\r\nRegistry.prototype.getEffectiveDescriptor = function(name) {\r\n\r\n  var options = this.options,\r\n      nsName = parseNameNs(name);\r\n\r\n  var builder = new DescriptorBuilder(nsName);\r\n\r\n  this.mapTypes(nsName, function(type) {\r\n    builder.addTrait(type);\r\n  });\r\n\r\n  // check we have an id assigned\r\n  var id = this.options.generateId;\r\n  if (id && !builder.hasProperty(id)) {\r\n    builder.addIdProperty(id);\r\n  }\r\n\r\n  var descriptor = builder.build();\r\n\r\n  // define package link\r\n  this.definePackage(descriptor, descriptor.allTypes[descriptor.allTypes.length - 1].$pkg);\r\n\r\n  return descriptor;\r\n};\r\n\r\n\r\nRegistry.prototype.definePackage = function(target, pkg) {\r\n  this.properties.define(target, '$pkg', { value: pkg });\r\n};\n},{\"./descriptor-builder\":22,\"./ns\":25,\"./types\":28}],28:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Built-in moddle types\r\n */\r\nvar BUILTINS = {\r\n  String: true,\r\n  Boolean: true,\r\n  Integer: true,\r\n  Real: true,\r\n  Element: true,\r\n};\r\n\r\n/**\r\n * Converters for built in types from string representations\r\n */\r\nvar TYPE_CONVERTERS = {\r\n  String: function(s) { return s; },\r\n  Boolean: function(s) { return s === 'true'; },\r\n  Integer: function(s) { return parseInt(s, 10); },\r\n  Real: function(s) { return parseFloat(s, 10); }\r\n};\r\n\r\n/**\r\n * Convert a type to its real representation\r\n */\r\nmodule.exports.coerceType = function(type, value) {\r\n\r\n  var converter = TYPE_CONVERTERS[type];\r\n\r\n  if (converter) {\r\n    return converter(value);\r\n  } else {\r\n    return value;\r\n  }\r\n};\r\n\r\n/**\r\n * Return whether the given type is built-in\r\n */\r\nmodule.exports.isBuiltIn = function(type) {\r\n  return !!BUILTINS[type];\r\n};\r\n\r\n/**\r\n * Return whether the given type is simple\r\n */\r\nmodule.exports.isSimple = function(type) {\r\n  return !!TYPE_CONVERTERS[type];\r\n};\n},{}],29:[function(_dereq_,module,exports){\n/**\n * Tiny stack for browser or server\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2014 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/tiny-stack/master/LICENSE>\n * @link http://avoidwork.github.io/tiny-stack\n * @module tiny-stack\n * @version 0.1.0\n */\n\n( function ( global ) {\n\n\"use strict\";\n\n/**\n * TinyStack\n *\n * @constructor\n */\nfunction TinyStack () {\n\tthis.data = [null];\n\tthis.top  = 0;\n}\n\n/**\n * Clears the stack\n *\n * @method clear\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.clear = function clear () {\n\tthis.data = [null];\n\tthis.top  = 0;\n\n\treturn this;\n};\n\n/**\n * Gets the size of the stack\n *\n * @method length\n * @memberOf TinyStack\n * @return {Number} Size of stack\n */\nTinyStack.prototype.length = function length () {\n\treturn this.top;\n};\n\n/**\n * Gets the item at the top of the stack\n *\n * @method peek\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.peek = function peek () {\n\treturn this.data[this.top];\n};\n\n/**\n * Gets & removes the item at the top of the stack\n *\n * @method pop\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.pop = function pop () {\n\tif ( this.top > 0 ) {\n\t\tthis.top--;\n\n\t\treturn this.data.pop();\n\t}\n\telse {\n\t\treturn undefined;\n\t}\n};\n\n/**\n * Pushes an item onto the stack\n *\n * @method push\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.push = function push ( arg ) {\n\tthis.data[++this.top] = arg;\n\n\treturn this;\n};\n\n/**\n * TinyStack factory\n *\n * @method factory\n * @return {Object} {@link TinyStack}\n */\nfunction factory () {\n\treturn new TinyStack();\n}\n\n// Node, AMD & window supported\nif ( typeof exports != \"undefined\" ) {\n\tmodule.exports = factory;\n}\nelse if ( typeof define == \"function\" ) {\n\tdefine( function () {\n\t\treturn factory;\n\t} );\n}\nelse {\n\tglobal.stack = factory;\n}\n} )( this );\n\n},{}],30:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(20)\n},{\"./lib/moddle\":34,\"./lib/ns\":35,\"./lib/types\":38}],31:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(21)\n},{}],32:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(22)\n},{\"./ns\":35}],33:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(23)\n},{\"./base\":31}],34:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(24)\n},{\"./factory\":33,\"./ns\":35,\"./properties\":36,\"./registry\":37,\"./types\":38}],35:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(25)\n},{}],36:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(26)\n},{}],37:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(27)\n},{\"./descriptor-builder\":32,\"./ns\":35,\"./types\":38}],38:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(28)\n},{}],39:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"BPMN20\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/MODEL\",\n  \"associations\": [],\n  \"types\": [\n    {\n      \"name\": \"Interface\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operations\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operations_interface\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Operation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_inMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_outMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"errorRefs\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRefs_operation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EndPoint\",\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"Auditing\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"GlobalTask\",\n      \"superClass\": [\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_globalTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Monitoring\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Performer\",\n      \"superClass\": [\n        \"ResourceRole\"\n      ]\n    },\n    {\n      \"name\": \"Process\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"processType\",\n          \"type\": \"ProcessType\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_process\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_process\"\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"supports\",\n          \"type\": \"Process\",\n          \"association\": \"A_supports_process\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"definitionalCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_definitionalCollaborationRef_process\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"isExecutable\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationSubscriptions\",\n          \"type\": \"CorrelationSubscription\",\n          \"association\": \"A_correlationSubscriptions_process\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LaneSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_lanes_laneSet\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Lane\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"childLaneSet\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_childLaneSet_parentLane\"\n        },\n        {\n          \"name\": \"partitionElementRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElementRef_lane\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"flowNodeRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"partitionElement\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElement_lane\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalManualTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ]\n    },\n    {\n      \"name\": \"ManualTask\",\n      \"superClass\": [\n        \"Task\"\n      ]\n    },\n    {\n      \"name\": \"UserTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_usertask\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Rendering\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"HumanPerformer\",\n      \"superClass\": [\n        \"Performer\"\n      ]\n    },\n    {\n      \"name\": \"PotentialOwner\",\n      \"superClass\": [\n        \"HumanPerformer\"\n      ]\n    },\n    {\n      \"name\": \"GlobalUserTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_globalUserTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Gateway\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"gatewayDirection\",\n          \"type\": \"GatewayDirection\",\n          \"default\": \"unspecified\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"eventGatewayType\",\n          \"type\": \"EventBasedGatewayType\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"activationCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_activationCondition_complexGateway\"\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_complexGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_exclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_inclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParallelGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ]\n    },\n    {\n      \"name\": \"RootElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Relationship\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"direction\",\n          \"type\": \"RelationshipDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sources\",\n          \"association\": \"A_sources_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"targets\",\n          \"association\": \"A_targets_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BaseElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"id\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionDefinitions\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionDefinitions_baseElement\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"extensionElements\",\n          \"type\": \"ExtensionElements\",\n          \"association\": \"A_extensionElements_baseElement\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"type\": \"Documentation\",\n          \"association\": \"A_documentation_baseElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Extension\",\n      \"properties\": [\n        {\n          \"name\": \"mustUnderstand\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"definition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_definition_extension\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionAttributeDefinitions\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionAttributeDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isReference\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"extensionDefinition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionElements\",\n      \"properties\": [\n        {\n          \"name\": \"valueRef\",\n          \"association\": \"A_valueRef_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"values\",\n          \"association\": \"A_value_extensionElements\",\n          \"type\": \"Element\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensionAttributeDefinition\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinition_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Documentation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"isAttr\": true,\n          \"type\": \"String\",\n          \"isBody\": true\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Event\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\",\n        \"InteractionNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_event\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"IntermediateCatchEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ]\n    },\n    {\n      \"name\": \"IntermediateThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"EndEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"StartEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isInterrupting\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ThrowEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSet\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSet_throwEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_throwEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociation\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociation_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_throwEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CatchEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"parallelMultiple\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSet\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSet_catchEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_catchEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataOutputAssociation\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociation_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_catchEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"BoundaryEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"cancelActivity\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"attachedToRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventDefinition\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CancelEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"ErrorEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"errorRef\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRef_errorEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TerminateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"EscalationEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"escalationRef\",\n          \"type\": \"Escalation\",\n          \"association\": \"A_escalationRef_escalationEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Escalation\",\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_escalation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"escalationCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ],\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CompensateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"waitForCompletion\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"activityRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_activityRef_compensateEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TimerEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"timeDate\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDate_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeCycle\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeCycle_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeDuration\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDuration_timerEventDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"LinkEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"source\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConditionalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_condition_conditionalEventDefinition\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"SignalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"signalRef\",\n          \"type\": \"Signal\",\n          \"association\": \"A_signalRef_signalEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Signal\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_signal\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ImplicitThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"DataState\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemAwareElement\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemSubjectRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemSubjectRef_itemAwareElement\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataState\",\n          \"type\": \"DataState\",\n          \"association\": \"A_dataState_itemAwareElement\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"transformation\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_transformation_dataAssociation\"\n        },\n        {\n          \"name\": \"assignment\",\n          \"type\": \"Assignment\",\n          \"association\": \"A_assignment_dataAssociation\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_sourceRef_dataAssociation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_targetRef_dataAssociation\",\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithOptional\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithWhileExecuting\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataOutput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithOptional\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithWhileExecuting\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"dataInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"OutputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Property\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"DataOutputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"InputOutputSpecification\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSets\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"outputSets\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_inputOutputSpecification\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObject\",\n      \"superClass\": [\n        \"FlowElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"InputOutputBinding\",\n      \"properties\": [\n        {\n          \"name\": \"inputDataRef\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputDataRef\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_ioBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Assignment\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"from\",\n          \"type\": \"Expression\",\n          \"association\": \"A_from_assignment\"\n        },\n        {\n          \"name\": \"to\",\n          \"type\": \"Expression\",\n          \"association\": \"A_to_assignment\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStore\",\n      \"superClass\": [\n        \"RootElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"capacity\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"isUnlimited\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStoreReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataStoreRef\",\n          \"type\": \"DataStore\",\n          \"association\": \"A_dataStoreRef_dataStoreReference\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObjectReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataObjectRef\",\n          \"type\": \"DataObject\",\n          \"association\": \"A_dataObjectRef_dataObject\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationLink\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_innerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_outerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_calledCollaborationRef_callConversation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Conversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ]\n    },\n    {\n      \"name\": \"SubConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"conversationNodes\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversationNodes_subConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_conversationNode\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageFlowRefs\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRefs_communication\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_conversationNode\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalConversation\",\n      \"superClass\": [\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"PartnerEntity\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerEntityRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"PartnerRole\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerRoleRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationProperty\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRetrievalExpression\",\n          \"type\": \"CorrelationPropertyRetrievalExpression\",\n          \"association\": \"A_correlationPropertyRetrievalExpression_correlationproperty\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_correlationProperty\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Error\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_error\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"errorCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationKey\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationKey\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Expression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"FormalExpression\",\n      \"superClass\": [\n        \"Expression\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"language\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"body\",\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"evaluatesToTypeRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_evaluatesToTypeRef_formalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Message\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"itemRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemRef_message\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemDefinition\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemKind\",\n          \"type\": \"ItemKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"import\",\n          \"type\": \"Import\",\n          \"association\": \"A_import_itemDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_flowElement\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_flowElement\"\n        },\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SequenceFlow\",\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isImmediate\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"conditionExpression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_conditionExpression_sequenceFlow\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElementsContainer\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"laneSets\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_laneSets_flowElementsContainer\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"flowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_flowElements_container\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallableElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_callableElement\"\n        },\n        {\n          \"name\": \"supportedInterfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_supportedInterfaceRefs_callableElements\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ioBinding\",\n          \"type\": \"InputOutputBinding\",\n          \"association\": \"A_ioBinding_callableElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"incoming\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoing\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyRetrievalExpression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messagePath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_messagePath_correlationset\"\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_correlationPropertyRetrievalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyBinding\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataPath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_dataPath_correlationPropertyBinding\"\n        },\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationPropertyBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Resource\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resourceParameters\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_resourceParameters_resource\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameter\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isRequired\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_resourceParameter\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationSubscription\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationKeyRef\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeyRef_correlationSubscription\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationPropertyBinding\",\n          \"type\": \"CorrelationPropertyBinding\",\n          \"association\": \"A_correlationPropertyBinding_correlationSubscription\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlow\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlowAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_innerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_outerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InteractionNode\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"incomingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Participant\",\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"interfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_interfaceRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantMultiplicity\",\n          \"type\": \"ParticipantMultiplicity\",\n          \"association\": \"A_participantMultiplicity_participant\"\n        },\n        {\n          \"name\": \"endPointRefs\",\n          \"type\": \"EndPoint\",\n          \"association\": \"A_endPointRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"processRef\",\n          \"type\": \"Process\",\n          \"association\": \"A_processRef_participant\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_innerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_outerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantMultiplicity\",\n      \"properties\": [\n        {\n          \"name\": \"minimum\",\n          \"default\": \"0\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"maximum\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Collaboration\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"choreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_choreographyRef_collaboration\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlowAssociations\",\n          \"type\": \"MessageFlowAssociation\",\n          \"association\": \"A_messageFlowAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationAssociations\",\n          \"type\": \"ConversationAssociation\",\n          \"association\": \"A_conversationAssociations_converstaionAssociations\"\n        },\n        {\n          \"name\": \"participants\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participants_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlows\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlows_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversations\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_conversationLinks_collaboration\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyActivity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_choreographyActivity\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_choreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_choreographyActivity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"loopType\",\n          \"type\": \"ChoreographyLoopType\",\n          \"default\": \"None\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledChoreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_calledChoreographyRef_callChoreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callChoreographyActivity\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subChoreography\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyTask\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRef_choreographyTask\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Choreography\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"GlobalChoreographyTask\",\n      \"superClass\": [\n        \"Choreography\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_globalChoreographyTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TextAnnotation\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Group\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValueRef_categoryValueRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Association\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"associationDirection\",\n          \"type\": \"AssociationDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_sourceRef_outgoing_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_targetRef_incoming_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Category\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValue\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValue_category\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Artifact\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"CategoryValue\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categorizedFlowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"value\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Activity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isForCompensation\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCharacteristics\",\n          \"type\": \"LoopCharacteristics\",\n          \"association\": \"A_loopCharacteristics_activity\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_activity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_activity\"\n        },\n        {\n          \"name\": \"boundaryEventRefs\",\n          \"type\": \"BoundaryEvent\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociations\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputAssociations\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"startQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"completionQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ServiceTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_serviceTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubProcess\",\n      \"superClass\": [\n        \"Activity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"triggeredByEvent\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subProcess\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LoopCharacteristics\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isSequential\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"behavior\",\n          \"type\": \"MultiInstanceBehavior\",\n          \"default\": \"All\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"loopCardinality\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCardinality_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopDataInputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataInputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"loopDataOutputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataOutputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputDataItem\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_inputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"outputDataItem\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"complexBehaviorDefinition\",\n          \"type\": \"ComplexBehaviorDefinition\",\n          \"association\": \"A_complexBehaviorDefinition_multiInstanceLoopCharacteristics\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"oneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_oneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"noneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_noneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"StandardLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"testBefore\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCondition_standardLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopMaximum\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopMaximum_standardLoopCharacteristics\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CallActivity\",\n      \"superClass\": [\n        \"Activity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledElement\",\n          \"type\": \"String\",\n          \"association\": \"A_calledElementRef_callActivity\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Task\",\n      \"superClass\": [\n        \"Activity\",\n        \"InteractionNode\"\n      ]\n    },\n    {\n      \"name\": \"SendTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ReceiveTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ScriptTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptFormat\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BusinessRuleTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocSubProcess\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_adHocSubProcess\"\n        },\n        {\n          \"name\": \"ordering\",\n          \"type\": \"AdHocOrdering\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"cancelRemainingInstances\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Transaction\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"protocol\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"method\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalScriptTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptLanguage\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalBusinessRuleTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexBehaviorDefinition\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_condition_complexBehaviorDefinition\"\n        },\n        {\n          \"name\": \"event\",\n          \"type\": \"ImplicitThrowEvent\",\n          \"association\": \"A_event_complexBehaviorDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceRole\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resourceRef\",\n          \"type\": \"Resource\",\n          \"association\": \"A_resourceRef_activityResource\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"resourceParameterBindings\",\n          \"type\": \"ResourceParameterBinding\",\n          \"association\": \"A_resourceParameterBindings_activityResource\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"resourceAssignmentExpression\",\n          \"type\": \"ResourceAssignmentExpression\",\n          \"association\": \"A_resourceAssignmentExpression_activityResource\"\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameterBinding\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceParameterBinding\"\n        },\n        {\n          \"name\": \"parameterRef\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_parameterRef_resourceParameterBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceAssignmentExpression\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceAssignmentExpression\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Import\",\n      \"properties\": [\n        {\n          \"name\": \"importType\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"location\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"namespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Definitions\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"targetNamespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"expressionLanguage\",\n          \"default\": \"http://www.w3.org/1999/XPath\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"typeLanguage\",\n          \"default\": \"http://www.w3.org/2001/XMLSchema\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"imports\",\n          \"type\": \"Import\",\n          \"association\": \"A_imports_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensions\",\n          \"type\": \"Extension\",\n          \"association\": \"A_extensions_definitions\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"relationships\",\n          \"type\": \"Relationship\",\n          \"association\": \"A_relationships_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"rootElements\",\n          \"type\": \"RootElement\",\n          \"association\": \"A_rootElements_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"diagrams\",\n          \"association\": \"A_diagrams_definitions\",\n          \"isMany\": true,\n          \"type\": \"bpmndi:BPMNDiagram\"\n        },\n        {\n          \"name\": \"exporter\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"exporterVersion\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ProcessType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Public\"\n        },\n        {\n          \"name\": \"Private\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GatewayDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"Unspecified\"\n        },\n        {\n          \"name\": \"Converging\"\n        },\n        {\n          \"name\": \"Diverging\"\n        },\n        {\n          \"name\": \"Mixed\"\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGatewayType\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Exclusive\"\n        }\n      ]\n    },\n    {\n      \"name\": \"RelationshipDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Forward\"\n        },\n        {\n          \"name\": \"Backward\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"Physical\"\n        },\n        {\n          \"name\": \"Information\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyLoopType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Standard\"\n        },\n        {\n          \"name\": \"MultiInstanceSequential\"\n        },\n        {\n          \"name\": \"MultiInstanceParallel\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AssociationDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceBehavior\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"All\"\n        },\n        {\n          \"name\": \"Complex\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocOrdering\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Sequential\"\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"bpmn\",\n  \"xml\": {\n    \"alias\": \"lowerCase\"\n  }\n}\n},{}],40:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"BPMNDI\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"BPMNDiagram\",\n      \"properties\": [\n        {\n          \"name\": \"plane\",\n          \"type\": \"BPMNPlane\",\n          \"association\": \"A_plane_diagram\",\n          \"redefines\": \"di:Diagram#rootElement\"\n        },\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_diagram\",\n          \"isMany\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:Diagram\"\n      ]\n    },\n    {\n      \"name\": \"BPMNPlane\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_plane\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Plane\"\n      ]\n    },\n    {\n      \"name\": \"BPMNShape\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_shape\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"isHorizontal\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isExpanded\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isMarkerVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_shape\"\n        },\n        {\n          \"name\": \"isMessageVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"participantBandKind\",\n          \"type\": \"ParticipantBandKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"choreographyActivityShape\",\n          \"type\": \"BPMNShape\",\n          \"association\": \"A_choreographyActivityShape_participantBandShape\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledShape\"\n      ]\n    },\n    {\n      \"name\": \"BPMNEdge\",\n      \"properties\": [\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_edge\"\n        },\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_edge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"sourceElement\",\n          \"association\": \"A_sourceElement_sourceEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#source\"\n        },\n        {\n          \"name\": \"targetElement\",\n          \"association\": \"A_targetElement_targetEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#target\"\n        },\n        {\n          \"name\": \"messageVisibleKind\",\n          \"type\": \"MessageVisibleKind\",\n          \"isAttr\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledEdge\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabel\",\n      \"properties\": [\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_label\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"redefines\": \"di:DiagramElement#style\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Label\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabelStyle\",\n      \"properties\": [\n        {\n          \"name\": \"font\",\n          \"type\": \"dc:Font\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Style\"\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ParticipantBandKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"top_initiating\"\n        },\n        {\n          \"name\": \"middle_initiating\"\n        },\n        {\n          \"name\": \"bottom_initiating\"\n        },\n        {\n          \"name\": \"top_non_initiating\"\n        },\n        {\n          \"name\": \"middle_non_initiating\"\n        },\n        {\n          \"name\": \"bottom_non_initiating\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageVisibleKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"initiating\"\n        },\n        {\n          \"name\": \"non_initiating\"\n        }\n      ]\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"bpmndi\"\n}\n},{}],41:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"DC\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DC\",\n  \"types\": [\n    {\n      \"name\": \"Boolean\"\n    },\n    {\n      \"name\": \"Integer\"\n    },\n    {\n      \"name\": \"Real\"\n    },\n    {\n      \"name\": \"String\"\n    },\n    {\n      \"name\": \"Font\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"size\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isBold\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isItalic\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isUnderline\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isStrikeThrough\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Point\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Bounds\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"width\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"height\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"dc\",\n  \"associations\": []\n}\n},{}],42:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"DI\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"DiagramElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"owningDiagram\",\n          \"type\": \"Diagram\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"owningElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"modelElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_modelElement_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"style\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_style_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ownedElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Node\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ]\n    },\n    {\n      \"name\": \"Edge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"source\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_source_sourceEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_target_targetEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"waypoint\",\n          \"isUnique\": false,\n          \"isMany\": true,\n          \"type\": \"dc:Point\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Diagram\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"rootElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resolution\",\n          \"isAttr\": true,\n          \"type\": \"Real\"\n        },\n        {\n          \"name\": \"ownedStyle\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedStyle_owningDiagram\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Shape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Plane\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"planeElement\",\n          \"type\": \"DiagramElement\",\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_planeElement_plane\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledEdge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Edge\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningEdge\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledShape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Shape\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningShape\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Label\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Style\",\n      \"isAbstract\": true\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"di\"\n}\n},{}],43:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/Diagram');\n},{\"./lib/Diagram\":44}],44:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar di = _dereq_('didi');\r\n\r\n/**\r\n * @namespace djs\r\n */\r\n\r\n/**\r\n * Bootstrap an injector from a list of modules, instantiating a number of default components\r\n *\r\n * @param {Array<didi.Module>} bootstrapModules\r\n *\r\n * @return {didi.Injector} a injector to use to access the components\r\n */\r\nfunction bootstrap(bootstrapModules) {\r\n\r\n  var modules = [];\r\n  var components = [];\r\n\r\n  function hasModule(m) {\r\n    return modules.indexOf(m) >= 0;\r\n  }\r\n\r\n  function addModule(m) {\r\n    modules.push(m);\r\n  }\r\n\r\n  function visit(m) {\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    (m.__depends__ || []).forEach(visit);\r\n\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    addModule(m);\r\n\r\n    (m.__init__ || []).forEach(function(c) {\r\n      components.push(c);\r\n    });\r\n  }\r\n\r\n  bootstrapModules.forEach(visit);\r\n\r\n  var injector = new di.Injector(modules);\r\n\r\n  components.forEach(function(c) {\r\n    // eagerly resolve main components\r\n    injector.get(c);\r\n  });\r\n\r\n  return injector;\r\n}\r\n\r\n/**\r\n * Creates an injector from passed options.\r\n *\r\n * @param  {Object} options\r\n * @return {didi.Injector}\r\n */\r\nfunction createInjector(options) {\r\n\r\n  options = options || {};\r\n\r\n  var configModule = {\r\n    'config': ['value', options]\r\n  };\r\n\r\n  var coreModule = _dereq_('./core');\r\n\r\n  var modules = [ configModule, coreModule ].concat(options.modules || []);\r\n\r\n  return bootstrap(modules);\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * The main diagram-js entry point that bootstraps the diagram with the given\r\n * configuration.\r\n *\r\n *\r\n * To register extensions with the diagram, pass them as Array<didi.Module> to the constructor\r\n *\r\n * @example\r\n *\r\n * Given you would like to create a plug-in that logs whenever a shape\r\n * or connection was added to the canvas:\r\n *\r\n *   * Create the plug-in file:\r\n *\r\n *     ```javascript\r\n *     function MyLoggingPlugin(events) {\r\n *       events.on('shape.added', function(event) {\r\n *         console.log('shape ', event.shape, ' was added to the diagram');\r\n *       });\r\n *     }\r\n *\r\n *     module.exports = {\r\n *       __init__: [ 'myLoggingPlugin'],\r\n *       myLoggingPlugin: [ 'type', [ 'eventBus', MyLoggingPlugin ]]\r\n *     };\r\n *     ```\r\n *\r\n *   * Instantiate the diagram with the new plug-in\r\n *\r\n *     ```javascript\r\n *     var diagram = new Diagram({ modules: [ require('path-to-plugin-file') ] });\r\n *\r\n *     diagram.invoke([ 'canvas', function(canvas) {\r\n *       // add shape to drawing canvas\r\n *       canvas.addShape({ x: 10, y: 10 });\r\n *     });\r\n *\r\n *     // 'shape ... was added to the diagram' logged to console\r\n *     ```\r\n *\r\n * @param {Object} options\r\n * @param {Array<didi.Module>} [options.modules] external modules to instantiate with the diagram\r\n * @param {didi.Injector} [injector] an (optional) injector to bootstrap the diagram with\r\n */\r\nfunction Diagram(options, injector) {\r\n\r\n  // create injector unless explicitly specified\r\n  this.injector = injector = injector || createInjector(options);\r\n\r\n  // API\r\n\r\n  /**\r\n   * Resolves a diagram service\r\n   *\r\n   * @method Diagram#get\r\n   *\r\n   * @param {String} name the name of the diagram service to be retrieved\r\n   * @param {Object} [locals] a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.get = injector.get;\r\n\r\n  /**\r\n   * Executes a function into which diagram services are injected\r\n   *\r\n   * @method Diagram#invoke\r\n   *\r\n   * @param {Function|Object[]} fn the function to resolve\r\n   * @param {Object} locals a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.invoke = injector.invoke;\r\n\r\n  // init\r\n\r\n  // indicate via event\r\n\r\n\r\n  /**\r\n   * An event indicating that all plug-ins are loaded.\r\n   *\r\n   * Use this event to fire other events to interested plug-ins\r\n   *\r\n   * @memberOf Diagram\r\n   *\r\n   * @event diagram.init\r\n   *\r\n   * @example\r\n   *\r\n   * events.on('diagram.init', function() {\r\n   *   events.fire('my-custom-event', { foo: 'BAR' });\r\n   * });\r\n   *\r\n   * @type {Object}\r\n   */\r\n  this.get('eventBus').fire('diagram.init');\r\n}\r\n\r\nmodule.exports = Diagram;\r\n\r\n\r\n/**\r\n * Destroys the diagram\r\n *\r\n * @method  Diagram#destroy\r\n */\r\nDiagram.prototype.destroy = function() {\r\n  this.get('eventBus').fire('diagram.destroy');\r\n};\n},{\"./core\":49,\"didi\":67}],45:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar Model = _dereq_('../model');\r\n\r\nvar remove = _dereq_('../util/Collections').remove;\r\n\r\n\r\nfunction round(number, resolution) {\r\n  return Math.round(number * resolution) / resolution;\r\n}\r\n\r\nfunction ensurePx(number) {\r\n  return _.isNumber(number) ? number + 'px' : number;\r\n}\r\n\r\n/**\r\n * Creates a HTML container element for a SVG element with\r\n * the given configuration\r\n *\r\n * @param  {Object} options\r\n * @return {HTMLElement} the container element\r\n */\r\nfunction createContainer(options) {\r\n\r\n  options = _.extend({}, { width: '100%', height: '100%' }, options);\r\n\r\n  var container = options.container || document.body;\r\n\r\n  // create a <div> around the svg element with the respective size\r\n  // this way we can always get the correct container size\r\n  // (this is impossible for <svg> elements at the moment)\r\n  var parent = document.createElement('div');\r\n  parent.setAttribute('class', 'djs-container');\r\n\r\n  _.extend(parent.style, {\r\n    position: 'relative',\r\n    width: ensurePx(options.width),\r\n    height: ensurePx(options.height)\r\n  });\r\n\r\n  container.appendChild(parent);\r\n\r\n  return parent;\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * @emits Canvas#canvas.init\r\n *\r\n * @param {Object} config\r\n * @param {EventBus} eventBus\r\n * @param {GraphicsFactory} graphicsFactory\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction Canvas(config, eventBus, graphicsFactory, elementRegistry, snap) {\r\n\r\n  var options = _.extend(config.canvas || {});\r\n\r\n  this._snap = snap;\r\n  this._eventBus = eventBus;\r\n  this._elementRegistry = elementRegistry;\r\n  this._graphicsFactory = graphicsFactory;\r\n\r\n  // Creates a <svg> element that is wrapped into a <div>.\r\n  // This way we are always able to correctly figure out the size of the svg element\r\n  // by querying the parent node.\r\n  //\r\n  // (It is not possible to get the size of a svg element cross browser @ 2014-04-01)\r\n  //\r\n  // <div class=\"djs-container\" style=\"width: {desired-width}, height: {desired-height}\">\r\n  //   <svg width=\"100%\" height=\"100%\">\r\n  //    ...\r\n  //   </svg>\r\n  // </div>\r\n\r\n  var container = this._container = createContainer(options);\r\n\r\n  // svg root\r\n  var paper = this._paper = createPaper(container);\r\n\r\n  // drawing root\r\n  var root = this._root = paper.group().attr({ 'class' : 'viewport' });\r\n\r\n\r\n  function createPaper(container) {\r\n    return graphicsFactory.createPaper({ container: container, width: '100%', height: '100%' });\r\n  }\r\n\r\n  /**\r\n   * Sends a shape to the front.\r\n   *\r\n   * This method takes parent / child relationships between shapes into account\r\n   * and makes sure that children are properly handled, too.\r\n   *\r\n   * @method Canvas#sendToFront\r\n   *\r\n   * @param {djs.ElementDescriptor} shape descriptor of the shape to be sent to front\r\n   * @param {boolean} bubble=true whether to send parent shapes to front, too\r\n   */\r\n  function sendToFront(shape, bubble) {\r\n\r\n    if (bubble !== false) {\r\n      bubble = true;\r\n    }\r\n\r\n    if (bubble && shape.parent) {\r\n      sendToFront(shape.parent);\r\n    }\r\n\r\n    if (shape.children) {\r\n      shape.children.forEach(function(child) {\r\n        sendToFront(child, false);\r\n      });\r\n    }\r\n\r\n    var gfx = getGraphics(shape),\r\n        gfxParent = gfx.parent();\r\n\r\n    gfx.remove().appendTo(gfxParent);\r\n  }\r\n\r\n  /**\r\n   * Return the graphical object underlaying a certain diagram element\r\n   *\r\n   * @method Canvas#getGraphics\r\n   *\r\n   * @param {djs.ElementDescriptor} element descriptor of the element\r\n   */\r\n  function getGraphics(element) {\r\n    return elementRegistry.getGraphicsByElement(element);\r\n  }\r\n\r\n  /**\r\n   * Returns the root rendering context on which\r\n   * all elements have to be drawn.\r\n   *\r\n   * @method Canvas#getRoot\r\n   *\r\n   * @returns {snapsvg.Group}\r\n   */\r\n  function getRoot() {\r\n    return root;\r\n  }\r\n\r\n  eventBus.on('diagram.init', function(event) {\r\n\r\n    /**\r\n     * An event indicating that the canvas is ready to be drawn on.\r\n     *\r\n     * @memberOf Canvas\r\n     *\r\n     * @event canvas.init\r\n     *\r\n     * @type {Object}\r\n     * @property {snapsvg.Paper} paper the initialized drawing paper\r\n     */\r\n    eventBus.fire('canvas.init', { root: root, paper: paper });\r\n  });\r\n\r\n  eventBus.on('diagram.destroy', function() {\r\n\r\n    if (container) {\r\n      var parent = container.parentNode;\r\n      parent.removeChild(container);\r\n    }\r\n\r\n    container = this._container = null;\r\n    paper = this._paper = null;\r\n    root = this._root = null;\r\n  });\r\n\r\n\r\n  // redraw shapes / connections on change\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('element.changed', function(event) {\r\n\r\n    if (event.element.waypoints) {\r\n      eventBus.fire('connection.changed', event);\r\n    } else {\r\n      eventBus.fire('shape.changed', event);\r\n    }\r\n  });\r\n\r\n  eventBus.on('shape.changed', function(event) {\r\n    var element = event.element;\r\n    graphicsFactory.updateShape(element, event.gfx || self.getGraphics(element));\r\n  });\r\n\r\n  eventBus.on('connection.changed', function(event) {\r\n    var element = event.element;\r\n    graphicsFactory.updateConnection(element, event.gfx || self.getGraphics(element));\r\n  });\r\n\r\n  this.getRoot  = getRoot;\r\n\r\n  this.getContainer = function() {\r\n    return this._container;\r\n  };\r\n\r\n  this.getGraphics = getGraphics;\r\n\r\n  this.sendToFront = sendToFront;\r\n}\r\n\r\n\r\n/**\r\n * Create a model element with the given type and\r\n * a number of pre-set attributes.\r\n *\r\n * @param  {String} type\r\n * @param  {Object} attrs\r\n * @return {djs.model.Base} the newly created model instance\r\n */\r\nCanvas.prototype.create = function(type, attrs) {\r\n  return Model.create(type, attrs);\r\n};\r\n\r\n\r\n/**\r\n * Ensure that an element has a valid, unique id\r\n *\r\n * @param {djs.model.Base} element\r\n */\r\nCanvas.prototype._ensureValidId = function(element) {\r\n  if (!element.id) {\r\n    throw new Error('element must have an id');\r\n  }\r\n\r\n  if (this._elementRegistry.getById(element.id)) {\r\n    throw new Error('element with id ' + element.id + ' already exists');\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Adds a shape to the canvas\r\n *\r\n * @method Canvas#addShape\r\n *\r\n * @param {Object|djs.model.Shape} shape to add to the diagram\r\n *\r\n * @return {djs.model.Shape} the added shape\r\n */\r\nCanvas.prototype.addShape = function(shape, parent) {\r\n\r\n  this._ensureValidId(shape);\r\n\r\n  if (parent) {\r\n    shape.parent = parent;\r\n    parent.children.push(shape);\r\n  }\r\n\r\n  // create shape gfx\r\n  var gfx = this._graphicsFactory.createShape(this._root, shape);\r\n\r\n  // update its visual\r\n  this._graphicsFactory.updateShape(shape, gfx);\r\n\r\n  /**\r\n   * An event indicating that a new shape has been added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.added\r\n   * @type {Object}\r\n   * @property {djs.Shape} element the shape descriptor\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n  this._eventBus.fire('shape.added', { element: shape, gfx: gfx });\r\n\r\n  return shape;\r\n};\r\n\r\n/**\r\n * Adds a connection to the canvas\r\n *\r\n * @method Canvas#addConnection\r\n *\r\n * @param {djs.model.Connection} connection to add to the diagram\r\n *\r\n * @return {djs.model.Connection} the added connection\r\n */\r\nCanvas.prototype.addConnection = function(connection, parent) {\r\n\r\n  this._ensureValidId(connection);\r\n\r\n  if (parent) {\r\n    connection.parent = parent;\r\n    parent.children.push(connection);\r\n  }\r\n\r\n  // create connection gfx\r\n  var gfx = this._graphicsFactory.createConnection(this._root, connection);\r\n\r\n  // update its visual\r\n  this._graphicsFactory.updateConnection(connection, gfx);\r\n\r\n  /**\r\n   * An event indicating that a new connection has been added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.added\r\n   * @type {Object}\r\n   * @property {djs.ElementDescriptor} element the connection descriptor\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n  this._eventBus.fire('connection.added', { element: connection, gfx: gfx });\r\n\r\n  return connection;\r\n};\r\n\r\n\r\n/**\r\n * Internal remove element\r\n */\r\nCanvas.prototype._removeElement = function(element, type) {\r\n\r\n  if (_.isString(element)) {\r\n    element = this._elementRegistry.getById(element);\r\n  }\r\n\r\n  var gfx = this._elementRegistry.getGraphicsByElement(element);\r\n\r\n  this._eventBus.fire(type + '.remove', { element: element, gfx: gfx });\r\n\r\n  if (gfx) {\r\n    gfx.remove();\r\n  }\r\n\r\n  remove(element.parent && element.parent.children, element);\r\n  element.parent = null;\r\n\r\n  this._eventBus.fire(type + '.removed', { element: element, gfx: gfx });\r\n\r\n  return element;\r\n};\r\n\r\n/**\r\n * Removes a shape from the canvas\r\n *\r\n * @method Canvas#removeShape\r\n *\r\n * @param {String|djs.model.Shape} shape or shape id to be removed\r\n *\r\n * @return {djs.model.Shape} the removed shape\r\n */\r\nCanvas.prototype.removeShape = function(shape) {\r\n\r\n  /**\r\n   * An event indicating that a shape is about to be removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.remove\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape descriptor\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n\r\n  /**\r\n   * An event indicating that a shape has been removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.removed\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape descriptor\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n  return this._removeElement(shape, 'shape');\r\n};\r\n\r\n/**\r\n * Removes a connection from the canvas\r\n *\r\n * @method Canvas#removeConnection\r\n *\r\n * @param {String|djs.model.Connection} connection or connection id to be removed\r\n *\r\n * @return {djs.model.Connection} the removed connection\r\n */\r\nCanvas.prototype.removeConnection = function(connection) {\r\n\r\n  /**\r\n   * An event indicating that a connection is about to be removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.remove\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection descriptor\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n\r\n  /**\r\n   * An event indicating that a connection has been removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.removed\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection descriptor\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n  return this._removeElement(connection, 'connection');\r\n};\r\n\r\n\r\nCanvas.prototype._fireViewboxChange = function(viewbox) {\r\n  this._eventBus.fire('canvas.viewbox.changed', { viewbox: viewbox || this.viewbox() });\r\n};\r\n\r\n/**\r\n * Gets or sets the view box of the canvas, i.e. the area that is currently displayed\r\n *\r\n * @method Canvas#viewbox\r\n *\r\n * @param  {Object} [box] the new view box to set\r\n * @param  {Number} box.x the top left X coordinate of the canvas visible in view box\r\n * @param  {Number} box.y the top left Y coordinate of the canvas visible in view box\r\n * @param  {Number} box.width the visible width\r\n * @param  {Number} box.height\r\n *\r\n * @example\r\n *\r\n * canvas.viewbox({ x: 100, y: 100, width: 500, height: 500 })\r\n *\r\n * // sets the visible area of the diagram to (100|100) -> (600|100)\r\n * // and and scales it according to the diagram width\r\n *\r\n * @return {Object} the current view box\r\n */\r\nCanvas.prototype.viewbox = function(box) {\r\n\r\n  var root = this._root,\r\n      eventBus = this._eventBus;\r\n\r\n  var innerBox,\r\n      outerBox = this.getSize(),\r\n      matrix,\r\n      scale,\r\n      x, y,\r\n      width, height;\r\n\r\n  if (!box) {\r\n    innerBox = root.getBBox(true);\r\n\r\n    matrix = root.transform().localMatrix;\r\n    scale = round(matrix.a, 1000);\r\n\r\n    x = round(-matrix.e || 0, 1000);\r\n    y = round(-matrix.f || 0, 1000);\r\n\r\n    return {\r\n      x: x ? x / scale : 0,\r\n      y: y ? y / scale : 0,\r\n      width: outerBox.width / scale,\r\n      height: outerBox.height / scale,\r\n      scale: scale,\r\n      inner: {\r\n        width: innerBox.width,\r\n        height: innerBox.height\r\n      },\r\n      outer: outerBox\r\n    };\r\n  } else {\r\n    scale = Math.max(outerBox.width / box.width, outerBox.height / box.height);\r\n\r\n    matrix = new this._snap.Matrix().scale(scale).translate(-box.x, -box.y);\r\n    root.transform(matrix);\r\n\r\n    this._fireViewboxChange();\r\n  }\r\n\r\n  return box;\r\n};\r\n\r\n\r\n/**\r\n * Gets or sets the scroll of the canvas.\r\n *\r\n * @param {Object} [delta] the new scroll to apply.\r\n *\r\n * @param {Number} [delta.dx]\r\n * @param {Number} [delta.dy]\r\n */\r\nCanvas.prototype.scroll = function(delta) {\r\n\r\n  var node = this._root.node;\r\n  var matrix = node.getCTM();\r\n\r\n  if (delta) {\r\n    delta = _.extend({ dx: 0, dy: 0 }, delta || {});\r\n\r\n    matrix = this._paper.node.createSVGMatrix().translate(delta.dx, delta.dy).multiply(matrix);\r\n\r\n    setCTM(node, matrix);\r\n\r\n    this._fireViewboxChange();\r\n  }\r\n\r\n  return { x: matrix.e, y: matrix.f };\r\n};\r\n\r\n\r\n/**\r\n * Gets or sets the current zoom of the canvas, optionally zooming to the specified position.\r\n *\r\n * @method Canvas#zoom\r\n *\r\n * @param {String|Number} [newScale] the new zoom level, either a number, i.e. 0.9,\r\n *                                   or `fit-viewport` to adjust the size to fit the current viewport\r\n * @param {String|Point} [center] the reference point { x: .., y: ..} to zoom to, 'auto' to zoom into mid or null\r\n *\r\n * @return {Number} the current scale\r\n */\r\nCanvas.prototype.zoom = function(newScale, center) {\r\n\r\n  var snap = this._snap;\r\n\r\n  var vbox = this.viewbox();\r\n\r\n  if (newScale === undefined) {\r\n    return vbox.scale;\r\n  }\r\n\r\n  var outer = vbox.outer;\r\n\r\n  if (newScale === 'fit-viewport') {\r\n    newScale = Math.min(1, outer.width / vbox.inner.width);\r\n  }\r\n\r\n  if (center === 'auto') {\r\n    center = {\r\n      x: outer.width / 2,\r\n      y: outer.height / 2\r\n    };\r\n  }\r\n\r\n  var matrix = this._setZoom(newScale, center);\r\n\r\n  this._fireViewboxChange();\r\n\r\n  return round(matrix.a, 1000);\r\n};\r\n\r\nfunction setCTM(node, m) {\r\n  var mstr = 'matrix(' + m.a + ',' + m.b + ',' + m.c + ',' + m.d + ',' + m.e + ',' + m.f + ')';\r\n  node.setAttribute('transform', mstr);\r\n}\r\n\r\nCanvas.prototype._setZoom = function(scale, center) {\r\n\r\n  var svg = this._paper.node,\r\n      viewport = this._root.node;\r\n\r\n  var matrix = svg.createSVGMatrix();\r\n  var point = svg.createSVGPoint();\r\n\r\n  var centerPoint,\r\n      originalPoint,\r\n      currentMatrix,\r\n      scaleMatrix,\r\n      newMatrix;\r\n\r\n  currentMatrix = viewport.getCTM();\r\n\r\n\r\n  var currentScale = currentMatrix.a;\r\n\r\n  if (center) {\r\n    centerPoint = _.extend(point, center);\r\n\r\n    // revert applied viewport transformations\r\n    originalPoint = centerPoint.matrixTransform(currentMatrix.inverse());\r\n\r\n    // create scale matrix\r\n    scaleMatrix = matrix\r\n                    .translate(originalPoint.x, originalPoint.y)\r\n                    .scale(1 / currentScale * scale)\r\n                    .translate(-originalPoint.x, -originalPoint.y);\r\n\r\n    newMatrix = currentMatrix.multiply(scaleMatrix);\r\n  } else {\r\n    newMatrix = matrix.scale(scale);\r\n  }\r\n\r\n  setCTM(this._root.node, newMatrix);\r\n\r\n  return newMatrix;\r\n};\r\n\r\n\r\n/**\r\n * Returns the size of the canvas\r\n *\r\n * @return {Dimensions}\r\n */\r\nCanvas.prototype.getSize = function () {\r\n  return {\r\n    width: this._container.clientWidth,\r\n    height: this._container.clientHeight\r\n  };\r\n};\r\n\r\n\r\n/**\r\n * Return the absolute bounding box for the given element\r\n *\r\n * The absolute bounding box may be used to display overlays in the\r\n * callers (browser) coordinate system rather than the zoomed in/out\r\n * canvas coordinates.\r\n *\r\n * @param  {ElementDescriptor} element\r\n * @return {Bounds} the absolute bounding box\r\n */\r\nCanvas.prototype.getAbsoluteBBox = function(element) {\r\n  var vbox = this.viewbox();\r\n\r\n  var gfx = this.getGraphics(element);\r\n\r\n  var transformBBox = gfx.getBBox(true);\r\n  var bbox = gfx.getBBox();\r\n\r\n  var x = (bbox.x - transformBBox.x) * vbox.scale - vbox.x * vbox.scale;\r\n  var y = (bbox.y - transformBBox.y) * vbox.scale - vbox.y * vbox.scale;\r\n\r\n  var width = (bbox.width + 2 * transformBBox.x) * vbox.scale;\r\n  var height = (bbox.height + 2 * transformBBox.y) * vbox.scale;\r\n\r\n  return {\r\n    x: x,\r\n    y: y,\r\n    width: width,\r\n    height: height\r\n  };\r\n};\r\n\r\nCanvas.$inject = [\r\n  'config',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'elementRegistry',\r\n  'snap' ];\r\n\r\nmodule.exports = Canvas;\n},{\"../model\":62,\"../util/Collections\":63}],46:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A registry that keeps track of all shapes in the diagram.\r\n *\r\n * @param {EventBus} eventBus the event bus\r\n */\r\nfunction ElementRegistry(eventBus) {\r\n\r\n  // mapping element.id -> container\r\n  var elementMap = {};\r\n\r\n  // mapping gfx.id -> container\r\n  var graphicsMap = {};\r\n\r\n\r\n  function add(element, gfx) {\r\n    if (!element.id) {\r\n      throw new Error('element has no id');\r\n    }\r\n\r\n    if (!gfx.id) {\r\n      throw new Error('graphics has no id');\r\n    }\r\n\r\n    if (graphicsMap[gfx.id]) {\r\n      throw new Error('graphics with id ' + gfx.id + ' already registered');\r\n    }\r\n\r\n    if (elementMap[element.id]) {\r\n      throw new Error('element with id ' + element.id + ' already added');\r\n    }\r\n\r\n    elementMap[element.id] = graphicsMap[gfx.id] = { element: element, gfx: gfx };\r\n  }\r\n\r\n  function remove(element) {\r\n    var gfx = getGraphicsByElement(element);\r\n\r\n    delete elementMap[element.id];\r\n    delete graphicsMap[gfx.id];\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getByGraphics\r\n   */\r\n  function getByGraphics(gfx) {\r\n    var id = _.isString(gfx) ? gfx : gfx.id;\r\n\r\n    var container = graphicsMap[id];\r\n    return container && container.element;\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getById\r\n   */\r\n  function getById(id) {\r\n    var container = elementMap[id];\r\n    return container && container.element;\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getGraphicsByElement\r\n   */\r\n  function getGraphicsByElement(element) {\r\n    var id = _.isString(element) ? element : element.id;\r\n\r\n    var container = elementMap[id];\r\n    return container && container.gfx;\r\n  }\r\n\r\n\r\n  _.forEach([ 'shape', 'connection' ], function(type) {\r\n    eventBus.on(type + '.added', function(event) {\r\n      add(event.element, event.gfx);\r\n    });\r\n\r\n    eventBus.on(type + '.removed', function(event) {\r\n      remove(event.element, event.gfx);\r\n    });\r\n  });\r\n\r\n\r\n  eventBus.on('diagram.destroy', function(event) {\r\n    elementMap = null;\r\n    graphicsMap = null;\r\n  });\r\n\r\n  return {\r\n    getGraphicsByElement: getGraphicsByElement,\r\n    getById: getById,\r\n    getByGraphics: getByGraphics\r\n  };\r\n}\r\n\r\nElementRegistry.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = ElementRegistry;\n},{}],47:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n/**\r\n * @global\r\n * @type {Object}\r\n * @static\r\n */\r\nvar EventPriority = {\r\n  standard: 1000,\r\n  overwrite: 10000\r\n};\r\n\r\n/**\r\n * @class\r\n *\r\n * A general purpose event bus\r\n */\r\nfunction EventBus() {\r\n  var listenerMap = {};\r\n\r\n  function getListeners(name) {\r\n    var listeners = listenerMap[name];\r\n\r\n    if (!listeners) {\r\n      listeners = listenerMap[name] = [];\r\n    }\r\n\r\n    return listeners;\r\n  }\r\n\r\n  function extendEvent(event, type) {\r\n\r\n    var propagationStopped,\r\n        defaultPrevented;\r\n\r\n    _.extend(event, {\r\n      type: type,\r\n\r\n      stopPropagation: function() {\r\n        this.propagationStopped = true;\r\n      },\r\n      preventDefault: function() {\r\n        this.defaultPrevented = true;\r\n      },\r\n\r\n      isPropagationStopped: function() {\r\n        return !!this.propagationStopped;\r\n      },\r\n\r\n      isDefaultPrevented: function() {\r\n        return !!this.defaultPrevented;\r\n      }\r\n    });\r\n\r\n    return event;\r\n  }\r\n\r\n  /**\r\n   * Register an event listener for events with the given name.\r\n   *\r\n   * The callback will be invoked with `event, ...additionalArguments`\r\n   * that have been passed to the evented element.\r\n   *\r\n   * @method EventBus#on\r\n   *\r\n   * @param {String} event\r\n   * @param {Number} [priority] the priority in which this listener is called,\r\n   *                            defaults to 1000 but may be changed to override execution order of callbacks\r\n   *                            (> {@link EventPriority#overwrite})\r\n   *\r\n   * @param {Function} callback\r\n   */\r\n  function on(event, priority, callback) {\r\n\r\n    if (_.isFunction(priority)) {\r\n      callback = priority;\r\n      priority = EventPriority.standard;\r\n    }\r\n\r\n    if (!_.isNumber(priority)) {\r\n      throw new Error('priority needs to be a number');\r\n    }\r\n\r\n    var listeners = getListeners(event);\r\n    addEventToArray(listeners, callback, priority);\r\n  }\r\n\r\n  /**\r\n   * Register an event listener that is executed only once.\r\n   *\r\n   * @method EventBus#once\r\n   *\r\n   * @param {String} event the event name to register for\r\n   * @param {Function} callback the callback to execute\r\n   *\r\n   * @see EventBus#on\r\n   */\r\n  function once(event, callback) {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var self = this;\r\n    var wrappedCallback = function() {\r\n      var eventType = arguments[0].type;\r\n      callback.apply(this, arguments);\r\n      self.off(eventType, wrappedCallback);\r\n    };\r\n\r\n    this.on(event, wrappedCallback);\r\n  }\r\n\r\n  /**\r\n   * Removes event listeners by event and callback.\r\n   *\r\n   * If no callback is given, all listeners for a given event name are being removed.\r\n   *\r\n   * @method EventBus#off\r\n   *\r\n   * @param {String} event\r\n   * @param {Function} [callback]\r\n   */\r\n  function off(event, callback) {\r\n    var listeners, idx;\r\n\r\n    listeners = getListeners(event);\r\n    if (callback) {\r\n      _.forEach(listeners, function(listener) {\r\n        if(listener.callback === callback) {\r\n          idx = listeners.indexOf(listener);\r\n        }\r\n      });\r\n\r\n      if (idx !== -1) {\r\n        listeners.splice(idx, 1);\r\n      }\r\n    } else {\r\n      listeners.length = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fires a named event.\r\n   *\r\n   * @method EventBus#fire\r\n   *\r\n   * @example\r\n   *\r\n   * // fire event by name\r\n   * events.fire('foo');\r\n   *\r\n   * // fire event object with nested type\r\n   * var event = { type: 'foo' };\r\n   * events.fire(event);\r\n   *\r\n   * // fire event with explicit type\r\n   * var event = { x: 10, y: 20 };\r\n   * events.fire('element.moved', event);\r\n   *\r\n   * // pass additional arguments to the event\r\n   * events.on('foo', function(event, bar) {\r\n   *   alert(bar);\r\n   * });\r\n   *\r\n   * events.fire({ type: 'foo' }, 'I am bar!');\r\n   *\r\n   * @param {String} [name] the optional event name\r\n   * @param {Object} [event] the event object\r\n   * @param {...Object} additional arguments to be passed to the callback functions\r\n   */\r\n  function fire() {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var event, eventType,\r\n        listeners, i, l,\r\n        args;\r\n\r\n    args = Array.prototype.slice.call(arguments);\r\n\r\n    eventType = args[0];\r\n\r\n    if (_.isObject(eventType)) {\r\n      event = eventType;\r\n\r\n      // parse type from event\r\n      eventType = event.type;\r\n    } else {\r\n      // remove name parameter\r\n      args.shift();\r\n\r\n      event = args[0] || {};\r\n      event.type = eventType;\r\n      if(args.length === 0) {\r\n        args.push(event);\r\n      }\r\n    }\r\n\r\n    listeners = getListeners(eventType);\r\n    event = extendEvent(event, eventType);\r\n\r\n    for (i = 0, l; !!(l = listeners[i]); i++) {\r\n      if (event.isPropagationStopped()) {\r\n        break;\r\n      }\r\n      l.callback.apply(this, args);\r\n    }\r\n  }\r\n\r\n  function addEventToArray(array, callback, priority) {\r\n\r\n    array.push({\r\n      priority: priority,\r\n      callback: callback\r\n    });\r\n\r\n    array.sort(function(a, b) {\r\n      if (a.priority < b.priority) {\r\n        return 1;\r\n      } else if (a.priority > b.priority) {\r\n        return -1;\r\n      } else {\r\n        return 0;\r\n      }\r\n    });\r\n  }\r\n\r\n  this.on = on;\r\n  this.once = once;\r\n  this.off = off;\r\n  this.fire = fire;\r\n}\r\n\r\n\r\nmodule.exports = EventBus;\n},{}],48:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Creates a gfx container for shapes and connections\r\n *\r\n * The layout is as follows:\r\n *\r\n * <g data-element-id=\"element-1\" class=\"djs-group djs-(type=shape|connection)\">\r\n *   <g class=\"djs-visual\">\r\n *     <!-- the renderer draws in here -->\r\n *   </g>\r\n *\r\n *   <!-- extensions (overlays, click box, ...) goes here\r\n * </g>\r\n *\r\n * @param {Object} root\r\n * @param {String} type the type of the element, i.e. shape | connection\r\n */\r\nfunction createContainer(root, type) {\r\n  var gfxContainer = root.group();\r\n\r\n  gfxContainer\r\n    .addClass('djs-group')\r\n    .addClass('djs-' + type);\r\n\r\n  var gfxGroup = gfxContainer.group().addClass('djs-visual');\r\n\r\n  return gfxContainer;\r\n}\r\n\r\n/**\r\n * Clears the graphical representation of the element and returns the\r\n * cleared result (the <g class=\"djs-visual\" /> element).\r\n */\r\nfunction clearVisual(gfx) {\r\n\r\n  var oldVisual = gfx.select('.djs-visual');\r\n\r\n  var newVisual = gfx.group().addClass('djs-visual').before(oldVisual);\r\n\r\n  oldVisual.remove();\r\n\r\n  return newVisual;\r\n}\r\n\r\n\r\nfunction createContainerFactory(type) {\r\n  return function(root, data) {\r\n    return createContainer(root, type).attr('data-element-id', data.id);\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * A factory that creates graphical elements\r\n *\r\n * @param {Renderer} renderer\r\n * @param {Snap} snap\r\n */\r\nfunction GraphicsFactory(renderer, snap) {\r\n  this._renderer = renderer;\r\n  this._snap = snap;\r\n}\r\n\r\nGraphicsFactory.prototype.createShape = createContainerFactory('shape');\r\n\r\nGraphicsFactory.prototype.createConnection = createContainerFactory('connection');\r\n\r\nGraphicsFactory.prototype.createPaper = function(options) {\r\n  return this._snap.createSnapAt(options.width, options.height, options.container);\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateShape = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n\r\n  // redraw\r\n  this._renderer.drawShape(gfxGroup, element);\r\n\r\n  // update positioning\r\n  gfx.translate(element.x, element.y);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateConnection = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n  this._renderer.drawConnection(gfxGroup, element);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.$inject = [ 'renderer', 'snap' ];\r\n\r\nmodule.exports = GraphicsFactory;\n},{}],49:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __depends__: [ _dereq_('../draw') ],\r\n  __init__: [ 'canvas' ],\r\n  canvas: [ 'type', _dereq_('./Canvas') ],\r\n  elementRegistry: [ 'type', _dereq_('./ElementRegistry') ],\r\n  eventBus: [ 'type', _dereq_('./EventBus') ],\r\n  graphicsFactory: [ 'type', _dereq_('./GraphicsFactory') ]\r\n};\n},{\"../draw\":53,\"./Canvas\":45,\"./ElementRegistry\":46,\"./EventBus\":47,\"./GraphicsFactory\":48}],50:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n// required components\r\n\r\nfunction flattenPoints(points) {\r\n  var result = [];\r\n\r\n  for (var i = 0, p; !!(p = points[i]); i++) {\r\n    result.push(p.x);\r\n    result.push(p.y);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n\r\n/**\r\n * @class Renderer\r\n *\r\n * The default renderer used for shapes and connections.\r\n *\r\n * @param {Styles} styles\r\n */\r\nfunction Renderer(styles) {\r\n  this.CONNECTION_STYLE = styles.style([ 'no-fill' ], { strokeWidth: 5 });\r\n  this.SHAPE_STYLE = styles.style({ fill: 'white', stroke: 'fuchsia', strokeWidth: 2 });\r\n}\r\n\r\nRenderer.prototype.drawShape = function drawShape(gfxGroup, data) {\r\n  if (data.width === undefined ||\r\n      data.height === undefined) {\r\n\r\n    throw new Error('must specify width and height properties for new shape');\r\n  }\r\n\r\n  return gfxGroup.rect(0, 0, data.width, data.height, 10, 10).attr(this.SHAPE_STYLE);\r\n};\r\n\r\nRenderer.prototype.drawConnection = function drawConnection(gfxGroup, data) {\r\n  var points = flattenPoints(data.waypoints);\r\n  return gfxGroup.polyline(points).attr(this.CONNECTION_STYLE);\r\n};\r\n\r\n\r\nRenderer.$inject = ['styles'];\r\n\r\n\r\nmodule.exports = Renderer;\r\nmodule.exports.flattenPoints = flattenPoints;\n},{}],51:[function(_dereq_,module,exports){\nvar snapsvg = (window.Snap);\r\n\r\n// require snapsvg extensions\r\n_dereq_('./snapsvg-extensions');\r\n\r\nmodule.exports = snapsvg;\n},{\"./snapsvg-extensions\":54}],52:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * A component that manages shape styles\r\n */\r\nfunction Styles() {\r\n\r\n  var defaultTraits = {\r\n\r\n    'no-fill': {\r\n      fill: 'none'\r\n    },\r\n    'no-border': {\r\n      strokeOpacity: 0.0\r\n    },\r\n    'no-events': {\r\n      pointerEvents: 'none'\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a className, a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {String} className\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.cls = function(className, traits, additionalAttrs) {\r\n    var attrs = this.style(traits, additionalAttrs);\r\n\r\n    return _.extend(attrs, { 'class': className });\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.style = function(traits, additionalAttrs) {\r\n\r\n    if (!_.isArray(traits) && !additionalAttrs) {\r\n      additionalAttrs = traits;\r\n      traits = [];\r\n    }\r\n\r\n    var attrs = _.inject(traits, function(attrs, t) {\r\n      return _.extend(attrs, defaultTraits[t] || {});\r\n    }, {});\r\n\r\n    return additionalAttrs ? _.extend(attrs, additionalAttrs) : attrs;\r\n  };\r\n}\r\n\r\nmodule.exports = Styles;\n},{}],53:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  renderer: [ 'type', _dereq_('./Renderer') ],\r\n  snap: [ 'value', _dereq_('./Snap') ],\r\n  styles: [ 'type', _dereq_('./Styles') ]\r\n};\n},{\"./Renderer\":50,\"./Snap\":51,\"./Styles\":52}],54:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Snap = (window.Snap);\r\n\r\n/**\r\n * @module snapsvg/extensions\r\n */\r\n\r\n/**\r\n * @namespace snapsvg\r\n */\r\n\r\n/**\r\n * @class snapsvg.Element\r\n */\r\n\r\n/**\r\n * @class ClassPlugin\r\n *\r\n * Extends snapsvg with methods to add and remove classes\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  function split(str) {\r\n    return str.split(/\\s+/);\r\n  }\r\n\r\n  function join(array) {\r\n    return array.join(' ');\r\n  }\r\n\r\n  function getClasses(e) {\r\n    return split(e.attr('class') || '');\r\n  }\r\n\r\n  function setClasses(e, classes) {\r\n    e.attr('class', join(classes));\r\n  }\r\n\r\n  /**\r\n   * @method snapsvg.Element#addClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'selector');\r\n   *\r\n   * e.addClass('foo bar'); // adds classes foo and bar\r\n   * e.attr('class'); // -> 'selector foo bar'\r\n   *\r\n   * e.addClass('fooBar');\r\n   * e.attr('class'); // -> 'selector foo bar fooBar'\r\n   *\r\n   * @param {String} cls classes to be added to the element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.addClass = function(cls) {\r\n    var current = getClasses(this),\r\n        add = split(cls),\r\n        i, e;\r\n\r\n    for (i = 0, e; !!(e = add[i]); i++) {\r\n      if (current.indexOf(e) === -1) {\r\n        current.push(e);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#hasClass\r\n   *\r\n   * @param  {String}  cls the class to query for\r\n   * @return {Boolean} returns true if the element has the given class\r\n   */\r\n  Element.prototype.hasClass = function(cls) {\r\n    if (!cls) {\r\n      throw new Error('[snapsvg] syntax: hasClass(clsStr)');\r\n    }\r\n\r\n    return getClasses(this).indexOf(cls) !== -1;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#removeClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'foo bar');\r\n   *\r\n   * e.removeClass('foo');\r\n   * e.attr('class'); // -> 'bar'\r\n   *\r\n   * e.removeClass('foo bar'); // removes classes foo and bar\r\n   * e.attr('class'); // -> ''\r\n   *\r\n   * @param {String} cls classes to be removed from element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.removeClass = function(cls) {\r\n    var current = getClasses(this),\r\n        remove = split(cls),\r\n        i, e, idx;\r\n\r\n    for (i = 0, e; !!(e = remove[i]); i++) {\r\n      idx = current.indexOf(e);\r\n\r\n      if (idx !== -1) {\r\n        // remove element from array\r\n        current.splice(idx, 1);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n});\r\n\r\n/**\r\n * @class TranslatePlugin\r\n *\r\n * Extends snapsvg with methods to translate elements\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.Element#translate\r\n   *\r\n   * @example\r\n   *\r\n   * e.translate(10, 20);\r\n   *\r\n   * // sets transform matrix to translate(10, 20)\r\n   *\r\n   * @param {Number} x translation\r\n   * @param {Number} y translation\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.translate = function(x, y) {\r\n    var matrix = new Snap.Matrix();\r\n    matrix.translate(x, y);\r\n    return this.transform(matrix);\r\n  };\r\n});\r\n\r\n/**\r\n * @class CreatSnapAtPlugin\r\n *\r\n * Extends snap.svg with a method to create a SVG element\r\n * at a specific position in the DOM.\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.createSnapAt\r\n   *\r\n   * @example\r\n   *\r\n   * snapsvg.createSnapAt(parentNode, 200, 200);\r\n   *\r\n   * @param {Number} width of svg\r\n   * @param {Number} height of svg\r\n   * @param {Object} parentNode svg Element will be child of this\r\n   *\r\n   * @return {snapsvg.Element} the newly created wrapped SVG element instance\r\n   */\r\n  Snap.createSnapAt = function(width, height, parentNode) {\r\n\r\n    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n    svg.setAttribute('width', width);\r\n    svg.setAttribute('height', height);\r\n    if (!parentNode) {\r\n      parentNode = document.body;\r\n    }\r\n    parentNode.appendChild(svg);\r\n\r\n    return new Snap(svg);\r\n  };\r\n});\n},{}],55:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar GraphicsUtil = _dereq_('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that provides interactivity in terms of events (mouse over and selection to a diagram).\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nfunction InteractionEvents(eventBus, styles) {\r\n\r\n  var HIT_STYLE = styles.cls('djs-hit', [ 'no-fill', 'no-border' ], {\r\n    pointerEvents: 'stroke',\r\n    stroke: 'white',\r\n    strokeWidth: 10\r\n  });\r\n\r\n  function isCtxSwitch(e) {\r\n    return !e.relatedTarget || e.target.parentNode !== e.relatedTarget.parentNode;\r\n  }\r\n\r\n  function fire(event, baseEvent, eventName) {\r\n    var e = _.extend({}, baseEvent, event);\r\n    eventBus.fire(eventName, e);\r\n  }\r\n\r\n  function makeSelectable(element, gfx, options) {\r\n    var type = options.type,\r\n        baseEvent = { element: element, gfx: gfx },\r\n        visual = GraphicsUtil.getVisual(gfx),\r\n        hit,\r\n        bbox;\r\n\r\n    if (type === 'shape') {\r\n      bbox = visual.getBBox();\r\n      hit = gfx.rect(bbox.x, bbox.y, bbox.width, bbox.height);\r\n    } else {\r\n      hit = visual.select('*').clone().attr('style', '');\r\n    }\r\n\r\n    hit.attr(HIT_STYLE).prependTo(gfx);\r\n\r\n    gfx.hover(function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        /**\r\n         * An event indicating that shape|connection has been hovered\r\n         *\r\n         * shape.hover, connection.hover\r\n         */\r\n        fire(e, baseEvent, type + '.hover');\r\n      }\r\n    }, function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        fire(e, baseEvent, type + '.out');\r\n      }\r\n    });\r\n\r\n    visual.click(function(e) {\r\n      fire(e, baseEvent, type + '.click');\r\n    });\r\n\r\n    visual.dblclick(function(e) {\r\n      fire(e, baseEvent, type + '.dblclick');\r\n    });\r\n  }\r\n\r\n  function registerEvents(eventBus) {\r\n\r\n    eventBus.on('canvas.init', function(event) {\r\n      var root = event.root;\r\n\r\n      // implement direct canvas click\r\n      root.click(function(event) {\r\n\r\n        /**\r\n         * An event indicating that the canvas has been directly clicked\r\n         *\r\n         * @memberOf InteractionEvents\r\n         *\r\n         * @event canvas.click\r\n         *\r\n         * @type {Object}\r\n         */\r\n        eventBus.fire('canvas.click', _.extend({}, event, { root: root }));\r\n      });\r\n    });\r\n\r\n    eventBus.on('shape.added', function(event) {\r\n      makeSelectable(event.element, event.gfx, { type: 'shape' });\r\n    });\r\n\r\n    eventBus.on('connection.added', function(event) {\r\n      makeSelectable(event.element, event.gfx, { type: 'connection' });\r\n    });\r\n  }\r\n\r\n  registerEvents(eventBus);\r\n}\r\n\r\n\r\nInteractionEvents.$inject = [ 'eventBus', 'styles' ];\r\n\r\nmodule.exports = InteractionEvents;\n},{\"../../util/GraphicsUtil\":64}],56:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __init__: [ 'interactionEvents' ],\r\n  interactionEvents: [ 'type', _dereq_('./InteractionEvents') ]\r\n};\n},{\"./InteractionEvents\":55}],57:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar GraphicsUtil = _dereq_('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds an outline to shapes and connections that may be activated and styled\r\n * via CSS classes.\r\n *\r\n * @param {EventBus} events the event bus\r\n */\r\nfunction Outline(events, styles) {\r\n\r\n  var OUTLINE_OFFSET = 5;\r\n\r\n  var OUTLINE_STYLE = styles.cls('djs-outline', [ 'no-fill' ]);\r\n\r\n  function createOutline(gfx) {\r\n    return gfx.rect(0, 0, 0, 0)\r\n            .attr(OUTLINE_STYLE)\r\n            .prependTo(gfx);\r\n  }\r\n\r\n  function updateOutline(outline, bbox) {\r\n\r\n    outline.attr({\r\n      x: bbox.x - OUTLINE_OFFSET,\r\n      y: bbox.y - OUTLINE_OFFSET,\r\n      width: bbox.width + OUTLINE_OFFSET * 2,\r\n      height: bbox.height + OUTLINE_OFFSET * 2\r\n    });\r\n  }\r\n\r\n  events.on('shape.added', function(event) {\r\n    var element = event.element,\r\n        gfx = event.gfx;\r\n\r\n    var outline = createOutline(gfx);\r\n\r\n    updateOutline(outline, GraphicsUtil.getVisual(gfx).getBBox());\r\n  });\r\n\r\n  events.on('connection.change', function(event) {\r\n    // TODO: update connection outline box\r\n  });\r\n\r\n  events.on('shape.change', function(event) {\r\n    // TODO: update shape outline box\r\n  });\r\n}\r\n\r\n\r\nOutline.$inject = ['eventBus', 'styles'];\r\n\r\nmodule.exports = Outline;\n},{\"../../util/GraphicsUtil\":64}],58:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'outline' ],\r\n  outline: [ 'type', _dereq_('./Outline') ]\r\n};\n},{\"./Outline\":57}],59:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A service that offers the current selection in a diagram.\r\n * Offers the api to control the selection, too.\r\n *\r\n * @param {EventBus} events the event bus\r\n */\r\nfunction Selection(events) {\r\n\r\n  var selectedElements = [];\r\n\r\n  function getSelection() {\r\n    return selectedElements;\r\n  }\r\n\r\n  function isSelected(shape) {\r\n    return selectedElements.indexOf(shape) !== -1;\r\n  }\r\n\r\n  /**\r\n   * This method selects one or more elements on the diagram.\r\n   *\r\n   * By passing an additional add parameter you can decide whether or not the element(s)\r\n   * should be added to the already existing selection or not.\r\n   *\r\n   * @method Selection#select\r\n   *\r\n   * @param  {Object|Object[]} elements element or array of elements to be selected\r\n   * @param  {boolean} [add] whether the element(s) should be appended to the current selection, defaults to false\r\n   */\r\n  function select(elements, add) {\r\n    var oldSelection = selectedElements.slice();\r\n\r\n    if (!_.isArray(elements)) {\r\n      elements = elements ? [ elements ] : [];\r\n    }\r\n\r\n    // selection may be cleared by passing an empty array or null\r\n    // to the method\r\n    if (elements.length && add) {\r\n      _.forEach(elements, function(element) {\r\n        if (selectedElements.indexOf(element) !== -1) {\r\n          // already selected\r\n          return;\r\n        } else {\r\n          selectedElements.push(element);\r\n        }\r\n      });\r\n    } else {\r\n      selectedElements = elements.slice();\r\n    }\r\n\r\n    events.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\r\n  }\r\n\r\n  function deselect(element) {\r\n    throw new Error('not implemented');\r\n  }\r\n\r\n  return {\r\n    getSelection: getSelection,\r\n    isSelected: isSelected,\r\n    select: select,\r\n    deselect: deselect\r\n  };\r\n}\r\n\r\nSelection.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = Selection;\n},{}],60:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds a visible selection UI to shapes and connections\r\n * by appending the <code>hover</code> and <code>selected</code> classes to them.\r\n *\r\n * Makes elements selectable, too.\r\n *\r\n * @param {EventBus} events\r\n * @param {SelectionService} selection\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction SelectionVisuals(events, selection, elementRegistry) {\r\n\r\n  var HOVER_CLS = 'hover',\r\n      SELECTED_CLS = 'selected';\r\n\r\n  function addMarker(gfx, cls) {\r\n    gfx.addClass(cls);\r\n  }\r\n\r\n  function removeMarker(gfx, cls) {\r\n    gfx.removeClass(cls);\r\n  }\r\n\r\n  /**\r\n   * Wire click on shape to select the shape\r\n   *\r\n   * @param  {Object} event the fired event\r\n   */\r\n  events.on('shape.click', function(event) {\r\n    var add = event.shiftKey;\r\n    selection.select(event.element, add);\r\n  });\r\n\r\n  events.on('shape.hover', function(event) {\r\n    addMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('shape.out', function(event) {\r\n    removeMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('selection.changed', function(event) {\r\n\r\n    function deselect(s) {\r\n      addMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    function select(s) {\r\n      removeMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    var oldSelection = event.oldSelection,\r\n        newSelection = event.newSelection;\r\n\r\n    _.forEach(oldSelection, function(e) {\r\n      if (newSelection.indexOf(e) === -1) {\r\n        select(e);\r\n      }\r\n    });\r\n\r\n    _.forEach(newSelection, function(e) {\r\n      if (oldSelection.indexOf(e) === -1) {\r\n        deselect(e);\r\n      }\r\n    });\r\n  });\r\n\r\n  // deselect all selected shapes on canvas click\r\n  events.on('canvas.click', function(event) {\r\n    if (event.srcElement === event.root.node) {\r\n      selection.select(null);\r\n    }\r\n  });\r\n}\r\n\r\nSelectionVisuals.$inject = [\r\n  'eventBus',\r\n  'selection',\r\n  'elementRegistry'\r\n];\r\n\r\nmodule.exports = SelectionVisuals;\n},{}],61:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'selectionVisuals' ],\r\n  __depends__: [\r\n    _dereq_('../interaction-events'),\r\n    _dereq_('../outline')\r\n  ],\r\n  selection: [ 'type', _dereq_('./Selection') ],\r\n  selectionVisuals: [ 'type', _dereq_('./SelectionVisuals') ]\r\n};\n},{\"../interaction-events\":56,\"../outline\":58,\"./Selection\":59,\"./SelectionVisuals\":60}],62:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Refs = _dereq_('object-refs');\r\n\r\nvar parentRefs = new Refs({ name: 'children', enumerable: true, collection: true }, { name: 'parent' }),\r\n    labelRefs = new Refs({ name: 'label', enumerable: true }, { name: 'labelTarget' }),\r\n    outgoingRefs = new Refs({ name: 'outgoing', collection: true }, { name: 'source' }),\r\n    incomingRefs = new Refs({ name: 'incoming', collection: true }, { name: 'target' });\r\n\r\n/**\r\n * The basic graphical representation\r\n *\r\n * @class djs.model.Base\r\n *\r\n * @abstract\r\n */\r\nfunction Base() {\r\n\r\n  /**\r\n   * @property {Object} businessObject the object that backs up the shape\r\n   */\r\n  Object.defineProperty(this, 'businessObject', {\r\n    writable: true\r\n  });\r\n\r\n  /**\r\n   * @property {djs.model.Shape} parent\r\n   */\r\n  parentRefs.bind(this, 'parent');\r\n\r\n  /**\r\n   * @property {djs.model.Label} label\r\n   */\r\n  labelRefs.bind(this, 'label');\r\n\r\n  /**\r\n   * @property {Array<djs.model.Connection>} outgoing the list of incoming connections\r\n   */\r\n  outgoingRefs.bind(this, 'outgoing');\r\n\r\n  /**\r\n   * @property {Array<djs.model.Connection>} incoming the list of outgoing connections\r\n   */\r\n  incomingRefs.bind(this, 'incoming');\r\n}\r\n\r\n\r\n/**\r\n * A graphical object\r\n *\r\n * @class djs.model.Shape\r\n *\r\n * @augments {djs.model.Base}\r\n */\r\nfunction Shape() {\r\n  Base.call(this);\r\n\r\n  /**\r\n   * @property {Array<djs.model.Base>} children list of children\r\n   */\r\n  parentRefs.bind(this, 'children');\r\n}\r\n\r\nShape.prototype = Object.create(Base.prototype);\r\n\r\n\r\n/**\r\n * The root graphical object\r\n *\r\n * @class djs.model.Root\r\n *\r\n * @augments {djs.model.Shape}\r\n */\r\nfunction Root() {\r\n  Shape.call(this);\r\n}\r\n\r\nRoot.prototype = Object.create(Shape.prototype);\r\n\r\n\r\n/**\r\n * A label for an element\r\n *\r\n * @class djs.model.Label\r\n *\r\n * @augments {djs.model.Shape}\r\n */\r\nfunction Label() {\r\n  Shape.call(this);\r\n\r\n  /**\r\n   * @property {djs.model.Base} labelTarget the element labeled\r\n   */\r\n  labelRefs.bind(this, 'labelTarget');\r\n}\r\n\r\nLabel.prototype = Object.create(Shape.prototype);\r\n\r\n\r\n/**\r\n * A connection between two elements\r\n *\r\n * @class djs.model.Connection\r\n *\r\n * @augments {djs.model.Base}\r\n */\r\nfunction Connection() {\r\n  Base.call(this);\r\n\r\n  /**\r\n   * @property {djs.model.Base} source the element this connection originates from\r\n   */\r\n  outgoingRefs.bind(this, 'source');\r\n\r\n  /**\r\n   * @property {djs.model.Base} target the element this connection points to\r\n   */\r\n  incomingRefs.bind(this, 'target');\r\n}\r\n\r\nConnection.prototype = Object.create(Base.prototype);\r\n\r\n\r\nvar types = {\r\n  connection: Connection,\r\n  shape: Shape,\r\n  label: Label,\r\n  root: Root\r\n};\r\n\r\n/**\r\n * Creates a new model element of the specified type\r\n *\r\n * @example\r\n *\r\n * var shape1 = Model.create('shape', { x: 10, y: 10, width: 100, height: 100 });\r\n * var shape2 = Model.create('shape', { x: 210, y: 210, width: 100, height: 100 });\r\n *\r\n * var connection = Model.create('connection', { waypoints: [ { x: 110, y: 55 }, {x: 210, y: 55 } ] });\r\n *\r\n * @param  {String} type lower-cased model name\r\n * @param  {Object} attrs attributes to initialize the new model instance with\r\n *\r\n * @return {djs.model.Base} the new model instance\r\n */\r\nmodule.exports.create = function(type, attrs) {\r\n  var Type = types[type];\r\n  if (!Type) {\r\n    throw new Error('unknown type: <' + type + '>');\r\n  }\r\n  return _.extend(new Type(), attrs);\r\n};\r\n\r\n\r\nmodule.exports.Root = Root;\r\nmodule.exports.Shape = Shape;\r\nmodule.exports.Connection = Connection;\r\nmodule.exports.Label = Label;\n},{\"object-refs\":70}],63:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Failsafe remove an element from a collection\r\n *\r\n * @param  {Array<Object>} [collection]\r\n * @param  {Object} [element]\r\n *\r\n * @return {Object} the element that got removed or undefined\r\n */\r\nmodule.exports.remove = function(collection, element) {\r\n\r\n  if (!collection || !element) {\r\n    return;\r\n  }\r\n\r\n  var idx = collection.indexOf(element);\r\n  if (idx === -1) {\r\n    return;\r\n  }\r\n\r\n  collection.splice(idx, 1);\r\n\r\n  return element;\r\n};\n},{}],64:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * @module util/GraphicsUtil\r\n */\r\n\r\nfunction is(e, cls) {\r\n  return e.hasClass(cls);\r\n}\r\n\r\n\r\n/**\r\n *\r\n * A note on how SVG elements are structured:\r\n *\r\n * Shape layout:\r\n *\r\n * [group.djs-group.djs-shape]\r\n *  |-> [rect.djs-hit]\r\n *  |-> [rect.djs-visual]\r\n *  |-> [rect.djs-outline]\r\n *  ...\r\n *\r\n * [group.djs-group.djs-connection]\r\n *  |-> [polyline.djs-hit]\r\n *  |-> [polyline.djs-visual]\r\n *  |-> [polyline.djs-outline]\r\n *  ...\r\n *\r\n */\r\n\r\n/**\r\n * Returns the visual part of a diagram element\r\n *\r\n * @param  {snapsvg.Element} gfx\r\n * @return {snapsvg.Element}\r\n */\r\nfunction getVisual(gfx) {\r\n  return gfx.select('.djs-visual');\r\n}\r\n\r\nmodule.exports.getVisual = getVisual;\n},{}],65:[function(_dereq_,module,exports){\nvar _ = (window._);\r\n\r\nvar DEFAULT_BOX_PADDING = 5;\r\n\r\nvar DEFAULT_LABEL_SIZE = {\r\n  width: 150,\r\n  height: 50\r\n};\r\n\r\n\r\nfunction parseAlign(align) {\r\n\r\n  var parts = align.split('-');\r\n\r\n  return {\r\n    horizontal: parts[0] || 'center',\r\n    vertical: parts[1] || 'top'\r\n  };\r\n}\r\n\r\nfunction parsePadding(padding) {\r\n\r\n  if (_.isObject(padding)) {\r\n    return _.extend({ top: 0, left: 0, right: 0, bottom: 0 }, padding);\r\n  } else {\r\n    return {\r\n      top: padding,\r\n      left: padding,\r\n      right: padding,\r\n      bottom: padding\r\n    };\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Creates a new label utility\r\n *\r\n * @param {Object} config\r\n * @param {Dimensions} config.size\r\n * @param {Number} config.padding\r\n * @param {Object} config.style\r\n * @param {String} config.align\r\n */\r\nfunction LabelUtil(config) {\r\n\r\n  config = _.extend({}, {\r\n    size: DEFAULT_LABEL_SIZE,\r\n    padding: DEFAULT_BOX_PADDING,\r\n    style: {},\r\n    align: 'center-top'\r\n  }, config || {});\r\n\r\n  /**\r\n   * Create a label in the parent node.\r\n   *\r\n   * @method LabelUtil#createLabel\r\n   *\r\n   * @param {SVGElement} parent the parent to draw the label on\r\n   * @param {String} text the text to render on the label\r\n   * @param {Object} options\r\n   * @param {String} options.align how to align in the bounding box.\r\n   *                             Any of { 'center-middle', 'center-top' }, defaults to 'center-top'.\r\n   * @param {String} options.style style to be applied to the text\r\n   *\r\n   * @return {SVGText} the text element created\r\n   */\r\n  function createLabel(parent, text, options) {\r\n\r\n    var box = _.merge({}, config.size, options.box || {}),\r\n        style = _.merge({}, config.style, options.style || {}),\r\n        align = parseAlign(options.align || config.align),\r\n        padding = parsePadding(options.padding !== undefined ? options.padding : config.padding);\r\n\r\n    var lines = text.split(/\\r?\\n/g),\r\n        layouted = [];\r\n\r\n    var maxWidth = box.width - padding.left - padding.right;\r\n\r\n    /**\r\n     * Layout the next line and return the layouted element.\r\n     *\r\n     * Alters the lines passed.\r\n     *\r\n     * @param  {Array<String>} lines\r\n     * @return {Object} the line descriptor, an object { width, height, text }\r\n     */\r\n    function layoutNext(lines) {\r\n\r\n      var originalLine = lines.shift(),\r\n          fitLine = originalLine;\r\n\r\n      var textBBox;\r\n\r\n      function fit() {\r\n        if (fitLine.length < originalLine.length) {\r\n          var nextLine = lines[0] || '',\r\n              remainder = originalLine.slice(fitLine.length);\r\n\r\n          if (/-\\s*$/.test(remainder)) {\r\n            nextLine = remainder.replace(/-\\s*$/, '') + nextLine.replace(/^\\s+/, '');\r\n          } else {\r\n            nextLine = remainder + ' ' + nextLine;\r\n          }\r\n\r\n          lines[0] = nextLine;\r\n        }\r\n        return { width: textBBox.width, height: textBBox.height, text: fitLine };\r\n      }\r\n\r\n      function getTextBBox(text) {\r\n        var textElement = parent.text(0, 0, fitLine).attr(style);\r\n\r\n        var bbox = textElement.getBBox();\r\n\r\n        textElement.remove();\r\n        return bbox;\r\n      }\r\n\r\n      /**\r\n       * Shortens a line based on spacing and hyphens.\r\n       * Returns the shortened result on success.\r\n       *\r\n       * @param  {String} line\r\n       * @param  {Number} maxLength the maximum characters of the string\r\n       * @return {String} the shortened string\r\n       */\r\n      function semanticShorten(line, maxLength) {\r\n        var parts = line.split(/(\\s|-)/g),\r\n            part,\r\n            shortenedParts = [],\r\n            length = 0;\r\n\r\n        // try to shorten via spaces + hyphens\r\n        if (parts.length > 1) {\r\n          while ((part = parts.shift())) {\r\n\r\n            if (part.length + length < maxLength) {\r\n              shortenedParts.push(part);\r\n              length += part.length;\r\n            } else {\r\n              // remove previous part, too if hyphen does not fit anymore\r\n              if (part === '-') {\r\n                shortenedParts.pop();\r\n              }\r\n\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        return shortenedParts.join('');\r\n      }\r\n\r\n      function shortenLine(line, width, maxWidth) {\r\n        var shortenedLine = '';\r\n\r\n        var approximateLength = line.length * (maxWidth / width);\r\n\r\n        // try to shorten semantically (i.e. based on spaces and hyphens)\r\n        shortenedLine = semanticShorten(line, approximateLength);\r\n\r\n        if (!shortenedLine) {\r\n\r\n          // force shorten by cutting the long word\r\n          shortenedLine = line.slice(0, Math.floor(approximateLength - 1));\r\n        }\r\n\r\n        return shortenedLine;\r\n      }\r\n\r\n\r\n      while (true) {\r\n\r\n        textBBox = getTextBBox(fitLine);\r\n\r\n        // try to fit\r\n        if (textBBox.width < maxWidth) {\r\n          return fit();\r\n        }\r\n\r\n        fitLine = shortenLine(fitLine, textBBox.width, maxWidth);\r\n      }\r\n    }\r\n\r\n    while (lines.length) {\r\n      layouted.push(layoutNext(lines));\r\n    }\r\n\r\n    var totalHeight = _.reduce(layouted, function(sum, line, idx) {\r\n      return sum + line.height;\r\n    }, 0);\r\n\r\n\r\n    // the center x position to align against\r\n    var cx = box.width / 2;\r\n\r\n    // the y position of the next line\r\n    var y, x;\r\n\r\n    switch (align.vertical) {\r\n      case 'middle':\r\n        y = (box.height - totalHeight) / 2 - layouted[0].height / 4;\r\n        break;\r\n\r\n      default:\r\n        y = padding.top;\r\n    }\r\n\r\n    var textElement = parent.group().attr(style);\r\n\r\n    _.forEach(layouted, function(line) {\r\n      y += line.height;\r\n\r\n      switch (align.horizontal) {\r\n        case 'left':\r\n          x = padding.left;\r\n          break;\r\n\r\n        case 'right':\r\n          x = (maxWidth - padding.right - line.width);\r\n          break;\r\n\r\n        default:\r\n          // aka center\r\n          x = (maxWidth - line.width) / 2 + padding.left;\r\n      }\r\n\r\n\r\n      parent.text(x, y, line.text).appendTo(textElement);\r\n    });\r\n\r\n    return textElement;\r\n  }\r\n\r\n  // API\r\n  this.createLabel = createLabel;\r\n}\r\n\r\n\r\nmodule.exports = LabelUtil;\n},{}],66:[function(_dereq_,module,exports){\n\r\nvar isArray = function(obj) {\r\n  return Object.prototype.toString.call(obj) === '[object Array]';\r\n};\r\n\r\nvar annotate = function() {\r\n  var args = Array.prototype.slice.call(arguments);\r\n  \r\n  if (args.length === 1 && isArray(args[0])) {\r\n    args = args[0];\r\n  }\r\n\r\n  var fn = args.pop();\r\n\r\n  fn.$inject = args;\r\n\r\n  return fn;\r\n};\r\n\r\n\r\n// Current limitations:\r\n// - can't put into \"function arg\" comments\r\n// function /* (no parenthesis like this) */ (){}\r\n// function abc( /* xx (no parenthesis like this) */ a, b) {}\r\n//\r\n// Just put the comment before function or inside:\r\n// /* (((this is fine))) */ function(a, b) {}\r\n// function abc(a) { /* (((this is fine))) */}\r\n\r\nvar FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\r\nvar FN_ARG = /\\/\\*([^\\*]*)\\*\\//m;\r\n\r\nvar parse = function(fn) {\r\n  if (typeof fn !== 'function') {\r\n    throw new Error('Cannot annotate \"' + fn + '\". Expected a function!');\r\n  }\r\n\r\n  var match = fn.toString().match(FN_ARGS);\r\n  return match[1] && match[1].split(',').map(function(arg) {\r\n    match = arg.match(FN_ARG);\r\n    return match ? match[1].trim() : arg.trim();\r\n  }) || [];\r\n};\r\n\r\n\r\nexports.annotate = annotate;\r\nexports.parse = parse;\r\nexports.isArray = isArray;\r\n\n},{}],67:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  annotate: _dereq_('./annotation').annotate,\r\n  Module: _dereq_('./module'),\r\n  Injector: _dereq_('./injector')\r\n};\r\n\n},{\"./annotation\":66,\"./injector\":68,\"./module\":69}],68:[function(_dereq_,module,exports){\nvar Module = _dereq_('./module');\r\nvar autoAnnotate = _dereq_('./annotation').parse;\r\nvar annotate = _dereq_('./annotation').annotate;\r\nvar isArray = _dereq_('./annotation').isArray;\r\n\r\n\r\nvar Injector = function(modules, parent) {\r\n  parent = parent || {\r\n    get: function(name) {\r\n      currentlyResolving.push(name);\r\n      throw error('No provider for \"' + name + '\"!');\r\n    }\r\n  };\r\n\r\n  var currentlyResolving = [];\r\n  var providers = this._providers = Object.create(parent._providers || null);\r\n  var instances = this._instances = Object.create(null);\r\n\r\n  var self = instances.injector = this;\r\n\r\n  var error = function(msg) {\r\n    var stack = currentlyResolving.join(' -> ');\r\n    currentlyResolving.length = 0;\r\n    return new Error(stack ? msg + ' (Resolving: ' + stack + ')' : msg);\r\n  };\r\n\r\n  var get = function(name) {\r\n    if (!providers[name] && name.indexOf('.') !== -1) {\r\n      var parts = name.split('.');\r\n      var pivot = get(parts.shift());\r\n\r\n      while(parts.length) {\r\n        pivot = pivot[parts.shift()];\r\n      }\r\n\r\n      return pivot;\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(instances, name)) {\r\n      return instances[name];\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(providers, name)) {\r\n      if (currentlyResolving.indexOf(name) !== -1) {\r\n        currentlyResolving.push(name);\r\n        throw error('Cannot resolve circular dependency!');\r\n      }\r\n\r\n      currentlyResolving.push(name);\r\n      instances[name] = providers[name][0](providers[name][1]);\r\n      currentlyResolving.pop();\r\n\r\n      return instances[name];\r\n    }\r\n\r\n    return parent.get(name);\r\n  };\r\n\r\n  var instantiate = function(Type) {\r\n    var instance = Object.create(Type.prototype);\r\n    var returned = invoke(Type, instance);\r\n\r\n    return typeof returned === 'object' ? returned : instance;\r\n  };\r\n\r\n  var invoke = function(fn, context) {\r\n    if (typeof fn !== 'function') {\r\n      if (isArray(fn)) {\r\n        fn = annotate(fn.slice());\r\n      } else {\r\n        throw new Error('Cannot invoke \"' + fn + '\". Expected a function!');\r\n      }\r\n    }\r\n\r\n    var inject = fn.$inject && fn.$inject || autoAnnotate(fn);\r\n    var dependencies = inject.map(function(dep) {\r\n      return get(dep);\r\n    });\r\n\r\n    // TODO(vojta): optimize without apply\r\n    return fn.apply(context, dependencies);\r\n  };\r\n\r\n\r\n  var createPrivateInjectorFactory = function(privateChildInjector) {\r\n    return annotate(function(key) {\r\n      return privateChildInjector.get(key);\r\n    });\r\n  };\r\n\r\n  var createChild = function(modules, forceNewInstances) {\r\n    if (forceNewInstances && forceNewInstances.length) {\r\n      var fromParentModule = Object.create(null);\r\n      var matchedScopes = Object.create(null);\r\n\r\n      var privateInjectorsCache = [];\r\n      var privateChildInjectors = [];\r\n      var privateChildFactories = [];\r\n\r\n      var provider;\r\n      var cacheIdx;\r\n      var privateChildInjector;\r\n      var privateChildInjectorFactory;\r\n      for (var name in providers) {\r\n        provider = providers[name];\r\n\r\n        if (forceNewInstances.indexOf(name) !== -1) {\r\n          if (provider[2] === 'private') {\r\n            cacheIdx = privateInjectorsCache.indexOf(provider[3]);\r\n            if (cacheIdx === -1) {\r\n              privateChildInjector = provider[3].createChild([], forceNewInstances);\r\n              privateChildInjectorFactory = createPrivateInjectorFactory(privateChildInjector);\r\n              privateInjectorsCache.push(provider[3]);\r\n              privateChildInjectors.push(privateChildInjector);\r\n              privateChildFactories.push(privateChildInjectorFactory);\r\n              fromParentModule[name] = [privateChildInjectorFactory, name, 'private', privateChildInjector];\r\n            } else {\r\n              fromParentModule[name] = [privateChildFactories[cacheIdx], name, 'private', privateChildInjectors[cacheIdx]];\r\n            }\r\n          } else {\r\n            fromParentModule[name] = [provider[2], provider[1]];\r\n          }\r\n          matchedScopes[name] = true;\r\n        }\r\n\r\n        if ((provider[2] === 'factory' || provider[2] === 'type') && provider[1].$scope) {\r\n          forceNewInstances.forEach(function(scope) {\r\n            if (provider[1].$scope.indexOf(scope) !== -1) {\r\n              fromParentModule[name] = [provider[2], provider[1]];\r\n              matchedScopes[scope] = true;\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      forceNewInstances.forEach(function(scope) {\r\n        if (!matchedScopes[scope]) {\r\n          throw new Error('No provider for \"' + scope + '\". Cannot use provider from the parent!');\r\n        }\r\n      });\r\n\r\n      modules.unshift(fromParentModule);\r\n    }\r\n\r\n    return new Injector(modules, self);\r\n  };\r\n\r\n  var factoryMap = {\r\n    factory: invoke,\r\n    type: instantiate,\r\n    value: function(value) {\r\n      return value;\r\n    }\r\n  };\r\n\r\n  modules.forEach(function(module) {\r\n\r\n    function arrayUnwrap(type, value) {\r\n      if (type !== 'value' && isArray(value)) {\r\n        value = annotate(value.slice());\r\n      }\r\n\r\n      return value;\r\n    }\r\n\r\n    // TODO(vojta): handle wrong inputs (modules)\r\n    if (module instanceof Module) {\r\n      module.forEach(function(provider) {\r\n        var name = provider[0];\r\n        var type = provider[1];\r\n        var value = provider[2];\r\n\r\n        providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n      });\r\n    } else if (typeof module === 'object') {\r\n      if (module.__exports__) {\r\n        var clonedModule = Object.keys(module).reduce(function(m, key) {\r\n          if (key.substring(0, 2) !== '__') {\r\n            m[key] = module[key];\r\n          }\r\n          return m;\r\n        }, Object.create(null));\r\n\r\n        var privateInjector = new Injector((module.__modules__ || []).concat([clonedModule]), self);\r\n        var getFromPrivateInjector = annotate(function(key) {\r\n          return privateInjector.get(key);\r\n        });\r\n        module.__exports__.forEach(function(key) {\r\n          providers[key] = [getFromPrivateInjector, key, 'private', privateInjector];\r\n        });\r\n      } else {\r\n        Object.keys(module).forEach(function(name) {\r\n          if (module[name][2] === 'private') {\r\n            providers[name] = module[name];\r\n            return;\r\n          }\r\n\r\n          var type = module[name][0];\r\n          var value = module[name][1];\r\n\r\n          providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  // public API\r\n  this.get = get;\r\n  this.invoke = invoke;\r\n  this.instantiate = instantiate;\r\n  this.createChild = createChild;\r\n};\r\n\r\nmodule.exports = Injector;\r\n\n},{\"./annotation\":66,\"./module\":69}],69:[function(_dereq_,module,exports){\nvar Module = function() {\r\n  var providers = [];\r\n\r\n  this.factory = function(name, factory) {\r\n    providers.push([name, 'factory', factory]);\r\n    return this;\r\n  };\r\n\r\n  this.value = function(name, value) {\r\n    providers.push([name, 'value', value]);\r\n    return this;\r\n  };\r\n\r\n  this.type = function(name, type) {\r\n    providers.push([name, 'type', type]);\r\n    return this;\r\n  };\r\n\r\n  this.forEach = function(iterator) {\r\n    providers.forEach(iterator);\r\n  };\r\n};\r\n\r\nmodule.exports = Module;\r\n\n},{}],70:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/refs');\r\n\r\nmodule.exports.Collection = _dereq_('./lib/collection');\n},{\"./lib/collection\":71,\"./lib/refs\":72}],71:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * An empty collection stub. Use {@link RefsCollection.extend} to extend a\r\n * collection with ref semantics.\r\n *\r\n * @classdesc A change and inverse-reference aware collection with set semantics.\r\n *\r\n * @class RefsCollection\r\n */\r\nfunction RefsCollection() { }\r\n\r\n/**\r\n * Extends a collection with {@link Refs} aware methods\r\n *\r\n * @memberof RefsCollection\r\n * @static\r\n *\r\n * @param  {Array<Object>} collection\r\n * @param  {Refs} refs instance\r\n * @param  {Object} property represented by the collection\r\n * @param  {Object} target object the collection is attached to\r\n *\r\n * @return {RefsCollection<Object>} the extended array\r\n */\r\nfunction extend(collection, refs, property, target) {\r\n\r\n  var inverseProperty = property.inverse;\r\n\r\n  /**\r\n   * Removes the given element from the array and returns it.\r\n   *\r\n   * @method RefsCollection#remove\r\n   *\r\n   * @param {Object} element the element to remove\r\n   */\r\n  collection.remove = function(element) {\r\n    var idx = this.indexOf(element);\r\n    if (idx !== -1) {\r\n      this.splice(idx, 1);\r\n\r\n      // unset inverse\r\n      refs.unset(element, inverseProperty, target);\r\n    }\r\n\r\n    return element;\r\n  };\r\n\r\n  /**\r\n   * Returns true if the collection contains the given element\r\n   *\r\n   * @method RefsCollection#contains\r\n   *\r\n   * @param {Object} element the element to check for\r\n   */\r\n  collection.contains = function(element) {\r\n    return this.indexOf(element) !== -1;\r\n  };\r\n\r\n  /**\r\n   * Adds an element to the array, unless it exists already (set semantics).\r\n   *\r\n   * @method RefsCollection#add\r\n   *\r\n   * @param {Object} element the element to add\r\n   */\r\n  collection.add = function(element) {\r\n\r\n    if (!this.contains(element)) {\r\n      this.push(element);\r\n\r\n      // set inverse\r\n      refs.set(element, inverseProperty, target);\r\n    }\r\n  };\r\n\r\n  return collection;\r\n}\r\n\r\n\r\nmodule.exports.extend = extend;\n},{}],72:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Collection = _dereq_('./collection');\r\n\r\nfunction hasOwnProperty(e, property) {\r\n  return Object.prototype.hasOwnProperty.call(e, property.name || property);\r\n}\r\n\r\n\r\nfunction defineCollectionProperty(ref, property, target) {\r\n  Object.defineProperty(target, property.name, {\r\n    enumerable: property.enumerable,\r\n    value: Collection.extend(target[property.name] || [], ref, property, target)\r\n  });\r\n}\r\n\r\n\r\nfunction defineProperty(ref, property, target) {\r\n\r\n  var inverseProperty = property.inverse;\r\n\r\n  var _value = target[property.name];\r\n\r\n  Object.defineProperty(target, property.name, {\r\n    enumerable: property.enumerable,\r\n\r\n    get: function() {\r\n      return _value;\r\n    },\r\n\r\n    set: function(value) {\r\n\r\n      // return if we already performed all changes\r\n      if (value === _value) {\r\n        return;\r\n      }\r\n\r\n      var old = _value;\r\n\r\n      // temporary set null\r\n      _value = null;\r\n\r\n      if (old) {\r\n        ref.unset(old, inverseProperty, target);\r\n      }\r\n\r\n      // set new value\r\n      _value = value;\r\n\r\n      // set inverse value\r\n      ref.set(_value, inverseProperty, target);\r\n    }\r\n  });\r\n\r\n}\r\n\r\n/**\r\n * Creates a new references object defining two inversly related\r\n * attribute descriptors a and b.\r\n *\r\n * <p>\r\n *   When bound to an object using {@link Refs#bind} the references\r\n *   get activated and ensure that add and remove operations are applied\r\n *   reversely, too.\r\n * </p>\r\n *\r\n * <p>\r\n *   For attributes represented as collections {@link Refs} provides the\r\n *   {@link RefsCollection#add}, {@link RefsCollection#remove} and {@link RefsCollection#contains} extensions\r\n *   that must be used to properly hook into the inverse change mechanism.\r\n * </p>\r\n *\r\n * @class Refs\r\n *\r\n * @classdesc A bi-directional reference between two attributes.\r\n *\r\n * @param {Refs.AttributeDescriptor} a property descriptor\r\n * @param {Refs.AttributeDescriptor} b property descriptor\r\n *\r\n * @example\r\n *\r\n * var refs = Refs({ name: 'wheels', collection: true, enumerable: true }, { name: 'car' });\r\n *\r\n * var car = { name: 'toyota' };\r\n * var wheels = [{ pos: 'front-left' }, { pos: 'front-right' }];\r\n *\r\n * refs.bind(car, 'wheels');\r\n *\r\n * car.wheels // []\r\n * car.wheels.add(wheels[0]);\r\n * car.wheels.add(wheels[1]);\r\n *\r\n * car.wheels // [{ pos: 'front-left' }, { pos: 'front-right' }]\r\n *\r\n * wheels[0].car // { name: 'toyota' };\r\n * car.wheels.remove(wheels[0]);\r\n *\r\n * wheels[0].car // undefined\r\n */\r\nfunction Refs(a, b) {\r\n\r\n  if (!(this instanceof Refs)) {\r\n    return new Refs(a, b);\r\n  }\r\n\r\n  // link\r\n  a.inverse = b;\r\n  b.inverse = a;\r\n\r\n  this.props = {};\r\n  this.props[a.name] = a;\r\n  this.props[b.name] = b;\r\n}\r\n\r\n/**\r\n * Binds one side of a bi-directional reference to a\r\n * target object.\r\n *\r\n * @memberOf Refs\r\n *\r\n * @param  {Object} target\r\n * @param  {String} property\r\n */\r\nRefs.prototype.bind = function(target, property) {\r\n  if (typeof property === 'string') {\r\n    if (!this.props[property]) {\r\n      throw new Error('no property <' + property + '> in ref');\r\n    }\r\n    property = this.props[property];\r\n  }\r\n\r\n  if (property.collection) {\r\n    defineCollectionProperty(this, property, target);\r\n  } else {\r\n    defineProperty(this, property, target);\r\n  }\r\n};\r\n\r\nRefs.prototype.ensureBound = function(target, property) {\r\n  if (!hasOwnProperty(target, property)) {\r\n    this.bind(target, property);\r\n  }\r\n};\r\n\r\nRefs.prototype.unset = function(target, property, value) {\r\n\r\n  if (target) {\r\n    this.ensureBound(target, property);\r\n\r\n    if (property.collection) {\r\n      target[property.name].remove(value);\r\n    } else {\r\n      target[property.name] = undefined;\r\n    }\r\n  }\r\n};\r\n\r\nRefs.prototype.set = function(target, property, value) {\r\n\r\n  if (target) {\r\n    this.ensureBound(target, property);\r\n\r\n    if (property.collection) {\r\n      target[property.name].add(value);\r\n    } else {\r\n      target[property.name] = value;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = Refs;\r\n\r\n\r\n/**\r\n * An attribute descriptor to be used specify an attribute in a {@link Refs} instance\r\n *\r\n * @typedef {Object} Refs.AttributeDescriptor\r\n * @property {String} name\r\n * @property {boolean} [collection=false]\r\n * @property {boolean} [enumerable=false]\r\n */\n},{\"./collection\":71}],73:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(70)\n},{\"./lib/collection\":74,\"./lib/refs\":75}],74:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(71)\n},{}],75:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(72)\n},{\"./collection\":74}]},{},[2])\n(2)\n});"]}