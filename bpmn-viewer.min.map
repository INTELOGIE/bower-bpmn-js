{"version":3,"file":"bpmn-viewer.min.js","sources":["bpmn-viewer.js"],"names":["require","e","t","n","r","s","o","u","a","i","Error","f","exports","call","length","bpmn-js","module","Focm2+","./lib/Viewer",3,"failSafeAsync","fn","args","Array","prototype","slice","arguments","done","_","isFunction","apply","this","window","KXdkPL","getSvgContents","diagram","paper","get","getPaper","outerNode","node","parentNode","svg","innerHTML","replace","initListeners","listeners","events","forEach","l","on","event","handler","Viewer","options","parent","container","$","addClass","css","position","appendTo","logoData","bottom","right","zIndex","attr","Diagram","BpmnModel","Importer","util","importXML","xml","self","fromXML","err","definitions","importDefinitions","saveXML","toXML","SVG_HEADER","SVG_FOOTER","saveSVG","svgContents","name","invoke","clear","createDiagram","modules","initDiagram","importBpmnDiagram","__listeners","concat","getModules","unshift","bpmnjs","canvas","_modules","destroy","push","./Util","./core","./import/Importer","bpmn-moddle","diagram-js","diagram-js/lib/features/selection","bpmn-js/Viewer",6,"BpmnRegistry","type","collection","elements","element","id","isObject","di","semantic","diagramElement","getSemantic","getDi","getDiagramElement","$inject",7,"__depends__","bpmnRegistry","../draw","./BpmnRegistry",8,"BpmnRenderer","styles","pathMap","addMarker","markers","marker","initMarkers","createMarker","attrs","extend","fill","strokeWidth","strokeLinecap","strokeDasharray","ref","x","y","scale","markerWidth","markerHeight","path","circle","stroke","computeStyle","custom","traits","defaultStyles","isArray","style","drawCircle","p","width","height","offset","cx","cy","Math","round","drawRect","rect","drawDiamond","x_2","y_2","points","polygon","drawLine","waypoints","flattenPoints","polyline","drawPath","d","as","data","handlers","renderer","renderEventContent","isThrowing","isThrowEvent","isTypedEvent","parallelMultiple","renderLabel","label","labelUtil","createLabel","renderEmbeddedLabel","align","box","renderExternalLabel","attachedId","fontSize","renderLaneLabel","text","textBox","top","transform","createPathFromWaypoints","pathData","attachTaskMarkers","taskMarkers","obj","subprocess","contains","seq","parallel","compensation","loop","adhoc","$type","loopCharacteristics","undefined","isSequential","isForCompensation","drawShape","h","DefaultRenderer","drawConnection","renderDataItemCollection","yPosition","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","mx","my","isCollection","dataObjectRef","isString","eventDefinitionType","filter","matches","definition","all","val","key","any","eventDefinitions","TASK_BORDER_RADIUS","INNER_OUTER_DIST","LABEL_STYLE","fontFamily","LabelUtil","size","bpmn:Event","bpmn:StartEvent","isInterrupting","bpmn:MessageEventDefinition","messagePath","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:LinkEventDefinition","bpmn:ErrorEventDefinition","bpmn:CancelEventDefinition","bpmn:CompensateEventDefinition","bpmn:SignalEventDefinition","bpmn:MultipleEventDefinition","bpmn:ParallelMultipleEventDefinition","bpmn:EndEvent","bpmn:TerminateEventDefinition","bpmn:IntermediateEvent","outer","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:Activity","bpmn:Task","bpmn:ServiceTask","task","pathDataBG","abspos","fillPathData","bpmn:UserTask","pathData2","pathData3","bpmn:ManualTask","bpmn:SendTask","bpmn:ReceiveTask","instantiate","bpmn:ScriptTask","bpmn:BusinessRuleTask","headerPathData","businessHeaderPath","headerData","businessPath","bpmn:SubProcess","expanded","DiUtil","isExpanded","isEventSubProcess","bpmn:AdHocSubProcess","bpmn:Transaction","innerAttrs","bpmn:CallActivity","bpmn:Participant","lane","expandedPool","isExpandedPool","text2","participantMultiplicity","bpmn:Lane","bpmn:InclusiveGateway","diamond","bpmn:ExclusiveGateway","bpmn:ComplexGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway","drawEvent","eventGatewayType","parallelPath","innerCircle","bpmn:Gateway","bpmn:SequenceFlow","markerEnd","sequenceFlow","source","sourceRef","conditionExpression","$instanceOf","markerStart","default","bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:MessageFlow","messageVisibleKind","midPoint","getPointAtLength","getTotalLength","markerPathData","messageAttrs","bpmn:DataObject","dataObject","bpmn:DataObjectReference","bpmn:DataInput","arrowPathData","getRawPath","bpmn:DataOutput","bpmn:DataStoreReference","DATA_STORE_PATH","dataStore","bpmn:BoundaryEvent","cancel","cancelActivity","bpmn:Group","pointerEvents","bpmn:TextAnnotation","textPathData","ParticipantMultiplicityMarker","subProcessPath","SubProcessMarker","markerRect","ParallelMarker","SequentialMarker","sequentialPath","CompensationMarker","compensationPath","LoopMarker","loopPath","strokeMiterlimit","AdhocMarker","Object","create","../util/Di","diagram-js/lib/draw/Renderer","diagram-js/lib/util/LabelUtil",9,"PathMap","Snap","EVENT_MESSAGE","heightElements","widthElements","EVENT_SIGNAL","EVENT_ESCALATION","EVENT_CONDITIONAL","EVENT_LINK","EVENT_ERROR","EVENT_CANCEL_45","EVENT_COMPENSATION","EVENT_TIMER_WH","EVENT_MULTIPLE","EVENT_PARALLEL_MULTIPLE","GATEWAY_EXCLUSIVE","GATEWAY_PARALLEL","GATEWAY_EVENT_BASED","GATEWAY_COMPLEX","DATA_OBJECT_PATH","DATA_OBJECT_COLLECTION_PATH","DATA_ARROW","DATA_STORE","TEXT_ANNOTATION","MARKER_SUB_PROCESS","MARKER_PARALLEL","MARKER_SEQUENTIAL","MARKER_COMPENSATION","MARKER_LOOP","MARKER_ADHOC","TASK_TYPE_SEND","TASK_TYPE_SCRIPT","TASK_TYPE_USER_1","TASK_TYPE_USER_2","TASK_TYPE_USER_3","TASK_TYPE_MANUAL","TASK_TYPE_INSTANTIATING_SEND","TASK_TYPE_SERVICE","TASK_TYPE_SERVICE_FILL","TASK_TYPE_BUSINESS_RULE_HEADER","TASK_TYPE_BUSINESS_RULE_MAIN","MESSAGE_FLOW_MARKER","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","format",10,"./BpmnRenderer","./PathMap",11,"BpmnTraverser","contextual","ctx","is","visit","gfx","elementGfxMap","visitIfDi","logError","message","context","error","registerDi","bpmnElement","elementDiMap","handleDiagram","handlePlane","plane","planeElement","handlePlaneElement","handleDefinitions","diagrams","indexOf","rootElement","handleProcess","handleCollaboration","handleUnhandledProcesses","rootElements","processes","laneSets","handledProcesses","handleDataAssociation","association","handleDataInput","dataInput","handleDataOutput","dataOutput","handleArtifact","artifact","handleArtifacts","artifacts","handleIoSpecification","ioSpecification","dataInputs","dataOutputs","handleSubProcess","subProcess","handleFlowElementsContainer","handleFlowNode","flowNode","childCtx","dataInputAssociations","dataOutputAssociations","handleSequenceFlow","handleDataElement","handleLane","newContext","childLaneSet","handleLaneSet","handleFlowElements","flowNodeRef","laneSet","lanes","handleLaneSets","handleNonFlowNodes","flowElements","sequenceFlows","handleParticipant","participant","newCtx","process","processRef","handleMessageFlow","messageFlow","handleMessageFlows","messageFlows","collaboration","participants",12,"hasLabel","isCollapsed","getWaypointsMid","mid","first","floor","second","ceil","getLabelBounds","bounds","max","addLabel","labelBounds","hidden","addShape","commandStack","visitor","fire","shape","collapsed","collect","waypoint","addConnection","console","warn","walker","BpmnTreeWalker","Util","../Util","./BpmnTreeWalker",13,"UqDJNG","./lib/model/Simple",16,"createModel","packages","Moddle","Bpmn","xmlStr","typeName","callback","reader","Reader","model","rootHandler","result","writer","Writer","instance","moddle","moddle-xml",17,"BpmnModdle","bpmn","bpmndi","dc","../../resources/bpmn/json/bpmn.json","../../resources/bpmn/json/bpmndi.json","../../resources/bpmn/json/dc.json","../../resources/bpmn/json/di.json","../Bpmn",18,"./lib/Reader","./lib/Writer",19,"parseNodeAttributes","nodeAttrs","attributes","reduce","v","ns","local","parseNameNs","prefix","value","normalizeNamespaces","defaultNsUri","uri","pkg","getPackage","Context","parseRoot","elementsById","references","warnings","addReference","reference","addElement","addWarning","w","logger","debug","BaseHandler","BodyHandler","ReferenceHandler","property","ValueHandler","propertyDesc","BaseElementHandler","ElementHandler","getType","GenericElementHandler","XMLReader","resolveReferences","$descriptor","propertiesByName","isMany","idx","splice","set","parser","sax","xmlns","trim","stack","Stack","onerror","onopentag","peek","handleNode","line","column","ontext","oncdata","handleText","onclosetag","old","pop","handleEnd","onend","getElement","write","close","common","coerceType","isSimpleType","aliasToName","body","createReference","handleChild","createElement","descriptor","bodyProperty","Type","prop","isReference","getPropertyForElement","nameNs","propertyName","localName","$pkg","elementType","find","properties","isVirtual","isAttribute","isA","effectiveType","toString","valueHandler","referenceHandler","childHandler","newElement","createAny","child","children","$children","$body","./common","moddle/lib/util","tiny-stack",20,"nsName","getElementNs","isGeneric","nameToAlias","getPropertyNs","getSerializableProperties","hasOwnProperty","escapeAttr","str","escapeMap","\n","\n\r","\"","filterAttributes","props","isAttr","filterContained","ReferenceSerializer","BodySerializer","ValueSerializer","ElementSerializer","TypeSerializer","SavingWriter","FormatingWriter","out","indent","append","appendNewLine","appendIndent","join","unindent","XMLWriter","tree","internalWriter","formatingWriter","preamble","XML_PREAMBLE","build","serializeTo","CDATA_ESCAPE","DEFAULT_NS_MAP","serializeValue","escape","test","otherAttrs","parseNsAttributes","nsTagName","parseGeneric","parseAttributes","parseContainments","parseGenericAttributes","effectiveNs","logNamespaceUsed","nsPropertyTagName","isLocalNs","nsAttributeName","genericAttrs","$attrs","logNamespace","addAttribute","isBody","asType","serialize","serializer","getNamespaces","namespaces","prefixMap","uriMap","used","existing","$model","serializeAttributes","collectNsAttrs","root","hasBody","b","typeNs",21,"hasLowerCaseAlias","alias","capitalize","string","charAt","toUpperCase","lower","toLowerCase","xsi",22,"./lib/Model","./lib/util",23,"DESCRIPTOR","PACKAGE","$define","defineProperty","$defineDescriptor","$defineModel","MODEL","$definePackage","allTypes","BaseType","Model","createType","ModelElement","enumerable","proto","modelInstance","init","registerType","elementsByName","propertyNs","isBuiltInType","propertyTypeNs","packageMap","types","collectEffectiveTypes","superClass","cls","parentNs","getEffectiveDescriptor","redefineProperty","nsPrefix","parts","redefines","split","attrName","redefinedProperty","replaceProperty","addProperty","addNamedProperty","oldProperty","newProperty","oldNameNs","propsByName","setBodyProperty","validate","assertNotDefined","createIdProperty","defaultId","idProperty","definedProperty","definedBy","needsId","generateIdProperty","unique","constraints","last","c","uriOrPrefix","getPackages","clone","typeCache","nsUri","getDescriptor","$propertyDescriptor","writable","./util",24,"Logger","defaultLevel","setLevel","level","LEVEL_MAP","DEFAULT_LEVEL","setHandler","log","logArgs","requestedLevel","none","info","getLevels","logging","temporaryLevel","trace",25,"defaultPrefix","converter","TYPE_CONVERTERS","BUILD_IN_TYPES","String","Boolean","Integer","Real","Element","parseInt","parseFloat","./Logger",26,"global","TinyStack","factory","arg","define",27,28,29,30,31,"associations","isAbstract","emumerations","literalValues",32,33,34,"isReadOnly","isUnique","subsettedProperty",35,"./lib/Diagram",36,"bootstrap","bootstrapModules","hasModule","m","addModule","__init__","components","injector","Injector","createInjector","configModule","config","coreModule","didi",37,"createContainer","document","setAttribute","isNumber","appendChild","Canvas","graphicsFactory","elementRegistry","createPaper","validateId","getById","execute","connection","sendToFront","bubble","getGraphics","gfxParent","remove","getGraphicsByElement","getSize","clientWidth","clientHeight","parseViewBox","viewbox","accuracy","bbox","getBBox","inner","getAttribute","min","scroll","delta","vbox","dx","dy","zoom","newScale","center","pox","poy","pnx","pny","px","py","registerHandler","AddShapeHandler","AddConnectionHandler","removeChild","updateShape","updateConnection","getAbsoluteBBox","transformBBox","./cmd/AddConnectionHandler","./cmd/AddShapeHandler",38,"CommandStack","redoAction","stackIdx","undoAction","action","internalExecute","getHandlers","executedHandlers","executeFinished","undo","revert","revertFinished","redo","handlerMap","addHandler","assertValidId","getStack","getStackIndex","register","command","handlerCls",39,"ElementRegistry","eventBus","graphicsMap","shapeMap","removeShape","getByGraphics",40,"EventBus","getListeners","listenerMap","extendEvent","stopPropagation","propagationStopped","preventDefault","defaultPrevented","isPropagationStopped","isDefaultPrevented","priority","EventPriority","standard","addEventToArray","once","wrappedCallback","eventType","off","listener","shift","array","sort","overwrite",41,"gfxContainer","group","clearVisual","oldVisual","select","newVisual","before","createContainerFactory","GraphicsFactory","snap","_renderer","_snap","createShape","createConnection","createSnapAt","gfxGroup","translate",42,"shapes","canExecute",43,"setParent","../../util/ShapeUtil",44,"./Canvas","./CommandStack","./ElementRegistry","./EventBus","./GraphicsFactory",45,"Renderer","CONNECTION_STYLE","SHAPE_STYLE",46,"snapsvg","./snapsvg-extensions",47,"Styles","defaultTraits","no-fill","no-border","strokeOpacity","no-events","className","additionalAttrs","class","inject",48,"./Renderer","./Snap","./Styles",49,"plugin","getClasses","setClasses","classes","current","add","hasClass","removeClass","matrix","Matrix","createElementNS",50,"InteractionEvents","isCtxSwitch","relatedTarget","target","baseEvent","eventName","makeSelectable","hit","dblclick","visual","GraphicsUtil","getVisual","HIT_STYLE","prependTo","hover","click","makeConnectionSelectable","makeShapeSelectable","registerEvents","../../util/GraphicsUtil",51,"interactionEvents","./InteractionEvents",52,"Outline","createOutline","OUTLINE_STYLE","updateOutline","outline","OUTLINE_OFFSET",53,"./Outline",54,"Selection","getSelection","selectedElements","isSelected","oldSelection","newSelection","deselect",55,"SelectionVisuals","selection","removeMarker","HOVER_CLS","SELECTED_CLS","shiftKey","srcElement",56,"selectionVisuals","../interaction-events","../outline","./Selection","./SelectionVisuals",57,58,"parseAlign","horizontal","vertical","parsePadding","padding","left","layoutNext","lines","fit","fitLine","originalLine","nextLine","remainder","textBBox","getTextBBox","textElement","semanticShorten","maxLength","part","shortenedParts","shortenLine","maxWidth","shortenedLine","approximateLength","merge","layouted","totalHeight","sum","DEFAULT_LABEL_SIZE","DEFAULT_BOX_PADDING",59,"canAdd","each","depth","selfAndChildren","maxDepth","processedChildren","selfAndDirectChildren","allowDuplicates","selfAndAllChildren","translateShape","newParent","eachShape",60,"annotate","FN_ARGS","FN_ARG","parse","match","map",61,"Module","./annotation","./injector","./module",62,"autoAnnotate","currentlyResolving","providers","_providers","instances","_instances","msg","pivot","returned","dependencies","dep","createPrivateInjectorFactory","privateChildInjector","createChild","forceNewInstances","provider","cacheIdx","privateChildInjectorFactory","fromParentModule","matchedScopes","privateInjectorsCache","privateChildInjectors","privateChildFactories","$scope","scope","factoryMap","arrayUnwrap","__exports__","clonedModule","keys","substring","privateInjector","__modules__","getFromPrivateInjector",63,"iterator"],"mappings":"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","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"bpmn-js\":[function(require,module,exports){\nmodule.exports=require('Focm2+');\n},{}],\"Focm2+\":[function(require,module,exports){\nmodule.exports = require('./lib/Viewer');\n},{\"./lib/Viewer\":\"KXdkPL\"}],3:[function(require,module,exports){\nvar _  = (window._);\r\n\r\nfunction failSafeAsync(fn) {\r\n\r\n  return function() {\r\n\r\n    var args = Array.prototype.slice.call(arguments);\r\n\r\n    var done = args[args.length - 1];\r\n    if (!done || !_.isFunction(done)) {\r\n      done = function(e) {\r\n        throw e;\r\n      };\r\n    }\r\n\r\n    try {\r\n      fn.apply(this, args);\r\n    } catch (e) {\r\n      done(e);\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports.failSafeAsync = failSafeAsync;\n},{}],\"KXdkPL\":[function(require,module,exports){\n'use strict';\r\n\r\nvar Diagram = require('diagram-js'),\r\n    BpmnModel = require('bpmn-moddle'),\r\n    $ = (window.$),\r\n    _ = (window._);\r\n\r\nvar Importer = require('./import/Importer'),\r\n    util = require('./Util');\r\n\r\n\r\nfunction getSvgContents(diagram) {\r\n  var paper = diagram.get('canvas').getPaper();\r\n  var outerNode = paper.node.parentNode;\r\n\r\n  var svg = outerNode.innerHTML;\r\n  return svg.replace(/^<svg[^>]*>|<\\/svg>$/g, '');\r\n}\r\n\r\nfunction initListeners(diagram, listeners) {\r\n  var events = diagram.get('eventBus');\r\n\r\n  listeners.forEach(function(l) {\r\n    events.on(l.event, l.handler);\r\n  });\r\n}\r\n\r\n/**\r\n * @class\r\n *\r\n * A viewer for BPMN 2.0 diagrams\r\n *\r\n * @param {Object} [options] configuration options to pass to the viewer\r\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\r\n * @param {String|Number} [options.width] the width of the viewer\r\n * @param {String|Number} [options.height] the height of the viewer\r\n */\r\nfunction Viewer(options) {\r\n  this.options = options = options || {};\r\n\r\n  var parent = options.container || $('body');\r\n\r\n  var container = $('<div></div>').addClass('bjs-container').css({\r\n    position: 'relative'\r\n  }).appendTo(parent);\r\n\r\n  _.forEach([ 'width', 'height' ], function(a) {\r\n    if (options[a]) {\r\n      container.css(a, options[a]);\r\n    }\r\n  });\r\n\r\n  // unwrap jquery\r\n  this.container = container.get(0);\r\n\r\n  /**\r\n   * The code in the <project-logo></project-logo> area\r\n   * must not be changed, see http://bpmn.io/license for more information\r\n   *\r\n   * <project-logo>\r\n   */\r\n\r\n  /* jshint -W101 */\r\n\r\n  // inlined ../resources/bpmnjs.png\r\n  var logoData = 'iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC';\r\n\r\n  /* jshint +W101 */\r\n\r\n  var a = $('<a href=\"http://bpmn.io\" target=\"_blank\" class=\"bjs-powered-by\" title=\"Powered by bpmn.io\" />').css({\r\n    position: 'absolute',\r\n    bottom: 15,\r\n    right: 15,\r\n    zIndex: 100\r\n  });\r\n\r\n  var logo = $('<img/>').attr('src', 'data:image/png;base64,' + logoData).appendTo(a);\r\n\r\n  a.appendTo(container);\r\n\r\n  /* </project-logo> */\r\n}\r\n\r\nViewer.prototype.importXML = function(xml, done) {\r\n\r\n  var self = this;\r\n\r\n  BpmnModel.fromXML(xml, 'bpmn:Definitions', function(err, definitions) {\r\n    if (err) {\r\n      return done(err);\r\n    }\r\n\r\n    self.importDefinitions(definitions, done);\r\n  });\r\n};\r\n\r\nViewer.prototype.saveXML = function(options, done) {\r\n\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  var definitions = this.definitions;\r\n\r\n  if (!definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  BpmnModel.toXML(definitions, options, function(err, xml) {\r\n    done(err, xml);\r\n  });\r\n};\r\n\r\n\r\nvar SVG_HEADER =\r\n'<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n'<!-- created with bpmn-js / http://bpmn.io -->\\n' +\r\n'<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n'<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\">\\n';\r\n\r\nvar SVG_FOOTER = '</svg>';\r\n\r\nViewer.prototype.saveSVG = function(options, done) {\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  if (!this.definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  var svgContents = getSvgContents(this.diagram);\r\n\r\n  var svg = SVG_HEADER + svgContents + SVG_FOOTER;\r\n\r\n  done(null, svg);\r\n};\r\n\r\nViewer.prototype.get = function(name) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.get(name);\r\n};\r\n\r\nViewer.prototype.invoke = function(fn) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.invoke(fn);\r\n};\r\n\r\nViewer.prototype.importDefinitions = util.failSafeAsync(function(definitions, done) {\r\n\r\n  var diagram = this.diagram;\r\n\r\n  if (diagram) {\r\n    this.clear();\r\n  }\r\n\r\n  diagram = this.createDiagram(this.options.modules);\r\n\r\n  this.initDiagram(diagram);\r\n\r\n  this.definitions = definitions;\r\n\r\n  Importer.importBpmnDiagram(diagram, definitions, done);\r\n});\r\n\r\nViewer.prototype.initDiagram = function(diagram) {\r\n  this.diagram = diagram;\r\n\r\n  initListeners(diagram, this.__listeners || []);\r\n};\r\n\r\nViewer.prototype.createDiagram = function(modules) {\r\n\r\n  modules = [].concat(modules || this.getModules());\r\n\r\n  // add self as an available service\r\n  modules.unshift({\r\n    bpmnjs: [ 'value', this ]\r\n  });\r\n\r\n  return new Diagram({\r\n    canvas: { container: this.container },\r\n    modules: modules\r\n  });\r\n};\r\n\r\nViewer.prototype.getModules = function() {\r\n  return this._modules;\r\n};\r\n\r\nViewer.prototype.clear = function() {\r\n  var diagram = this.diagram;\r\n\r\n  if (diagram) {\r\n    diagram.destroy();\r\n  }\r\n};\r\n\r\nViewer.prototype.on = function(event, handler) {\r\n  var diagram = this.diagram,\r\n      listeners = this.__listeners = this.__listeners || [];\r\n\r\n  listeners = this.__listeners || [];\r\n  listeners.push({ event: event, handler: handler });\r\n\r\n  if (diagram) {\r\n    diagram.get('eventBus').on(event, handler);\r\n  }\r\n};\r\n\r\n// modules that comprise the bpmn viewer\r\nViewer.prototype._modules = [\r\n  require('./core'),\r\n  require('diagram-js/lib/features/selection')\r\n];\r\n\r\nmodule.exports = Viewer;\r\n\n},{\"./Util\":3,\"./core\":7,\"./import/Importer\":12,\"bpmn-moddle\":\"UqDJNG\",\"diagram-js\":35,\"diagram-js/lib/features/selection\":56}],\"bpmn-js/Viewer\":[function(require,module,exports){\nmodule.exports=require('KXdkPL');\n},{}],6:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A registry that keeps track of bpmn semantic / di elements and the\r\n * corresponding shapes.\r\n *\r\n * @param {EventBus} events\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction BpmnRegistry(events, elementRegistry) {\r\n\r\n  var elements = {\r\n    di: {},\r\n    semantic: {},\r\n    diagramElement: {}\r\n  };\r\n\r\n  events.on('bpmn.element.add', function(e) {\r\n    var semantic = e.semantic,\r\n        id = semantic.id;\r\n\r\n    elements.di[id] = e.di;\r\n    elements.semantic[id] = e.semantic;\r\n    elements.diagramElement[id] = e.diagramElement;\r\n  });\r\n\r\n  events.on('bpmn.element.removed', function(e) {\r\n    var semantic = e.semantic,\r\n        id = semantic.id;\r\n\r\n    delete elements.di[id];\r\n    delete elements.semantic[id];\r\n    delete elements.diagramElement[id];\r\n  });\r\n\r\n  function get(type) {\r\n    var collection = elements[type];\r\n\r\n    return function(element) {\r\n      var id = _.isObject(element) ? element.id : element;\r\n\r\n      // strip label suffix\r\n      id = id.replace(/_label$/, '');\r\n\r\n      return collection[id];\r\n    };\r\n  }\r\n\r\n  // API\r\n  this.getSemantic = get('semantic');\r\n  this.getDi = get('di');\r\n  this.getDiagramElement = get('diagramElement');\r\n}\r\n\r\nBpmnRegistry.$inject = [ 'eventBus', 'elementRegistry' ];\r\n\r\nmodule.exports = BpmnRegistry;\n},{}],7:[function(require,module,exports){\nmodule.exports = {\r\n  __depends__: [ require('../draw') ],\r\n  bpmnRegistry: [ 'type', require('./BpmnRegistry') ]\r\n};\n},{\"../draw\":10,\"./BpmnRegistry\":6}],8:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar DefaultRenderer = require('diagram-js/lib/draw/Renderer');\r\nvar LabelUtil = require('diagram-js/lib/util/LabelUtil');\r\n\r\nvar DiUtil = require('../util/Di');\r\n\r\nvar flattenPoints = DefaultRenderer.flattenPoints;\r\n\r\n\r\nfunction BpmnRenderer(events, styles, bpmnRegistry, pathMap) {\r\n\r\n  DefaultRenderer.call(this, styles);\r\n\r\n  var TASK_BORDER_RADIUS = 10;\r\n  var INNER_OUTER_DIST = 3;\r\n\r\n  var LABEL_STYLE = {\r\n    fontFamily: 'Arial, sans-serif',\r\n    fontSize: '12px'\r\n  };\r\n\r\n  var labelUtil = new LabelUtil({\r\n    style: LABEL_STYLE,\r\n    size: { width: 100 }\r\n  });\r\n\r\n  var markers = {};\r\n\r\n  function addMarker(id, element) {\r\n    markers[id] = element;\r\n  }\r\n\r\n  function marker(id) {\r\n    return markers[id];\r\n  }\r\n\r\n  function initMarkers(paper) {\r\n\r\n    function createMarker(id, options) {\r\n      var attrs = _.extend({\r\n        fill: 'black',\r\n        strokeWidth: 1,\r\n        strokeLinecap: 'round',\r\n        strokeDasharray: 'none'\r\n      }, options.attrs);\r\n\r\n      var ref = options.ref || { x: 0, y: 0 };\r\n\r\n      var scale = options.scale || 1;\r\n\r\n      // fix for safari / chrome / firefox bug not correctly\r\n      // resetting stroke dash array\r\n      if (attrs.strokeDasharray === 'none') {\r\n        attrs.strokeDasharray = [10000, 1];\r\n      }\r\n\r\n      var marker = options.element\r\n                     .attr(attrs)\r\n                     .marker(0, 0, 20, 20, ref.x, ref.y)\r\n                     .attr({\r\n                       markerWidth: 20 * scale,\r\n                       markerHeight: 20 * scale\r\n                     });\r\n\r\n      return addMarker(id, marker);\r\n    }\r\n\r\n\r\n    createMarker('sequenceflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('messageflow-start', {\r\n      element: paper.circle(6, 6, 5),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 6, y: 6 }\r\n    });\r\n\r\n    createMarker('messageflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 }\r\n    });\r\n\r\n    createMarker('data-association-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-flow-marker', {\r\n      element: paper.path('M 0 10 L 8 6 L 16 10 L 8 14 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -1, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-default-flow-marker', {\r\n      element: paper.path('M 1 4 L 5 16'),\r\n      attrs: {\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -5, y: 10 },\r\n      scale: 0.5\r\n    });\r\n  }\r\n\r\n  function computeStyle(custom, traits, defaultStyles) {\r\n    if (!_.isArray(traits)) {\r\n      defaultStyles = traits;\r\n      traits = [];\r\n    }\r\n\r\n    return styles.style(traits || [], _.extend(defaultStyles, custom || {}));\r\n  }\r\n\r\n  function drawCircle(p, width, height, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    var cx = width / 2,\r\n        cy = height / 2;\r\n\r\n    return p.circle(cx, cy, Math.round((width + height) / 4 - offset)).attr(attrs);\r\n  }\r\n\r\n  function drawRect(p, width, height, r, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.rect(offset, offset, width - offset * 2, height - offset * 2, r).attr(attrs);\r\n  }\r\n\r\n  function drawDiamond(p, width, height, attrs) {\r\n\r\n    var x_2 = width / 2;\r\n    var y_2 = height / 2;\r\n\r\n    var points = [x_2, 0, width, y_2, x_2, height, 0, y_2 ];\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.polygon(points).attr(attrs);\r\n  }\r\n\r\n  function drawLine(p, waypoints, attrs) {\r\n    var points = flattenPoints(waypoints);\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'none'\r\n    });\r\n\r\n    return p.polyline(points).attr(attrs);\r\n  }\r\n\r\n  function drawPath(p, d, attrs) {\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      strokeWidth: 2,\r\n      stroke: 'black'\r\n    });\r\n\r\n    return p.path(d).attr(attrs);\r\n  }\r\n\r\n  function as(type) {\r\n    return function(p, data) {\r\n      return handlers[type](p, data);\r\n    };\r\n  }\r\n\r\n  function renderer(type) {\r\n    return handlers[type];\r\n  }\r\n\r\n  function renderEventContent(data, p) {\r\n\r\n    var event = bpmnRegistry.getSemantic(data);\r\n    var isThrowing = isThrowEvent(event);\r\n\r\n    if (isTypedEvent(event, 'bpmn:MessageEventDefinition')) {\r\n      return renderer('bpmn:MessageEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TimerEventDefinition')) {\r\n      return renderer('bpmn:TimerEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ConditionalEventDefinition')) {\r\n      return renderer('bpmn:ConditionalEventDefinition')(p, data);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:SignalEventDefinition')) {\r\n      return renderer('bpmn:SignalEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: false })) {\r\n      return renderer('bpmn:MultipleEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: true })) {\r\n      return renderer('bpmn:ParallelMultipleEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:EscalationEventDefinition')) {\r\n      return renderer('bpmn:EscalationEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:LinkEventDefinition')) {\r\n      return renderer('bpmn:LinkEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ErrorEventDefinition')) {\r\n      return renderer('bpmn:ErrorEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition')) {\r\n      return renderer('bpmn:CancelEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CompensateEventDefinition')) {\r\n      return renderer('bpmn:CompensateEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TerminateEventDefinition')) {\r\n      return renderer('bpmn:TerminateEventDefinition')(p, data, isThrowing);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  function renderLabel(p, label, options) {\r\n    return labelUtil.createLabel(p, label || '', options).addClass('djs-label');\r\n  }\r\n\r\n  function renderEmbeddedLabel(p, data, align) {\r\n    var element = bpmnRegistry.getSemantic(data);\r\n\r\n    return renderLabel(p, element.name, { box: data, align: align });\r\n  }\r\n\r\n  function renderExternalLabel(p, data, align) {\r\n    var element = bpmnRegistry.getSemantic(data.attachedId);\r\n    return renderLabel(p, element.name, { box: data, align: align, style: { fontSize: '11px' } });\r\n  }\r\n\r\n  function renderLaneLabel(p, text, data) {\r\n    var textBox = renderLabel(p, text, {\r\n      box: { height: 30, width: data.height },\r\n      align: 'center-middle'\r\n    });\r\n\r\n    var top = -1 * data.height;\r\n    textBox.transform(\r\n      'rotate(270) ' +\r\n      'translate(' + top + ',' + 0 + ')'\r\n    );\r\n  }\r\n\r\n  function createPathFromWaypoints(waypoints) {\r\n    var pathData = 'm  ' + waypoints[0].x + ',' + waypoints[0].y;\r\n    for (var i = 1; i < waypoints.length; i++) {\r\n      pathData += 'L' + waypoints[i].x + ',' + waypoints[i].y + ' ';\r\n    }\r\n    return pathData;\r\n  }\r\n\r\n  var handlers = {\r\n    'bpmn:Event': function(p, data, attrs) {\r\n      return drawCircle(p, data.width, data.height,  attrs);\r\n    },\r\n    'bpmn:StartEvent': function(p, data) {\r\n      var attrs = {};\r\n      var semantic = getSemantic(data);\r\n\r\n      if (!semantic.isInterrupting) {\r\n        attrs = {\r\n          strokeDasharray: '6',\r\n          strokeLinecap: 'round'\r\n        };\r\n      }\r\n\r\n      var circle = renderer('bpmn:Event')(p, data, attrs);\r\n\r\n      renderEventContent(data, p);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:MessageEventDefinition': function(p, data, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MESSAGE', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.235,\r\n          my: 0.315\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n      var stroke = isThrowing ? 'white' : 'black';\r\n\r\n      var messagePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill,\r\n        stroke: stroke\r\n      });\r\n\r\n      return messagePath;\r\n    },\r\n    'bpmn:TimerEventDefinition': function(p, data) {\r\n\r\n      var circle = drawCircle(p, data.width, data.height, 0.2 * data.height, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('EVENT_TIMER_WH', {\r\n        xScaleFactor: 0.75,\r\n        yScaleFactor: 0.75,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.5\r\n        }\r\n      });\r\n\r\n      var path = drawPath(p, pathData, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:EscalationEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ESCALATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.555\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ConditionalEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CONDITIONAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.222\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:LinkEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_LINK', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.57,\r\n          my: 0.263\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:ErrorEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ERROR', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.2,\r\n          my: 0.722\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:CancelEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CANCEL_45', {\r\n        xScaleFactor: 1.0,\r\n        yScaleFactor: 1.0,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.638,\r\n          my: -0.055\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      }).transform('rotate(45)');\r\n    },\r\n    'bpmn:CompensateEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.201,\r\n          my: 0.472\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:SignalEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_SIGNAL', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:MultipleEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MULTIPLE', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.222,\r\n          my: 0.36\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ParallelMultipleEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_PARALLEL_MULTIPLE', {\r\n        xScaleFactor: 1.2,\r\n        yScaleFactor: 1.2,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.458,\r\n          my: 0.194\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:EndEvent': function(p, data) {\r\n      var circle = renderer('bpmn:Event')(p, data, {\r\n        strokeWidth: 4\r\n      });\r\n\r\n      renderEventContent(data, p, true);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:TerminateEventDefinition': function(p, data) {\r\n      var circle = drawCircle(p, data.width, data.height, 8, {\r\n        strokeWidth: 4,\r\n        fill: 'black'\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:IntermediateEvent': function(p, data) {\r\n      var outer = renderer('bpmn:Event')(p, data, { strokeWidth: 1 });\r\n      var inner = drawCircle(p, data.width, data.height, INNER_OUTER_DIST, { strokeWidth: 1 });\r\n\r\n      renderEventContent(data, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:IntermediateCatchEvent': as('bpmn:IntermediateEvent'),\r\n    'bpmn:IntermediateThrowEvent': as('bpmn:IntermediateEvent'),\r\n\r\n    'bpmn:Activity': function(p, data, attrs) {\r\n      return drawRect(p, data.width, data.height, TASK_BORDER_RADIUS, attrs);\r\n    },\r\n\r\n    'bpmn:Task': function(p, data) {\r\n      var rect = renderer('bpmn:Activity')(p, data);\r\n      renderEmbeddedLabel(p, data, 'center-middle');\r\n      attachTaskMarkers(p, data);\r\n      return rect;\r\n    },\r\n    'bpmn:ServiceTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var pathDataBG = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 12,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var servicePathBG = drawPath(p, pathDataBG, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var fillPathData = pathMap.getScaledPath('TASK_TYPE_SERVICE_FILL', {\r\n        abspos: {\r\n          x: 17.2,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var serviceFillPath = drawPath(p, fillPathData, {\r\n        strokeWidth: 0,\r\n        stroke: 'none',\r\n        fill: 'white'\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 22\r\n        }\r\n      });\r\n\r\n      var servicePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:UserTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var x = 15;\r\n      var y = 12;\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_USER_1', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath2 = drawPath(p, pathData2, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath3 = drawPath(p, pathData3, {\r\n        strokeWidth: 0.5,\r\n        fill: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ManualTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_MANUAL', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 15\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.25,\r\n        fill: 'none',\r\n        stroke: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SendTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: 21,\r\n        containerHeight: 14,\r\n        position: {\r\n          mx: 0.285,\r\n          my: 0.357\r\n        }\r\n      });\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black',\r\n        stroke: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ReceiveTask' : function(p, data) {\r\n      var semantic = getSemantic(data);\r\n\r\n      var task = renderer('bpmn:Task')(p, data);\r\n      var pathData;\r\n\r\n      if (semantic.instantiate) {\r\n        drawCircle(p, 28, 28, 20 * 0.22, { strokeWidth: 1 });\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_INSTANTIATING_SEND', {\r\n          abspos: {\r\n            x: 7.77,\r\n            y: 9.52\r\n          }\r\n        });\r\n      } else {\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n          xScaleFactor: 0.9,\r\n          yScaleFactor: 0.9,\r\n          containerWidth: 21,\r\n          containerHeight: 14,\r\n          position: {\r\n            mx: 0.3,\r\n            my: 0.4\r\n          }\r\n        });\r\n      }\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ScriptTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SCRIPT', {\r\n        abspos: {\r\n          x: 15,\r\n          y: 20\r\n        }\r\n      });\r\n\r\n      var scriptPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:BusinessRuleTask': function(p, data) {\r\n      var task = renderer('bpmn:Task')(p, data);\r\n\r\n      var headerPathData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_HEADER', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessHeaderPath = drawPath(p, headerPathData);\r\n      businessHeaderPath.attr({\r\n        strokeWidth: 1,\r\n        fill: 'AAA'\r\n      });\r\n\r\n      var headerData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_MAIN', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessPath = drawPath(p, headerData);\r\n      businessPath.attr({\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SubProcess': function(p, data, attrs) {\r\n      var rect = renderer('bpmn:Activity')(p, data, attrs);\r\n\r\n      var semantic = getSemantic(data),\r\n          di = getDi(data);\r\n\r\n      var expanded = DiUtil.isExpanded(semantic, di);\r\n\r\n      var isEventSubProcess = !!(getSemantic(data).triggeredByEvent);\r\n      if (isEventSubProcess) {\r\n        rect.attr({\r\n          strokeDasharray: '1,2'\r\n        });\r\n      }\r\n\r\n      renderEmbeddedLabel(p, data, expanded ? 'center-top' : 'center-middle');\r\n\r\n      if (expanded) {\r\n        attachTaskMarkers(p, data);\r\n      } else {\r\n        attachTaskMarkers(p, data, ['SubProcessMarker']);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:AdHocSubProcess': function(p, data) {\r\n      return renderer('bpmn:SubProcess')(p, data);\r\n    },\r\n    'bpmn:Transaction': function(p, data) {\r\n      var outer = renderer('bpmn:SubProcess')(p, data);\r\n\r\n      var innerAttrs = styles.style([ 'no-fill', 'no-events' ]);\r\n      var inner = drawRect(p, data.width, data.height, TASK_BORDER_RADIUS - 2, INNER_OUTER_DIST, innerAttrs);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:CallActivity': function(p, data) {\r\n      return renderer('bpmn:SubProcess')(p, data, {\r\n        strokeWidth: 5\r\n      });\r\n    },\r\n    'bpmn:Participant': function(p, data) {\r\n\r\n      var lane = renderer('bpmn:Lane')(p, data);\r\n\r\n      var expandedPool = DiUtil.isExpandedPool(getSemantic(data));\r\n\r\n      if (expandedPool) {\r\n        drawLine(p, [\r\n          {x: 30, y: 0},\r\n          {x: 30, y: data.height}\r\n        ]);\r\n        var text = getSemantic(data).name;\r\n        renderLaneLabel(p, text, data);\r\n      } else {\r\n        // Collapsed pool draw text inline\r\n        var text2 = getSemantic(data).name;\r\n        renderLabel(p, text2, { box: data, align: 'center-middle' });\r\n      }\r\n\r\n      var participantMultiplicity = !!(getSemantic(data).participantMultiplicity);\r\n\r\n      if(participantMultiplicity) {\r\n        renderer('ParticipantMultiplicityMarker')(p, data);\r\n      }\r\n\r\n      return lane;\r\n    },\r\n    'bpmn:Lane': function(p, data) {\r\n      var rect = drawRect(p, data.width, data.height, 0, {\r\n        fill: 'none'\r\n      });\r\n\r\n      var semantic = getSemantic(data);\r\n\r\n      if (semantic.$type === 'bpmn:Lane') {\r\n        var text = semantic.name;\r\n        renderLaneLabel(p, text, data);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:InclusiveGateway': function(p, data) {\r\n      var diamond = drawDiamond(p, data.width, data.height);\r\n\r\n      var circle = drawCircle(p, data.width, data.height, data.height * 0.24, {\r\n        strokeWidth: 2.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ExclusiveGateway': function(p, data) {\r\n      var diamond = drawDiamond(p, data.width, data.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_EXCLUSIVE', {\r\n        xScaleFactor: 0.4,\r\n        yScaleFactor: 0.4,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.32,\r\n          my: 0.3\r\n        }\r\n      });\r\n\r\n      var exclusivePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ComplexGateway': function(p, data) {\r\n      var diamond = drawDiamond(p, data.width, data.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_COMPLEX', {\r\n        xScaleFactor: 0.5,\r\n        yScaleFactor:0.5,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.26\r\n        }\r\n      });\r\n\r\n      var complexPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ParallelGateway': function(p, data) {\r\n      var diamond = drawDiamond(p, data.width, data.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n        xScaleFactor: 0.6,\r\n        yScaleFactor:0.6,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var parallelPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:EventBasedGateway': function(p, data) {\r\n\r\n      var semantic = getSemantic(data);\r\n\r\n      var diamond = drawDiamond(p, data.width, data.height);\r\n\r\n      var outerCircle = drawCircle(p, data.width, data.height, data.height * 0.20, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var type = semantic.eventGatewayType;\r\n      var instantiate = !!semantic.instantiate;\r\n\r\n      function drawEvent() {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_EVENT_BASED', {\r\n          xScaleFactor: 0.18,\r\n          yScaleFactor: 0.18,\r\n          containerWidth: data.width,\r\n          containerHeight: data.height,\r\n          position: {\r\n            mx: 0.36,\r\n            my: 0.44\r\n          }\r\n        });\r\n\r\n        var eventPath = drawPath(p, pathData, {\r\n          strokeWidth: 2,\r\n          fill: 'none'\r\n        });\r\n      }\r\n\r\n      if (type === 'Parallel') {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n          xScaleFactor: 0.4,\r\n          yScaleFactor:0.4,\r\n          containerWidth: data.width,\r\n          containerHeight: data.height,\r\n          position: {\r\n            mx: 0.474,\r\n            my: 0.296\r\n          }\r\n        });\r\n\r\n        var parallelPath = drawPath(p, pathData);\r\n        parallelPath.attr({\r\n          strokeWidth: 1,\r\n          fill: 'none'\r\n        });\r\n      } else if (type === 'Exclusive') {\r\n\r\n        if (!instantiate) {\r\n          var innerCircle = drawCircle(p, data.width, data.height, data.height * 0.26);\r\n          innerCircle.attr({\r\n            strokeWidth: 1,\r\n            fill: 'none'\r\n          });\r\n        }\r\n\r\n        drawEvent();\r\n      }\r\n\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:Gateway': function(p, data) {\r\n      return drawDiamond(p, data.width, data.height);\r\n    },\r\n    'bpmn:SequenceFlow': function(p, data) {\r\n      var pathData = createPathFromWaypoints(data.waypoints);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('sequenceflow-end')\r\n      });\r\n\r\n      var sequenceFlow = bpmnRegistry.getSemantic(data.id);\r\n      var source = sequenceFlow.sourceRef;\r\n\r\n      // conditional flow marker\r\n      if (sequenceFlow.conditionExpression && source.$instanceOf('bpmn:Task')) {\r\n        path.attr({\r\n          markerStart: marker('conditional-flow-marker')\r\n        });\r\n      }\r\n\r\n      // default marker\r\n      if (source.default && source.$instanceOf('bpmn:Gateway') && source.default === sequenceFlow) {\r\n        path.attr({\r\n          markerStart: marker('conditional-default-flow-marker')\r\n        });\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:Association': function(p, data, attrs) {\r\n\r\n      attrs = _.extend({\r\n        strokeDasharray: '1,6',\r\n        strokeLinecap: 'round'\r\n      }, attrs || {});\r\n\r\n      // TODO(nre): style according to directed state\r\n      return drawLine(p, data.waypoints, attrs);\r\n    },\r\n    'bpmn:DataInputAssociation': function(p, data) {\r\n      return renderer('bpmn:Association')(p, data, {\r\n        markerEnd: marker('data-association-end')\r\n      });\r\n    },\r\n    'bpmn:DataOutputAssociation': function(p, data) {\r\n      return renderer('bpmn:Association')(p, data, {\r\n        markerEnd: marker('data-association-end')\r\n      });\r\n    },\r\n    'bpmn:MessageFlow': function(p, data) {\r\n\r\n      var di = getDi(data);\r\n\r\n      var pathData = createPathFromWaypoints(data.waypoints);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('messageflow-end'),\r\n        markerStart: marker('messageflow-start'),\r\n        strokeDasharray: '10',\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      });\r\n\r\n      if (!!di.messageVisibleKind) {\r\n        var midPoint = path.getPointAtLength(path.getTotalLength() / 2);\r\n\r\n        var markerPathData = pathMap.getScaledPath('MESSAGE_FLOW_MARKER', {\r\n          abspos: {\r\n            x: midPoint.x,\r\n            y: midPoint.y\r\n          }\r\n        });\r\n\r\n        var messageAttrs = { strokeWidth: 1 };\r\n\r\n        if (di.messageVisibleKind === 'initiating') {\r\n          messageAttrs.fill = 'white';\r\n          messageAttrs.stroke = 'black';\r\n        } else {\r\n          messageAttrs.fill = '#888';\r\n          messageAttrs.stroke = 'white';\r\n        }\r\n\r\n        drawPath(p, markerPathData, messageAttrs);\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:DataObject': function(p, data) {\r\n      var pathData = pathMap.getScaledPath('DATA_OBJECT_PATH', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.474,\r\n          my: 0.296\r\n        }\r\n      });\r\n\r\n      var dataObject = drawPath(p, pathData, { fill: 'white' });\r\n\r\n      var semantic = getSemantic(data);\r\n\r\n      if (isCollection(semantic)) {\r\n        renderDataItemCollection(p, data);\r\n      }\r\n\r\n      return dataObject;\r\n    },\r\n    'bpmn:DataObjectReference': as('bpmn:DataObject'),\r\n    'bpmn:DataInput': function(p, data) {\r\n\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var dataObject = renderer('bpmn:DataObject')(p, data);\r\n\r\n      // arrow\r\n      var dataInput = drawPath(p, arrowPathData, { strokeWidth: 1 });\r\n\r\n      return dataObject;\r\n    },\r\n    'bpmn:DataOutput': function(p, data) {\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var dataObject = renderer('bpmn:DataObject')(p, data);\r\n\r\n      // arrow\r\n      var dataInput = drawPath(p, arrowPathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return dataObject;\r\n    },\r\n    'bpmn:DataStoreReference': function(p, data) {\r\n      var DATA_STORE_PATH = pathMap.getScaledPath('DATA_STORE', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0,\r\n          my: 0.133\r\n        }\r\n      });\r\n\r\n      var dataStore = drawPath(p, DATA_STORE_PATH, {\r\n        strokeWidth: 2,\r\n        fill: 'white'\r\n      });\r\n\r\n      return dataStore;\r\n    },\r\n    'bpmn:BoundaryEvent': function(p, data) {\r\n\r\n      var semantic = getSemantic(data),\r\n          cancel = semantic.cancelActivity;\r\n\r\n      var attrs = {\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      };\r\n\r\n      if (!cancel) {\r\n        attrs.strokeDasharray = '6';\r\n      }\r\n\r\n      var outer = renderer('bpmn:Event')(p, data, attrs);\r\n      var inner = drawCircle(p, data.width, data.height, INNER_OUTER_DIST, attrs);\r\n\r\n      renderEventContent(data, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:Group': function(p, data) {\r\n      return drawRect(p, data.width, data.height, TASK_BORDER_RADIUS, {\r\n        strokeWidth: 1,\r\n        strokeDasharray: '8,3,1,3',\r\n        fill: 'none',\r\n        pointerEvents: 'none'\r\n      });\r\n    },\r\n    'label': function(p, data) {\r\n      return renderExternalLabel(p, data, '');\r\n    },\r\n    'bpmn:TextAnnotation': function(p, data) {\r\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: 0.0,\r\n          my: 0.0\r\n        }\r\n      });\r\n      drawPath(p, textPathData);\r\n\r\n      var text = getSemantic(data).text || '';\r\n      var label = renderLabel(p, text, { box: data, align: 'left-middle' });\r\n\r\n      return label;\r\n    },\r\n    'ParticipantMultiplicityMarker': function(p, data) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2) / data.width),\r\n          my: (data.height - 15) / data.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SubProcessMarker': function(p, data) {\r\n      var markerRect = drawRect(p, 14, 14, 0, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      // Process marker is placed in the middle of the box\r\n      // therefore fixed values can be used here\r\n      markerRect.transform('translate(' + (data.width / 2 - 7.5) + ',' + (data.height - 20) + ')');\r\n\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_SUB_PROCESS', {\r\n        xScaleFactor: 1.5,\r\n        yScaleFactor: 1.5,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: (data.width / 2 - 7.5) / data.width,\r\n          my: (data.height - 20) / data.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'ParallelMarker': function(p, data, position) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2 + position.parallel) / data.width),\r\n          my: (data.height - 20) / data.height\r\n        }\r\n      });\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SequentialMarker': function(p, data, position) {\r\n      var sequentialPath = pathMap.getScaledPath('MARKER_SEQUENTIAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2 + position.seq) / data.width),\r\n          my: (data.height - 19) / data.height\r\n        }\r\n      });\r\n      drawPath(p, sequentialPath);\r\n    },\r\n    'CompensationMarker': function(p, data, position) {\r\n      var compensationPath = pathMap.getScaledPath('MARKER_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2 + position.compensation) / data.width),\r\n          my: (data.height - 13) / data.height\r\n        }\r\n      });\r\n      drawPath(p, compensationPath, { strokeWidth: 1 });\r\n    },\r\n    'LoopMarker': function(p, data, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_LOOP', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2 + position.loop) / data.width),\r\n          my: (data.height - 7) / data.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'none',\r\n        strokeLinecap: 'round',\r\n        strokeMiterlimit: 0.5\r\n      });\r\n    },\r\n    'AdhocMarker': function(p, data, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_ADHOC', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: data.width,\r\n        containerHeight: data.height,\r\n        position: {\r\n          mx: ((data.width / 2 + position.adhoc) / data.width),\r\n          my: (data.height - 15) / data.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n    }\r\n  };\r\n\r\n  function attachTaskMarkers(p, data, taskMarkers) {\r\n    var obj = getSemantic(data);\r\n\r\n    var subprocess = _.contains(taskMarkers, 'SubProcessMarker');\r\n    var position;\r\n\r\n    if (subprocess) {\r\n      position = {\r\n        seq: -21,\r\n        parallel: -22,\r\n        compensation: -42,\r\n        loop: -18,\r\n        adhoc: 10\r\n      };\r\n    } else {\r\n      position = {\r\n        seq: -3,\r\n        parallel: -6,\r\n        compensation: -27,\r\n        loop: 0,\r\n        adhoc: 10\r\n      };\r\n    }\r\n\r\n    _.forEach(taskMarkers, function(marker) {\r\n      renderer(marker)(p, data, position);\r\n    });\r\n\r\n    if (obj.$type === 'bpmn:AdHocSubProcess') {\r\n      renderer('AdhocMarker')(p, data, position);\r\n    }\r\n    if (obj.loopCharacteristics && obj.loopCharacteristics.isSequential === undefined) {\r\n      renderer('LoopMarker')(p, data, position);\r\n      return;\r\n    }\r\n    if (obj.loopCharacteristics &&\r\n      obj.loopCharacteristics.isSequential !== undefined &&\r\n      !obj.loopCharacteristics.isSequential) {\r\n      renderer('ParallelMarker')(p, data, position);\r\n    }\r\n    if (obj.loopCharacteristics && !!obj.loopCharacteristics.isSequential) {\r\n      renderer('SequentialMarker')(p, data, position);\r\n    }\r\n    if (!!obj.isForCompensation) {\r\n      renderer('CompensationMarker')(p, data, position);\r\n    }\r\n  }\r\n\r\n  function drawShape(parent, data) {\r\n    var type = data.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawShape.apply(this, [ parent, data ]);\r\n    } else {\r\n      return h(parent, data);\r\n    }\r\n  }\r\n\r\n  function drawConnection(parent, data) {\r\n    var type = data.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawConnection.apply(this, [ parent, data ]);\r\n    } else {\r\n      return h(parent, data);\r\n    }\r\n  }\r\n\r\n  function renderDataItemCollection(p, data) {\r\n\r\n    var yPosition = (data.height - 16) / data.height;\r\n\r\n    var pathData = pathMap.getScaledPath('DATA_OBJECT_COLLECTION_PATH', {\r\n      xScaleFactor: 1,\r\n      yScaleFactor: 1,\r\n      containerWidth: data.width,\r\n      containerHeight: data.height,\r\n      position: {\r\n        mx: 0.451,\r\n        my: yPosition\r\n      }\r\n    });\r\n\r\n    var collectionPath = drawPath(p, pathData, {\r\n      strokeWidth: 2\r\n    });\r\n  }\r\n\r\n  function isCollection(element, filter) {\r\n    return element.isCollection ||\r\n           (element.dataObjectRef && element.dataObjectRef.isCollection);\r\n  }\r\n\r\n  function getDi(element) {\r\n    return bpmnRegistry.getDi(_.isString(element) ? element : element.id);\r\n  }\r\n\r\n  function getSemantic(element) {\r\n    return bpmnRegistry.getSemantic(_.isString(element) ? element : element.id);\r\n  }\r\n\r\n  /**\r\n   * Checks if eventDefinition of the given element matches with semantic type.\r\n   *\r\n   * @return {boolean} true if element is of the given semantic type\r\n   */\r\n  function isTypedEvent(event, eventDefinitionType, filter) {\r\n\r\n    function matches(definition, filter) {\r\n      return _.all(filter, function(val, key) {\r\n\r\n        // we want a == conversion here, to be able to catch\r\n        // undefined == false and friends\r\n        /* jshint -W116 */\r\n        return definition[key] == val;\r\n      });\r\n    }\r\n\r\n    return _.any(event.eventDefinitions, function(definition) {\r\n      return definition.$type === eventDefinitionType && matches(event, filter);\r\n    });\r\n  }\r\n\r\n  function isThrowEvent(event) {\r\n    return (event.$type === 'bpmn:IntermediateThrowEvent') || (event.$type === 'bpmn:EndEvent');\r\n  }\r\n\r\n  // hook onto canvas init event to initialize\r\n  // connection start/end markers on paper\r\n  events.on('canvas.init', function(event) {\r\n    var paper = event.paper;\r\n\r\n    initMarkers(paper);\r\n  });\r\n\r\n  this.drawShape = drawShape;\r\n  this.drawConnection = drawConnection;\r\n}\r\n\r\nBpmnRenderer.prototype = Object.create(DefaultRenderer.prototype);\r\n\r\n\r\nBpmnRenderer.$inject = [ 'eventBus', 'styles', 'bpmnRegistry', 'pathMap' ];\r\n\r\nmodule.exports = BpmnRenderer;\n},{\"../util/Di\":13,\"diagram-js/lib/draw/Renderer\":45,\"diagram-js/lib/util/LabelUtil\":58}],9:[function(require,module,exports){\n'use strict';\r\n\r\n/**\r\n * Map containing SVG paths needed by BpmnRenderer.\r\n */\r\n\r\nfunction PathMap(Snap) {\r\n\r\n  /**\r\n   * Contains a map of path elements\r\n   *\r\n   * <h1>Path definition</h1>\r\n   * A parameterized path is defined like this:\r\n   * <pre>\r\n   * 'GATEWAY_PARALLEL': {\r\n   *   d: 'm {mx},{my} {e.x0},0 0,{e.x1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n          '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n   *   height: 17.5,\r\n   *   width:  17.5,\r\n   *   heightElements: [2.5, 7.5],\r\n   *   widthElements: [2.5, 7.5]\r\n   * }\r\n   * </pre>\r\n   * <p>It's important to specify a correct <b>height and width</b> for the path as the scaling\r\n   * is based on the ratio between the specified height and width in this object and the\r\n   * height and width that is set as scale target (Note x,y coordinates will be scaled with\r\n   * individual ratios).</p>\r\n   * <p>The '<b>heightElements</b>' and '<b>widthElements</b>' array must contain the values that will be scaled.\r\n   * The scaling is based on the computed ratios.\r\n   * Coordinates on the y axis should be in the <b>heightElement</b>'s array, they will be scaled using\r\n   * the computed ratio coefficient.\r\n   * In the parameterized path the scaled values can be accessed through the 'e' object in {} brackets.\r\n   *   <ul>\r\n   *    <li>The values for the y axis can be accessed in the path string using {e.y0}, {e.y1}, ....</li>\r\n   *    <li>The values for the x axis can be accessed in the path string using {e.x0}, {e.x1}, ....</li>\r\n   *   </ul>\r\n   *   The numbers x0, x1 respectively y0, y1, ... map to the corresponding array index.\r\n   * </p>\r\n   */\r\n  this.pathMap = {\r\n    'EVENT_MESSAGE': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'EVENT_SIGNAL': {\r\n      d: 'M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [18],\r\n      widthElements: [10, 20]\r\n    },\r\n    'EVENT_ESCALATION': {\r\n      d: 'm {mx},{my} c -{e.x1},{e.y0} -{e.x3},{e.y1} -{e.x5},{e.y4} {e.x1},-{e.y3} {e.x3},-{e.y5} {e.x5},-{e.y6} ' +\r\n        '{e.x0},{e.y3} {e.x2},{e.y5} {e.x4},{e.y6} -{e.x0},-{e.y0} -{e.x2},-{e.y1} -{e.x4},-{e.y4} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [2.382, 4.764, 4.926, 6.589333, 7.146, 13.178667, 19.768],\r\n      widthElements: [2.463, 2.808, 4.926, 5.616, 7.389, 8.424]\r\n    },\r\n    'EVENT_CONDITIONAL': {\r\n      d: 'M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z ' +\r\n         'M {e.x2},{e.y3} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y4} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y5} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y6} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y7} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y8} l {e.x0},0 ',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [8.5, 14.5, 18, 11.5, 14.5, 17.5, 20.5, 23.5, 26.5],\r\n      widthElements:  [10.5, 14.5, 12.5]\r\n    },\r\n    'EVENT_LINK': {\r\n      d: 'm {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.4375, 6.75, 7.8125],\r\n      widthElements: [9.84375, 13.5]\r\n    },\r\n    'EVENT_ERROR': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [0.023, 8.737, 8.151, 16.564, 10.591, 8.714],\r\n      widthElements: [0.085, 6.672, 6.97, 4.273, 5.337, 6.636]\r\n    },\r\n    'EVENT_CANCEL_45': {\r\n      d: 'm {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.75, 8.5],\r\n      widthElements: [4.75, 8.5]\r\n    },\r\n    'EVENT_COMPENSATION': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x0},0 {e.x0},-{e.y0} 0,{e.y1} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [5, 10],\r\n      widthElements: [10]\r\n    },\r\n    'EVENT_TIMER_WH': {\r\n      d: 'M {mx},{my} m -{e.x1},-{e.y1} l {e.x1},{e.y1} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [3.5,4],\r\n      widthElements: [8.75,10.5]\r\n    },\r\n    'EVENT_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6.28099, 12.56199],\r\n      widthElements: [3.1405, 9.42149, 12.56198]\r\n    },\r\n    'EVENT_PARALLEL_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n        '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [2.56228, 7.68683],\r\n      widthElements: [2.56228, 7.68683]\r\n    },\r\n    'GATEWAY_EXCLUSIVE': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} ' +\r\n                    '{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} ' +\r\n                    '{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z',\r\n      height: 17.5,\r\n      width:  17.5,\r\n      heightElements: [8.5, 6.5312, -6.5312, -8.5],\r\n      widthElements:  [6.5, -6.5, 3, -3, 5, -5]\r\n    },\r\n    'GATEWAY_PARALLEL': {\r\n      d:'m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 30,\r\n      width:  30,\r\n      heightElements: [5, 12.5],\r\n      widthElements: [5, 12.5]\r\n    },\r\n    'GATEWAY_EVENT_BASED': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z',\r\n      height: 11,\r\n      width:  11,\r\n      heightElements: [-6, 6, 12, -12],\r\n      widthElements: [9, -3, -12]\r\n    },\r\n    'GATEWAY_COMPLEX': {\r\n      d:'m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} ' +\r\n        '{e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} ' +\r\n        '{e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} ' +\r\n        '-{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z',\r\n      height: 17.125,\r\n      width:  17.125,\r\n      heightElements: [4.875, 3.4375, 2.125, 3],\r\n      widthElements: [3.4375, 2.125, 4.875, 3]\r\n    },\r\n    'DATA_OBJECT_PATH': {\r\n      d:'m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [10, 50, 60],\r\n      widthElements: [10, 40, 50, 60]\r\n    },\r\n    'DATA_OBJECT_COLLECTION_PATH': {\r\n      d:'m {mx}, {my} ' +\r\n        'm  0 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [12],\r\n      widthElements: [1, 6, 12, 15]\r\n    },\r\n    'DATA_ARROW': {\r\n      d:'m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'DATA_STORE': {\r\n      d:'m  {mx},{my} ' +\r\n        'l  0,{e.y2} ' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'l  0,-{e.y2} ' +\r\n        'c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'm  0,{e.y0}' +\r\n        'c -{e.x0},{e.y1} -{e.x1},{e.y1} -{e.x2},0' +\r\n        'm  0,{e.y0}' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0',\r\n      height: 61,\r\n      width:  61,\r\n      heightElements: [7, 10, 45],\r\n      widthElements:  [2, 58, 60]\r\n    },\r\n    'TEXT_ANNOTATION': {\r\n      d: 'm {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',\r\n      height: 30,\r\n      width: 10,\r\n      heightElements: [30],\r\n      widthElements: [10]\r\n    },\r\n    'MARKER_SUB_PROCESS': {\r\n      d: 'm{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_PARALLEL': {\r\n      d: 'm{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_SEQUENTIAL': {\r\n      d: 'm{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_COMPENSATION': {\r\n      d: 'm {mx},{my} 8,-5 0,10 z m 9,0 8,-5 0,10 z',\r\n      height: 10,\r\n      width: 21,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_LOOP': {\r\n      d: 'm {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 ' +\r\n        '-6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 ' +\r\n        '0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 ' +\r\n        'l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902',\r\n      height: 13.9,\r\n      width: 13.7,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_ADHOC': {\r\n      d: 'm {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 ' +\r\n        '3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 ' +\r\n        '1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 ' +\r\n        '-3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 ' +\r\n        '-2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z',\r\n      height: 4,\r\n      width: 15,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'TASK_TYPE_SEND': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 14,\r\n      width:  21,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_SCRIPT': {\r\n      d: 'm {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 ' +\r\n        'c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z ' +\r\n        'm -7,-12 l 5,0 ' +\r\n        'm -4.5,3 l 4.5,0 ' +\r\n        'm -3,3 l 5,0' +\r\n        'm -4,3 l 5,0',\r\n      height: 15,\r\n      width:  12.6,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_USER_1': {\r\n      d: 'm {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 ' +\r\n        '-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 ' +\r\n        '0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 ' +\r\n        'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z' +\r\n        'm -8,6 l 0,5.5 m 11,0 l 0,-5'\r\n    },\r\n    'TASK_TYPE_USER_2': {\r\n      d: 'm {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 ' +\r\n        '-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 '\r\n    },\r\n    'TASK_TYPE_USER_3': {\r\n      d: 'm {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 ' +\r\n        '4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 ' +\r\n        '-4.20799998,3.36699999 -4.20699998,4.34799999 z'\r\n    },\r\n    'TASK_TYPE_MANUAL': {\r\n      d: 'm {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 ' +\r\n        '-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 ' +\r\n        '0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 ' +\r\n        '-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 ' +\r\n        '0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 ' +\r\n        '-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 ' +\r\n        '2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 ' +\r\n        '-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 ' +\r\n        '-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 ' +\r\n        '-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 ' +\r\n        '0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 ' +\r\n        '-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z'\r\n    },\r\n    'TASK_TYPE_INSTANTIATING_SEND': {\r\n      d: 'm {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6'\r\n    },\r\n    'TASK_TYPE_SERVICE': {\r\n      d: 'm {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 ' +\r\n        '0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 ' +\r\n        '-1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 ' +\r\n        'v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 ' +\r\n        '-0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 ' +\r\n        '-1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 ' +\r\n        'h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 ' +\r\n        '-0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 ' +\r\n        'c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 ' +\r\n        'l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 ' +\r\n        '0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 ' +\r\n        'c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z ' +\r\n        'm 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_SERVICE_FILL': {\r\n      d: 'm {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_HEADER': {\r\n      d: 'm {mx},{my} 0,4 20,0 0,-4 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_MAIN': {\r\n      d: 'm {mx},{my} 0,12 20,0 0,-12 z' +\r\n        'm 0,8 l 20,0 ' +\r\n        'm -13,-4 l 0,8'\r\n    },\r\n    'MESSAGE_FLOW_MARKER': {\r\n      d: 'm {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6'\r\n    }\r\n  };\r\n\r\n  this.getRawPath = function getRawPath(pathId) {\r\n    return this.pathMap[pathId].d;\r\n  };\r\n\r\n  /**\r\n   * Scales the path to the given height and width.\r\n   * <h1>Use case</h1>\r\n   * <p>Use case is to scale the content of elements (event, gateways) based\r\n   * on the element bounding box's size.\r\n   * </p>\r\n   * <h1>Why not transform</h1>\r\n   * <p>Scaling a path with transform() will also scale the stroke and IE does not support\r\n   * the option 'non-scaling-stroke' to prevent this.\r\n   * Also there are use cases where only some parts of a path should be\r\n   * scaled.</p>\r\n   *\r\n   * @param {String} pathId The ID of the path.\r\n   * @param {Object} param <p>\r\n   *   Example param object scales the path to 60% size of the container (data.width, data.height).\r\n   *   <pre>\r\n   *   {\r\n   *     xScaleFactor: 0.6,\r\n   *     yScaleFactor:0.6,\r\n   *     containerWidth: data.width,\r\n   *     containerHeight: data.height,\r\n   *     position: {\r\n   *       mx: 0.46,\r\n   *       my: 0.2,\r\n   *     }\r\n   *   }\r\n   *   </pre>\r\n   *   <ul>\r\n   *    <li>targetpathwidth = xScaleFactor * containerWidth</li>\r\n   *    <li>targetpathheight = yScaleFactor * containerHeight</li>\r\n   *    <li>Position is used to set the starting coordinate of the path. M is computed:\r\n    *    <ul>\r\n    *      <li>position.x * containerWidth</li>\r\n    *      <li>position.y * containerHeight</li>\r\n    *    </ul>\r\n    *    Center of the container <pre> position: {\r\n   *       mx: 0.5,\r\n   *       my: 0.5,\r\n   *     }</pre>\r\n   *     Upper left corner of the container\r\n   *     <pre> position: {\r\n   *       mx: 0.0,\r\n   *       my: 0.0,\r\n   *     }</pre>\r\n   *    </li>\r\n   *   </ul>\r\n   * </p>\r\n   *\r\n   */\r\n  this.getScaledPath = function getScaledPath(pathId, param) {\r\n    var rawPath = this.pathMap[pathId];\r\n\r\n    // positioning\r\n    // compute the start point of the path\r\n    var mx, my;\r\n\r\n    if(!!param.abspos) {\r\n      mx = param.abspos.x;\r\n      my = param.abspos.y;\r\n    } else {\r\n      mx = param.containerWidth * param.position.mx;\r\n      my = param.containerHeight * param.position.my;\r\n    }\r\n\r\n    var coordinates = {}; //map for the scaled coordinates\r\n    if(param.position) {\r\n\r\n      // path\r\n      var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;\r\n      var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;\r\n\r\n\r\n      //Apply height ratio\r\n      for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {\r\n        coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;\r\n      }\r\n\r\n      //Apply width ratio\r\n      for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {\r\n        coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;\r\n      }\r\n    }\r\n\r\n    //Apply value to raw path\r\n    var path = Snap.format(\r\n      rawPath.d, {\r\n        mx: mx,\r\n        my: my,\r\n        e: coordinates\r\n      }\r\n    );\r\n    return path;\r\n  };\r\n}\r\n\r\n\r\nPathMap.$inject = [ 'snap' ];\r\n\r\nmodule.exports = PathMap;\n},{}],10:[function(require,module,exports){\nmodule.exports = {\r\n  renderer: [ 'type', require('./BpmnRenderer') ],\r\n  pathMap: [ 'type', require('./PathMap') ]\r\n};\n},{\"./BpmnRenderer\":8,\"./PathMap\":9}],11:[function(require,module,exports){\nvar _ = (window._);\r\n\r\nfunction BpmnTraverser(handler) {\r\n\r\n  var elementDiMap = {};\r\n  var elementGfxMap = {};\r\n\r\n  // list of containers already walked\r\n  var handledProcesses = [];\r\n\r\n  ///// Helpers /////////////////////////////////\r\n\r\n  function contextual(fn, ctx) {\r\n    return function(e) {\r\n      fn(e, ctx);\r\n    };\r\n  }\r\n\r\n  function is(element, type) {\r\n    return element.$instanceOf(type);\r\n  }\r\n\r\n  function visit(element, di, ctx) {\r\n\r\n    var gfx = elementGfxMap[element.id];\r\n\r\n    // avoid multiple rendering of elements\r\n    if (gfx) {\r\n      return gfx;\r\n    }\r\n\r\n    // call handler\r\n    gfx = handler.element(element, di, ctx);\r\n\r\n    // and log returned result\r\n    elementGfxMap[element.id] = gfx;\r\n\r\n    return gfx;\r\n  }\r\n\r\n  function visitIfDi(element, ctx) {\r\n    var di = getDi(element);\r\n\r\n    if (di) {\r\n      return visit(element, di, ctx);\r\n    }\r\n  }\r\n\r\n  function logError(message, context) {\r\n    handler.error(message, context);\r\n  }\r\n\r\n  ////// DI handling ////////////////////////////\r\n\r\n  function buildDiMap(definitions) {\r\n    _.forEach(definitions.diagrams, handleDiagram);\r\n  }\r\n\r\n  function registerDi(element) {\r\n    var bpmnElement = element.bpmnElement;\r\n    if (bpmnElement) {\r\n      elementDiMap[bpmnElement.id] = element;\r\n    } else {\r\n      logError('no bpmnElement for <' + element.$type + '#' + element.id + '>', { element: element });\r\n    }\r\n  }\r\n\r\n  function getDi(bpmnElement) {\r\n    var id = bpmnElement.id;\r\n    return id ? elementDiMap[id] : null;\r\n  }\r\n\r\n  function handleDiagram(diagram) {\r\n    handlePlane(diagram.plane);\r\n  }\r\n\r\n  function handlePlane(plane) {\r\n    registerDi(plane);\r\n\r\n    _.forEach(plane.planeElement, handlePlaneElement);\r\n  }\r\n\r\n  function handlePlaneElement(planeElement) {\r\n    registerDi(planeElement);\r\n  }\r\n\r\n\r\n  ////// Semantic handling //////////////////////\r\n\r\n  function handleDefinitions(definitions, diagram) {\r\n    // make sure we walk the correct bpmnElement\r\n\r\n    var diagrams = definitions.diagrams;\r\n\r\n    if (diagram && diagrams.indexOf(diagram) === -1) {\r\n      throw new Error('diagram not part of bpmn:Definitions');\r\n    }\r\n\r\n    if (!diagram) {\r\n      if (diagrams && diagrams.length) {\r\n        diagram = diagrams[0];\r\n      }\r\n    }\r\n\r\n    // no diagram -> nothing to import\r\n    if (!diagram) {\r\n      return;\r\n    }\r\n\r\n    // load DI from selected diagram only\r\n    handleDiagram(diagram);\r\n\r\n    var rootElement = diagram.plane.bpmnElement;\r\n\r\n    if (!rootElement) {\r\n      throw new Error('no rootElement referenced in BPMNPlane <' + diagram.plane.id + '>');\r\n    }\r\n\r\n    if (is(rootElement, 'bpmn:Process')) {\r\n      handleProcess(rootElement);\r\n    } else\r\n    if (is(rootElement, 'bpmn:Collaboration')) {\r\n      handleCollaboration(rootElement);\r\n\r\n      // force drawing of everything not yet drawn that is part of the target DI\r\n      handleUnhandledProcesses(definitions.rootElements);\r\n    } else {\r\n      throw new Error('unsupported root element for bpmndi:Diagram <' + rootElement.$type + '>');\r\n    }\r\n  }\r\n\r\n  function handleUnhandledProcesses(rootElements) {\r\n\r\n    // walk through all processes that have not yet been drawn and draw them\r\n    // (in case they contain lanes with DI information)\r\n    var processes = _.forEach(rootElements, function(e) {\r\n      return e.$type === 'bpmn:Process' && e.laneSets && handledProcesses.indexOf(e) !== -1;\r\n    });\r\n\r\n    processes.forEach(contextual(handleProcess));\r\n  }\r\n\r\n  function handleDataAssociation(association, context) {\r\n    visitIfDi(association, context);\r\n  }\r\n\r\n  function handleDataInput(dataInput, context) {\r\n    visitIfDi(dataInput, context);\r\n  }\r\n\r\n  function handleDataOutput(dataOutput, context) {\r\n    visitIfDi(dataOutput, context);\r\n  }\r\n\r\n  function handleArtifact(artifact, context) {\r\n\r\n    // bpmn:TextAnnotation\r\n    // bpmn:Group\r\n    // bpmn:Association\r\n\r\n    visitIfDi(artifact, context);\r\n  }\r\n\r\n  function handleArtifacts(artifacts, context) {\r\n    _.forEach(artifacts, contextual(handleArtifact, context));\r\n  }\r\n\r\n  function handleIoSpecification(ioSpecification, context) {\r\n\r\n    if (!ioSpecification) {\r\n      return;\r\n    }\r\n\r\n    _.forEach(ioSpecification.dataInputs, contextual(handleDataInput, context));\r\n    _.forEach(ioSpecification.dataOutputs, contextual(handleDataOutput, context));\r\n  }\r\n\r\n  function handleSubProcess(subProcess, context) {\r\n    handleFlowElementsContainer(subProcess, context);\r\n    handleArtifacts(subProcess.artifacts, context);\r\n  }\r\n\r\n  function handleFlowNode(flowNode, context) {\r\n    var childCtx = visitIfDi(flowNode, context);\r\n\r\n    if (is(flowNode, 'bpmn:SubProcess')) {\r\n      handleSubProcess(flowNode, childCtx || context);\r\n    }\r\n\r\n    if (is(flowNode, 'bpmn:Activity')) {\r\n      _.forEach(flowNode.dataInputAssociations, contextual(handleDataAssociation, null));\r\n      _.forEach(flowNode.dataOutputAssociations, contextual(handleDataAssociation, null));\r\n\r\n      handleIoSpecification(flowNode.ioSpecification, context);\r\n    }\r\n  }\r\n\r\n  function handleSequenceFlow(sequenceFlow, context) {\r\n    visitIfDi(sequenceFlow, context);\r\n  }\r\n\r\n  function handleDataElement(dataObject, context) {\r\n    visitIfDi(dataObject, context);\r\n  }\r\n\r\n  function handleLane(lane, context) {\r\n    var newContext = visitIfDi(lane, context);\r\n\r\n    if (lane.childLaneSet) {\r\n      handleLaneSet(lane.childLaneSet, newContext || context);\r\n    } else {\r\n      handleFlowElements(lane.flowNodeRef, newContext || context);\r\n    }\r\n  }\r\n\r\n  function handleLaneSet(laneSet, context) {\r\n    _.forEach(laneSet.lanes, contextual(handleLane, context));\r\n  }\r\n\r\n  function handleLaneSets(laneSets, context) {\r\n    _.forEach(laneSets, contextual(handleLaneSet, context));\r\n  }\r\n\r\n  function handleFlowElementsContainer(container, context) {\r\n\r\n    if (container.laneSets) {\r\n      handleLaneSets(container.laneSets, context);\r\n      handleNonFlowNodes(container.flowElements);\r\n    } else {\r\n      handleFlowElements(container.flowElements, context);\r\n    }\r\n  }\r\n\r\n  function handleNonFlowNodes(flowElements, context) {\r\n    var sequenceFlows = [];\r\n\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        sequenceFlows.push(e);\r\n      } else\r\n      if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else\r\n      if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else\r\n      if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      }\r\n    });\r\n\r\n    // handle SequenceFlows\r\n    _.forEach(sequenceFlows, contextual(handleSequenceFlow, context));\r\n  }\r\n\r\n  function handleFlowElements(flowElements, context) {\r\n    var sequenceFlows = [];\r\n\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        sequenceFlows.push(e);\r\n      } else\r\n      if (is(e, 'bpmn:FlowNode')) {\r\n        handleFlowNode(e, context);\r\n      } else\r\n      if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else\r\n      if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else\r\n      if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      } else {\r\n        throw new Error('unrecognized element <' + e.$type + '> in context ' + (context ? context.id : null));\r\n      }\r\n    });\r\n\r\n    // handle SequenceFlows\r\n    _.forEach(sequenceFlows, contextual(handleSequenceFlow, context));\r\n  }\r\n\r\n  function handleParticipant(participant, context) {\r\n    var newCtx = visitIfDi(participant, context);\r\n\r\n    var process = participant.processRef;\r\n    if (process) {\r\n      handleProcess(process, newCtx || context);\r\n    }\r\n  }\r\n\r\n  function handleProcess(process, context) {\r\n    handleFlowElementsContainer(process, context);\r\n    handleIoSpecification(process.ioSpecification, context);\r\n\r\n    handleArtifacts(process.artifacts, context);\r\n\r\n    // log process handled\r\n    handledProcesses.push(process);\r\n  }\r\n\r\n  function handleMessageFlow(messageFlow, context) {\r\n    visitIfDi(messageFlow, context);\r\n  }\r\n\r\n  function handleMessageFlows(messageFlows, context) {\r\n    if (messageFlows) {\r\n      _.forEach(messageFlows, contextual(handleMessageFlow, context));\r\n    }\r\n  }\r\n\r\n  function handleCollaboration(collaboration) {\r\n\r\n    _.forEach(collaboration.participants, contextual(handleParticipant));\r\n\r\n    handleArtifacts(collaboration.artifacts);\r\n\r\n    handleMessageFlows(collaboration.messageFlows);\r\n  }\r\n\r\n\r\n  ///// API ////////////////////////////////\r\n\r\n  return {\r\n    handleDefinitions: handleDefinitions\r\n  };\r\n}\r\n\r\nmodule.exports = BpmnTraverser;\n},{}],12:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar BpmnTreeWalker = require('./BpmnTreeWalker'),\r\n    Util = require('../Util');\r\n\r\n\r\nfunction hasLabel(element) {\r\n\r\n  return element.$instanceOf('bpmn:Event') ||\r\n         element.$instanceOf('bpmn:Gateway') ||\r\n         element.$instanceOf('bpmn:DataStoreReference') ||\r\n         element.$instanceOf('bpmn:DataObjectReference') ||\r\n         element.$instanceOf('bpmn:SequenceFlow') ||\r\n         element.$instanceOf('bpmn:MessageFlow');\r\n}\r\n\r\n\r\nfunction isCollapsed(element, di) {\r\n  return element.$instanceOf('bpmn:SubProcess') && di && !di.isExpanded;\r\n}\r\n\r\nfunction getWaypointsMid(waypoints) {\r\n\r\n  var mid = waypoints.length / 2 - 1;\r\n\r\n  var first = waypoints[Math.floor(mid)];\r\n  var second = waypoints[Math.ceil(mid + 0.01)];\r\n\r\n  return {\r\n    x: first.x + (second.x - first.x) / 2,\r\n    y: first.y + (second.y - first.y) / 2\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * Returns the bounds of an elements label, parsed from the elements DI or\r\n * generated from its bounds.\r\n */\r\nfunction getLabelBounds(di, data) {\r\n\r\n  var mid,\r\n      size;\r\n\r\n  var label = di.label;\r\n  if (label && label.bounds) {\r\n    var bounds = label.bounds;\r\n\r\n    size = {\r\n      width: Math.max(150, bounds.width),\r\n      height: bounds.height\r\n    };\r\n\r\n    mid = {\r\n      x: bounds.x + bounds.width / 2,\r\n      y: bounds.y\r\n    };\r\n  } else {\r\n\r\n    if (data.waypoints) {\r\n      mid = getWaypointsMid(data.waypoints);\r\n    } else {\r\n      mid = {\r\n        x: data.x + data.width / 2,\r\n        y: data.y + data.height - 5\r\n      };\r\n    }\r\n\r\n    size = {\r\n      width: 90,\r\n      height: 50\r\n    };\r\n  }\r\n\r\n  return _.extend({\r\n    x: mid.x - size.width / 2,\r\n    y: mid.y\r\n  }, size);\r\n}\r\n\r\n\r\nfunction importBpmnDiagram(diagram, definitions, done) {\r\n\r\n  var canvas = diagram.get('canvas');\r\n  var events = diagram.get('eventBus');\r\n  var commandStack = diagram.get('commandStack');\r\n\r\n\r\n  function addLabel(element, di, data) {\r\n    if (!hasLabel(element)) {\r\n      return;\r\n    }\r\n\r\n    var labelBounds = getLabelBounds(di, data);\r\n\r\n    var label = _.extend({\r\n      id: element.id + '_label',\r\n      attachedId: element.id,\r\n      type: 'label',\r\n      hidden: data.hidden\r\n    }, labelBounds);\r\n\r\n    canvas.addShape(label);\r\n\r\n    // we wire data and label so that\r\n    // the label of a BPMN element can be quickly accessed via\r\n    // element.label in various components\r\n    data.label = label;\r\n  }\r\n\r\n\r\n  var visitor = {\r\n\r\n    element: function(element, di, parent) {\r\n\r\n      var shape;\r\n\r\n      function fire(type, shape) {\r\n        events.fire('bpmn.element.' + type, {\r\n          semantic: element, di: di, diagramElement: shape\r\n        });\r\n      }\r\n\r\n      if (di.$type === 'bpmndi:BPMNShape') {\r\n        var bounds = di.bounds;\r\n\r\n        var collapsed = isCollapsed(element, di);\r\n        var hidden = parent && (parent.hidden || parent.collapsed);\r\n\r\n        shape = {\r\n          id: element.id, type: element.$type,\r\n          x: bounds.x, y: bounds.y,\r\n          width: bounds.width, height: bounds.height,\r\n          collapsed: collapsed,\r\n          hidden: hidden,\r\n          parent: parent\r\n        };\r\n\r\n        fire('add', shape);\r\n        canvas.addShape(shape);\r\n      } else {\r\n\r\n        var waypoints = _.collect(di.waypoint, function(p) {\r\n          return { x: p.x, y: p.y };\r\n        });\r\n\r\n        shape = { id: element.id, type: element.$type, waypoints: waypoints };\r\n\r\n        fire('add', shape);\r\n        canvas.addConnection(shape);\r\n      }\r\n\r\n      fire('added', shape);\r\n\r\n      // add label if needed\r\n      addLabel(element, di, shape);\r\n\r\n      return shape;\r\n    },\r\n\r\n    error: function(message, context) {\r\n      console.warn('[import]', message, context);\r\n    }\r\n  };\r\n\r\n  var walker = new BpmnTreeWalker(visitor);\r\n  walker.handleDefinitions(definitions);\r\n\r\n  commandStack.clear();\r\n\r\n  done();\r\n}\r\n\r\nmodule.exports.importBpmnDiagram = Util.failSafeAsync(importBpmnDiagram);\n},{\"../Util\":3,\"./BpmnTreeWalker\":11}],13:[function(require,module,exports){\n'use strict';\r\n\r\nfunction isExpandedPool(semantic) {\r\n  return !!semantic.processRef;\r\n}\r\n\r\nfunction isExpanded(semantic, di) {\r\n  return di.isExpanded;\r\n}\r\n\r\nmodule.exports.isExpandedPool = isExpandedPool;\r\nmodule.exports.isExpanded = isExpanded;\n},{}],\"UqDJNG\":[function(require,module,exports){\nmodule.exports = require('./lib/model/Simple');\n},{\"./lib/model/Simple\":17}],\"bpmn-moddle\":[function(require,module,exports){\nmodule.exports=require('UqDJNG');\n},{}],16:[function(require,module,exports){\nvar _ = (window._);\r\n\r\nvar Moddle = require('moddle'),\r\n    xml = require('moddle-xml');\r\n\r\n\r\nfunction createModel(packages) {\r\n  return new Moddle(packages);\r\n}\r\n\r\n/**\r\n * @class Bpmn\r\n *\r\n * A wrapper around {@link Moddle} with support for import and export of BPMN 2.0 xml files.\r\n *\r\n * @param {Object|Array} packages to use for instantiating the model\r\n */\r\nfunction Bpmn(packages) {\r\n\r\n  var model = createModel(packages);\r\n\r\n  /**\r\n   * Instantiates a BPMN model tree from a given xml string.\r\n   *\r\n   * @method Bpmn#fromXML\r\n   *\r\n   * @param  {String}   xmlStr\r\n   * @param  {String}   [typeName] name of the root element, defaults to 'bpmn:Definitions'\r\n   * @param  {Object}   [options] options to pass to the underlying reader\r\n   * @param  {Function} callback callback that is invoked with (err, result, parseContext) once the import completes\r\n   */\r\n  function fromXML(xmlStr, typeName, options, callback) {\r\n\r\n    if (!_.isString(typeName)) {\r\n      callback = options;\r\n      options = typeName;\r\n      typeName = 'bpmn:Definitions';\r\n    }\r\n\r\n    if (_.isFunction(options)) {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    var reader = new xml.Reader(model, options);\r\n    var rootHandler = reader.handler(typeName);\r\n\r\n    reader.fromXML(xmlStr, rootHandler, function(err, result) {\r\n      callback(err, result, rootHandler.context);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Serializes a BPMN 2.0 object tree to XML.\r\n   *\r\n   * @method Bpmn#toXML\r\n   *\r\n   * @param  {String}   element the root element, typically an instance of `bpmn:Definitions`\r\n   * @param  {Object}   [options] to pass to the underlying writer\r\n   * @param  {Function} callback invoked with (err, xmlStr) once the import completes\r\n   */\r\n  function toXML(element, options, callback) {\r\n\r\n    if (_.isFunction(options)) {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    var writer = new xml.Writer(options);\r\n    try {\r\n      var result = writer.toXML(element);\r\n      callback(null, result);\r\n    } catch (e) {\r\n      callback(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the underlying moddle instance.\r\n   *\r\n   * @method  Bpmn#instance\r\n   *\r\n   * @return {Moddle}\r\n   */\r\n  function instance() {\r\n    return model;\r\n  }\r\n\r\n\r\n  // API\r\n  this.instance = instance;\r\n\r\n  this.fromXML = fromXML;\r\n  this.toXML = toXML;\r\n}\r\n\r\n\r\nmodule.exports = Bpmn;\n},{\"moddle\":27,\"moddle-xml\":18}],17:[function(require,module,exports){\nvar BpmnModdle = require('../Bpmn');\r\n\r\nvar packages = {\r\n  bpmn: require('../../resources/bpmn/json/bpmn.json'),\r\n  bpmndi: require('../../resources/bpmn/json/bpmndi.json'),\r\n  dc: require('../../resources/bpmn/json/dc.json'),\r\n  di: require('../../resources/bpmn/json/di.json')\r\n};\r\n\r\nmodule.exports = new BpmnModdle(packages);\n},{\"../../resources/bpmn/json/bpmn.json\":31,\"../../resources/bpmn/json/bpmndi.json\":32,\"../../resources/bpmn/json/dc.json\":33,\"../../resources/bpmn/json/di.json\":34,\"../Bpmn\":16}],18:[function(require,module,exports){\n'use strict';\r\n\r\nvar Reader = require('./lib/Reader'),\r\n    Writer = require('./lib/Writer');\r\n\r\nmodule.exports.Reader = Reader;\r\nmodule.exports.Writer = Writer;\n},{\"./lib/Reader\":19,\"./lib/Writer\":20}],19:[function(require,module,exports){\n'use strict';\r\n\r\nvar sax = (window.sax),\r\n    _ = (window._);\r\n\r\nvar common = require('./common'),\r\n    util = require('moddle/lib/util'),\r\n    Stack = require('tiny-stack'),\r\n\r\n    logger = util.logger,\r\n\r\n    parseNameNs = util.parseNameNs,\r\n    coerceType = util.coerceType,\r\n    isSimpleType = util.isSimpleType,\r\n    aliasToName = common.aliasToName;\r\n\r\n\r\nfunction parseNodeAttributes(node) {\r\n  var nodeAttrs = node.attributes;\r\n\r\n  return _.reduce(nodeAttrs, function(result, v, k) {\r\n    var name, ns;\r\n\r\n    if (!v.local) {\r\n      name = v.prefix;\r\n    } else {\r\n      ns = parseNameNs(v.name, v.prefix);\r\n      name = ns.name;\r\n    }\r\n\r\n    result[name] = v.value;\r\n    return result;\r\n  }, {});\r\n}\r\n\r\n/**\r\n * Normalizes namespaces for a node given an optional default namespace and a\r\n * number of mappings from uris to default prefixes.\r\n *\r\n * @param  {XmlNode} node\r\n * @param  {Model} model the model containing all registered namespaces\r\n * @param  {Uri} defaultNsUri\r\n */\r\nfunction normalizeNamespaces(node, model, defaultNsUri) {\r\n  var uri, childUri, prefix;\r\n\r\n  uri = node.uri || defaultNsUri;\r\n\r\n  if (uri) {\r\n    var pkg = model.getPackage(uri);\r\n\r\n    if (pkg) {\r\n      prefix = pkg.prefix;\r\n    } else {\r\n      prefix = node.prefix;\r\n    }\r\n\r\n    node.prefix = prefix;\r\n    node.uri = uri;\r\n  }\r\n\r\n  _.forEach(node.attributes, function(attr) {\r\n    normalizeNamespaces(attr, model, null);\r\n  });\r\n}\r\n\r\n/**\r\n * A parse context.\r\n *\r\n * @class\r\n *\r\n * @param {ElementHandler} parseRoot the root handler for parsing a document\r\n */\r\nfunction Context(parseRoot) {\r\n\r\n  var elementsById = {};\r\n  var references = [];\r\n\r\n  var warnings = [];\r\n\r\n  this.addReference = function(reference) {\r\n    references.push(reference);\r\n  };\r\n\r\n  this.addElement = function(id, element) {\r\n\r\n    if (!id || !element) {\r\n      throw new Error('[xml-reader] id or ctx must not be null');\r\n    }\r\n\r\n    elementsById[id] = element;\r\n  };\r\n\r\n  this.addWarning = function (w) {\r\n    logger.debug('[warning]', w.message, w);\r\n    warnings.push(w);\r\n  };\r\n\r\n  this.warnings = warnings;\r\n  this.references = references;\r\n\r\n  this.elementsById = elementsById;\r\n\r\n  this.parseRoot = parseRoot;\r\n}\r\n\r\n\r\nfunction BaseHandler() {}\r\n\r\nBaseHandler.prototype.handleEnd = function() {};\r\nBaseHandler.prototype.handleText = function() {};\r\nBaseHandler.prototype.handleNode = function() {};\r\nBaseHandler.prototype.getElement = function() {\r\n  return this.element;\r\n};\r\n\r\nfunction BodyHandler() {}\r\n\r\nBodyHandler.prototype = new BaseHandler();\r\n\r\nBodyHandler.prototype.handleText = function(text) {\r\n  this.body = (this.body || '') + text;\r\n};\r\n\r\nfunction ReferenceHandler(property, context) {\r\n  this.property = property;\r\n  this.context = context;\r\n}\r\n\r\nReferenceHandler.prototype = new BodyHandler();\r\n\r\nReferenceHandler.prototype.handleNode = function(node) {\r\n\r\n  if (this.element) {\r\n    throw new Error('expected no sub nodes');\r\n  } else {\r\n    this.element = this.createReference(node);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nReferenceHandler.prototype.handleEnd = function() {\r\n  this.element.id = this.body;\r\n};\r\n\r\nReferenceHandler.prototype.createReference = function() {\r\n  return {\r\n    property: this.property.ns.name,\r\n    id: ''\r\n  };\r\n};\r\n\r\nfunction ValueHandler(propertyDesc, element) {\r\n  this.element = element;\r\n  this.propertyDesc = propertyDesc;\r\n}\r\n\r\nValueHandler.prototype = new BodyHandler();\r\n\r\nValueHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      propertyDesc = this.propertyDesc;\r\n\r\n  value = coerceType(propertyDesc.type, value);\r\n\r\n  if (propertyDesc.isMany) {\r\n    element.get(propertyDesc.name).push(value);\r\n  } else {\r\n    element.set(propertyDesc.name, value);\r\n  }\r\n};\r\n\r\n\r\nfunction BaseElementHandler(model, type, context) {\r\n\r\n}\r\n\r\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\r\n\r\nBaseElementHandler.prototype.handleNode = function(node) {\r\n  var parser = this;\r\n\r\n  if (!this.element) {\r\n    this.element = this.createElement(node);\r\n    var id = this.element.id;\r\n\r\n    if (id) {\r\n      this.context.addElement(id, this.element);\r\n    }\r\n  } else {\r\n    parser = this.handleChild(node);\r\n  }\r\n\r\n  return parser;\r\n};\r\n\r\n/**\r\n * @class XMLReader.ElementHandler\r\n *\r\n */\r\nfunction ElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.type = model.getType(type);\r\n  this.context = context;\r\n}\r\n\r\nElementHandler.prototype = new BaseElementHandler();\r\n\r\nElementHandler.prototype.addReference = function(reference) {\r\n  this.context.addReference(reference);\r\n};\r\n\r\nElementHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      descriptor = element.$descriptor,\r\n      bodyProperty = descriptor.bodyProperty;\r\n\r\n  if (bodyProperty && value !== undefined) {\r\n    value = coerceType(bodyProperty.type, value);\r\n    element.set(bodyProperty.name, value);\r\n  }\r\n};\r\n\r\n/**\r\n * Create an instance of the model from the given node.\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.createElement = function(node) {\r\n  var attributes = parseNodeAttributes(node),\r\n      Type = this.type,\r\n      descriptor = Type.$descriptor,\r\n      context = this.context,\r\n      instance = new Type({});\r\n\r\n  _.forEach(attributes, function(value, name) {\r\n\r\n    var prop = descriptor.propertiesByName[name];\r\n\r\n    if (prop && prop.isReference) {\r\n      context.addReference({\r\n        element: instance,\r\n        property: prop.ns.name,\r\n        id: value\r\n      });\r\n    } else {\r\n      if (prop) {\r\n        value = coerceType(prop.type, value);\r\n      }\r\n\r\n      instance.set(name, value);\r\n    }\r\n  });\r\n\r\n  return instance;\r\n};\r\n\r\nElementHandler.prototype.getPropertyForElement = function(nameNs) {\r\n  if (_.isString(nameNs)) {\r\n    nameNs = parseNameNs(nameNs);\r\n  }\r\n\r\n  var type = this.type,\r\n      model = this.model,\r\n      descriptor = type.$descriptor;\r\n\r\n  var propertyName = nameNs.name;\r\n\r\n  var property = descriptor.propertiesByName[propertyName];\r\n\r\n  // search for properties by name first\r\n  if (property) {\r\n    return property;\r\n  }\r\n\r\n  var pkg = model.getPackage(nameNs.prefix);\r\n\r\n  if (pkg) {\r\n    var typeName = nameNs.prefix + ':' + aliasToName(nameNs.localName, descriptor.$pkg),\r\n        elementType = model.getType(typeName);\r\n\r\n    // search for collection members later\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.isA(p.type);\r\n    });\r\n\r\n    if (property) {\r\n      return _.extend({}, property, { effectiveType: elementType.$descriptor.name });\r\n    }\r\n  } else {\r\n    // parse unknown element (maybe extension)\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\r\n    });\r\n\r\n    if (property) {\r\n      return property;\r\n    }\r\n  }\r\n\r\n  throw new Error('unrecognized element <' + nameNs.name + '>');\r\n};\r\n\r\nElementHandler.prototype.toString = function() {\r\n  return 'ElementDescriptor[' + this.type.$descriptor.name + ']';\r\n};\r\n\r\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\r\n  return new ValueHandler(propertyDesc, element);\r\n};\r\n\r\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\r\n  return new ReferenceHandler(propertyDesc, this.context);\r\n};\r\n\r\nElementHandler.prototype.handler = function(type) {\r\n  if (type === 'Element') {\r\n    return new GenericElementHandler(this.model, type, this.context);\r\n  } else {\r\n    return new ElementHandler(this.model, type, this.context);\r\n  }\r\n};\r\n\r\n/**\r\n * Handle the child element parsing\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.handleChild = function(node) {\r\n  var nameNs = parseNameNs(node.local, node.prefix);\r\n\r\n  var propertyDesc, type, childHandler;\r\n\r\n  propertyDesc = this.getPropertyForElement(nameNs);\r\n\r\n  type = propertyDesc.effectiveType || propertyDesc.type;\r\n\r\n  if (isSimpleType(propertyDesc.type)) {\r\n    return this.valueHandler(propertyDesc, this.element);\r\n  }\r\n\r\n  if (propertyDesc.isReference) {\r\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\r\n  } else {\r\n    childHandler = this.handler(type).handleNode(node);\r\n  }\r\n\r\n  var newElement = childHandler.getElement();\r\n\r\n  // child handles may decide to skip elements\r\n  // by not returning anythign\r\n  if (newElement !== undefined) {\r\n\r\n    if (propertyDesc.isMany) {\r\n      this.element.get(propertyDesc.name).push(newElement);\r\n    } else {\r\n      this.element.set(propertyDesc.name, newElement);\r\n    }\r\n\r\n    if (propertyDesc.isReference) {\r\n      _.extend(newElement, {\r\n        element: this.element\r\n      });\r\n\r\n      this.context.addReference(newElement);\r\n    }\r\n  }\r\n\r\n  return childHandler;\r\n};\r\n\r\n\r\nfunction GenericElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.context = context;\r\n}\r\n\r\nGenericElementHandler.prototype = new BaseElementHandler();\r\n\r\nGenericElementHandler.prototype.createElement = function(node) {\r\n\r\n  var name = node.name,\r\n      prefix = node.prefix,\r\n      uri = node.ns[prefix],\r\n      attributes = node.attributes;\r\n\r\n  return this.model.createAny(name, uri, attributes);\r\n};\r\n\r\nGenericElementHandler.prototype.handleChild = function(node) {\r\n\r\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node);\r\n\r\n  var child = handler.getElement();\r\n\r\n  if (child !== undefined) {\r\n\r\n    var children = this.element.$children;\r\n    if (!children) {\r\n      children = this.element.$children = [];\r\n    }\r\n\r\n    children.push(child);\r\n  }\r\n\r\n  return handler;\r\n};\r\n\r\nGenericElementHandler.prototype.handleText = function(text) {\r\n  this.body = this.body || '' + text;\r\n};\r\n\r\nGenericElementHandler.prototype.handleEnd = function() {\r\n  if (this.body) {\r\n    this.element.$body = this.body;\r\n  }\r\n};\r\n\r\n/**\r\n * A reader for a meta-model\r\n *\r\n * @class XMLReader\r\n *\r\n * @param {Model} model used to read xml files\r\n */\r\nfunction XMLReader(model) {\r\n\r\n  function resolveReferences(context) {\r\n\r\n    var elementsById = context.elementsById;\r\n    var references = context.references;\r\n\r\n    _.forEach(references, function(r) {\r\n      var element = r.element;\r\n      var reference = elementsById[r.id];\r\n      var property = element.$descriptor.propertiesByName[r.property];\r\n\r\n      if (!reference) {\r\n        context.addWarning({\r\n          message: 'unresolved reference <' + r.id + '>',\r\n          element: r.element,\r\n          property: r.property,\r\n          value: r.id\r\n        });\r\n      }\r\n\r\n      if (property.isMany) {\r\n        var collection = element.get(property.name),\r\n            idx = collection.indexOf(r);\r\n\r\n        if (!reference) {\r\n          // remove unresolvable reference\r\n          collection.splice(idx, 1);\r\n        } else {\r\n          // update reference\r\n          collection[idx] = reference;\r\n        }\r\n      } else {\r\n        element.set(property.name, reference);\r\n      }\r\n    });\r\n  }\r\n\r\n  function fromXML(xml, rootHandler, done) {\r\n\r\n    var context = new Context(rootHandler);\r\n\r\n    var parser = sax.parser(true, { xmlns: true, trim: true }),\r\n        stack = new Stack();\r\n\r\n    rootHandler.context = context;\r\n\r\n    // push root handler\r\n    stack.push(rootHandler);\r\n\r\n    // error handling\r\n    parser.onerror = function (e) {\r\n      // just throw\r\n      throw e;\r\n    };\r\n\r\n    parser.onopentag = function(node) {\r\n      var handler = stack.peek();\r\n\r\n      normalizeNamespaces(node, model);\r\n\r\n      try {\r\n        stack.push(handler.handleNode(node));\r\n      } catch (e) {\r\n\r\n        var line = this.line,\r\n            column = this.column;\r\n\r\n        throw new Error(\r\n          'unparsable content <' + node.name + '> detected\\n\\t' +\r\n            'line: ' + line + '\\n\\t' +\r\n            'column: ' + column + '\\n\\t' +\r\n            'nested error: ' + e.message);\r\n      }\r\n    };\r\n\r\n    parser.ontext = parser.oncdata = function(text) {\r\n      var handler = stack.peek();\r\n      handler.handleText(text);\r\n    };\r\n\r\n    parser.onclosetag = function(tagName) {\r\n      var old = stack.pop();\r\n      old.handleEnd();\r\n    };\r\n\r\n    parser.onend = function () {\r\n      resolveReferences(context);\r\n      done(null, rootHandler.getElement(), context);\r\n    };\r\n\r\n    try {\r\n      parser.write(xml).close();\r\n    } catch (e) {\r\n      // handle errors\r\n      done(e, undefined, context);\r\n    }\r\n  }\r\n\r\n  return {\r\n    fromXML: fromXML,\r\n\r\n    handler: function(name) {\r\n      return new ElementHandler(model, name);\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = XMLReader;\r\nmodule.exports.ElementHandler = ElementHandler;\n},{\"./common\":21,\"moddle/lib/util\":25,\"tiny-stack\":26}],20:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar util = require('moddle').util,\r\n    common = require('./common'),\r\n\r\n    parseNameNs = util.parseNameNs,\r\n    isSimpleType = util.isSimpleType,\r\n    nameToAlias = common.nameToAlias;\r\n\r\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\r\n\r\nvar CDATA_ESCAPE = /[<>\"&]+/;\r\n\r\nvar DEFAULT_NS_MAP = common.DEFAULT_NS_MAP;\r\n\r\n\r\nfunction nsName(ns) {\r\n  if (_.isString(ns)) {\r\n    return ns;\r\n  } else {\r\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\r\n  }\r\n}\r\n\r\nfunction getElementNs(ns, descriptor) {\r\n  if (descriptor.isGeneric) {\r\n    return descriptor.name;\r\n  } else {\r\n    return _.extend({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\r\n  }\r\n}\r\n\r\nfunction getPropertyNs(ns, descriptor) {\r\n  return _.extend({ localName: descriptor.ns.localName }, ns);\r\n}\r\n\r\nfunction getSerializableProperties(element) {\r\n  var descriptor = element.$descriptor;\r\n\r\n  return _.filter(descriptor.properties, function(p) {\r\n    var name = p.name;\r\n\r\n    // do not serialize defaults\r\n    if (!element.hasOwnProperty(name)) {\r\n      return false;\r\n    }\r\n\r\n    var value = element[name];\r\n\r\n    // do not serialize default equals\r\n    if (value === p.default) {\r\n      return false;\r\n    }\r\n\r\n    return p.isMany ? value.length : true;\r\n  });\r\n}\r\n\r\n/**\r\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\r\n *\r\n * @param {String} str the string to escape\r\n * @return {String} the escaped string\r\n */\r\nfunction escapeAttr(str) {\r\n  var escapeMap = {\r\n    '\\n': '&#10;',\r\n    '\\n\\r': '&#10;',\r\n    '\"': '&quot;'\r\n  };\r\n\r\n  // ensure we are handling strings here\r\n  str = _.isString(str) ? str : '' + str;\r\n\r\n  return str.replace(/(\\n|\\n\\r|\")/g, function(str) {\r\n    return escapeMap[str];\r\n  });\r\n}\r\n\r\nfunction filterAttributes(props) {\r\n  return _.filter(props, function(p) { return p.isAttr; });\r\n}\r\n\r\nfunction filterContained(props) {\r\n  return _.filter(props, function(p) { return !p.isAttr; });\r\n}\r\n\r\n\r\nfunction ReferenceSerializer(parent, ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nReferenceSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  return this;\r\n};\r\n\r\nReferenceSerializer.prototype.serializeTo = function(writer) {\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>' + this.element.id + '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction BodySerializer() {}\r\n\r\nBodySerializer.prototype.serializeValue = BodySerializer.prototype.serializeTo = function(writer) {\r\n  var value = this.value,\r\n      escape = this.escape;\r\n\r\n  if (escape) {\r\n    writer.append('<![CDATA[');\r\n  }\r\n\r\n  writer.append(this.value);\r\n\r\n  if (escape) {\r\n    writer.append(']]>');\r\n  }\r\n};\r\n\r\nBodySerializer.prototype.build = function(prop, value) {\r\n  this.value = value;\r\n\r\n  if (prop.type === 'String' && CDATA_ESCAPE.test(value)) {\r\n    this.escape = true;\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nfunction ValueSerializer(ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nValueSerializer.prototype = new BodySerializer();\r\n\r\nValueSerializer.prototype.serializeTo = function(writer) {\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>');\r\n\r\n  this.serializeValue(writer);\r\n\r\n  writer\r\n    .append( '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction ElementSerializer(parent, ns) {\r\n  this.body = [];\r\n  this.attrs = [];\r\n\r\n  this.parent = parent;\r\n  this.ns = ns;\r\n}\r\n\r\nElementSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n\r\n  var otherAttrs = this.parseNsAttributes(element);\r\n\r\n  if (!this.ns) {\r\n    this.ns = this.nsTagName(element.$descriptor);\r\n  }\r\n\r\n  if (element.$descriptor.isGeneric) {\r\n    this.parseGeneric(element);\r\n  } else {\r\n    var properties = getSerializableProperties(element);\r\n\r\n    this.parseAttributes(filterAttributes(properties));\r\n    this.parseContainments(filterContained(properties));\r\n\r\n    this.parseGenericAttributes(element, otherAttrs);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nElementSerializer.prototype.nsTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getElementNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getPropertyNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.ns.uri;\r\n};\r\n\r\nElementSerializer.prototype.nsAttributeName = function(element) {\r\n\r\n  var ns;\r\n\r\n  if (_.isString(element)) {\r\n    ns = parseNameNs(element);\r\n  } else\r\n  if (element.ns) {\r\n    ns = element.ns;\r\n  }\r\n\r\n  var effectiveNs = this.logNamespaceUsed(ns);\r\n\r\n  // strip prefix if same namespace like parent\r\n  if (this.isLocalNs(effectiveNs)) {\r\n    return { localName: ns.localName };\r\n  } else {\r\n    return _.extend({ localName: ns.localName }, effectiveNs);\r\n  }\r\n};\r\n\r\nElementSerializer.prototype.parseGeneric = function(element) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      attrs = this.attrs;\r\n\r\n  _.forEach(element, function(val, key) {\r\n\r\n    if (key === '$body') {\r\n      body.push(new BodySerializer().build({ type: 'String' }, val));\r\n    } else\r\n    if (key === '$children') {\r\n      _.forEach(val, function(child) {\r\n        body.push(new ElementSerializer(self).build(child));\r\n      });\r\n    } else\r\n    if (key.indexOf('$') !== 0) {\r\n      attrs.push({ name: key, value: escapeAttr(val) });\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Parse namespaces and return a list of left over generic attributes\r\n *\r\n * @param  {Object} element\r\n * @return {Array<Object>}\r\n */\r\nElementSerializer.prototype.parseNsAttributes = function(element) {\r\n  var self = this;\r\n\r\n  var genericAttrs = element.$attrs;\r\n\r\n  var attributes = [];\r\n\r\n  // parse namespace attributes first\r\n  // and log them. push non namespace attributes to a list\r\n  // and process them later\r\n  _.forEach(genericAttrs, function(value, name) {\r\n    var nameNs = parseNameNs(name);\r\n\r\n    if (nameNs.prefix === 'xmlns') {\r\n      self.logNamespace({ prefix: nameNs.localName, uri: value });\r\n    } else\r\n    if (!nameNs.prefix && nameNs.localName === 'xmlns') {\r\n      self.logNamespace({ uri: value });\r\n    } else {\r\n      attributes.push({ name: name, value: value });\r\n    }\r\n  });\r\n\r\n  return attributes;\r\n};\r\n\r\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\r\n\r\n  var self = this;\r\n\r\n  _.forEach(attributes, function(attr) {\r\n    try {\r\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\r\n    } catch (e) {\r\n      console.warn('[writer] missing namespace information for ', attr.name, '=', attr.value, 'on', element, e);\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.parseContainments = function(properties) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      element = this.element,\r\n      typeDesc = element.$descriptor;\r\n\r\n  _.forEach(properties, function(p) {\r\n    var value = element.get(p.name),\r\n        isReference = p.isReference,\r\n        isMany = p.isMany;\r\n\r\n    var ns = self.nsPropertyTagName(p);\r\n\r\n    if (!isMany) {\r\n      value = [ value ];\r\n    }\r\n\r\n    if (p.isBody) {\r\n      body.push(new BodySerializer().build(p, value[0]));\r\n    } else\r\n    if (isSimpleType(p.type)) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ValueSerializer(ns).build(p, v));\r\n      });\r\n    } else\r\n    if (isReference) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ReferenceSerializer(self, ns).build(v));\r\n      });\r\n    } else {\r\n      // allow serialization via type\r\n      // rather than element name\r\n      var asType = p.serialize === 'xsi:type';\r\n\r\n      _.forEach(value, function(v) {\r\n        var serializer;\r\n\r\n        if (asType) {\r\n          serializer = new TypeSerializer(self, ns);\r\n        } else {\r\n          serializer = new ElementSerializer(self);\r\n        }\r\n\r\n        body.push(serializer.build(v));\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.getNamespaces = function() {\r\n  if (!this.parent) {\r\n    if (!this.namespaces) {\r\n      this.namespaces = {\r\n        prefixMap: {},\r\n        uriMap: {},\r\n        used: {}\r\n      };\r\n    }\r\n  } else {\r\n    this.namespaces = this.parent.getNamespaces();\r\n  }\r\n\r\n  return this.namespaces;\r\n};\r\n\r\nElementSerializer.prototype.logNamespace = function(ns) {\r\n  var namespaces = this.getNamespaces();\r\n\r\n  var existing = namespaces.uriMap[ns.uri];\r\n\r\n  if (!existing) {\r\n    namespaces.uriMap[ns.uri] = ns;\r\n  }\r\n\r\n  namespaces.prefixMap[ns.prefix] = ns.uri;\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.logNamespaceUsed = function(ns) {\r\n  var element = this.element,\r\n      model = element.$model,\r\n      namespaces = this.getNamespaces();\r\n\r\n  // ns may be\r\n  //\r\n  //   * prefix only\r\n  //   * prefix:uri\r\n\r\n  var prefix = ns.prefix;\r\n  var uri = ns.uri || DEFAULT_NS_MAP[prefix] ||\r\n            namespaces.prefixMap[prefix] || (model ? (model.getPackage(prefix) || {}).uri : null);\r\n\r\n  if (!uri) {\r\n    throw new Error('no namespace uri given for prefix <' + ns.prefix + '>');\r\n  }\r\n\r\n  ns = namespaces.uriMap[uri];\r\n\r\n  if (!ns) {\r\n    ns = this.logNamespace({ prefix: prefix, uri: uri });\r\n  }\r\n\r\n  if (!namespaces.used[ns.uri]) {\r\n    namespaces.used[ns.uri] = ns;\r\n  }\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.parseAttributes = function(properties) {\r\n  var self = this,\r\n      element = this.element;\r\n\r\n  _.forEach(properties, function(p) {\r\n    self.logNamespaceUsed(p.ns);\r\n\r\n    var value = element.get(p.name);\r\n\r\n    if (p.isReference) {\r\n      value = value.id;\r\n    }\r\n\r\n    self.addAttribute(self.nsAttributeName(p), value);\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.addAttribute = function(name, value) {\r\n  var attrs = this.attrs;\r\n\r\n  if (_.isString(value)) {\r\n    value = escapeAttr(value);\r\n  }\r\n\r\n  attrs.push({ name: name, value: value });\r\n};\r\n\r\nElementSerializer.prototype.serializeAttributes = function(writer) {\r\n  var element = this.element,\r\n      attrs = this.attrs,\r\n      root = !this.parent,\r\n      namespaces = this.namespaces;\r\n\r\n  function collectNsAttrs() {\r\n    return _.collect(namespaces.used, function(ns) {\r\n      var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\r\n      return { name: name, value: ns.uri };\r\n    });\r\n  }\r\n\r\n  if (root) {\r\n    attrs = collectNsAttrs().concat(attrs);\r\n  }\r\n\r\n  _.forEach(attrs, function(a) {\r\n    writer\r\n      .append(' ')\r\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.serializeTo = function(writer) {\r\n  var hasBody = this.body.length;\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns));\r\n\r\n  this.serializeAttributes(writer);\r\n\r\n  writer\r\n    .append(hasBody ? '>' : ' />')\r\n    .appendNewLine();\r\n\r\n  writer.indent();\r\n\r\n  _.forEach(this.body, function(b) {\r\n    b.serializeTo(writer);\r\n  });\r\n\r\n  writer.unindent();\r\n\r\n  if (hasBody) {\r\n    writer\r\n      .appendIndent()\r\n      .append('</' + nsName(this.ns) + '>')\r\n      .appendNewLine();\r\n  }\r\n};\r\n\r\n/**\r\n * A serializer for types that handles serialization of data types\r\n */\r\nfunction TypeSerializer(parent, ns) {\r\n  ElementSerializer.call(this, parent, ns);\r\n}\r\n\r\nTypeSerializer.prototype = new ElementSerializer();\r\n\r\nTypeSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  this.typeNs = this.nsTagName(element.$descriptor);\r\n\r\n  return ElementSerializer.prototype.build.call(this, element);\r\n};\r\n\r\nTypeSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.typeNs.uri;\r\n};\r\n\r\nfunction SavingWriter() {\r\n  this.value = '';\r\n\r\n  this.write = function(str) {\r\n    this.value += str;\r\n  };\r\n}\r\n\r\nfunction FormatingWriter(out, format) {\r\n\r\n  var indent = [''];\r\n\r\n  this.append = function(str) {\r\n    out.write(str);\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendNewLine = function() {\r\n    if (format) {\r\n      out.write('\\n');\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendIndent = function() {\r\n    if (format) {\r\n      out.write(indent.join('  '));\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.indent = function() {\r\n    indent.push('');\r\n    return this;\r\n  };\r\n\r\n  this.unindent = function() {\r\n    indent.pop();\r\n    return this;\r\n  };\r\n}\r\n\r\n/**\r\n * A writer for meta-model backed document trees\r\n *\r\n * @class XMLWriter\r\n */\r\nfunction XMLWriter(options) {\r\n\r\n  options = _.extend({ format: false, preamble: true }, options || {});\r\n\r\n  function toXML(tree, writer) {\r\n    var internalWriter = writer || new SavingWriter();\r\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\r\n\r\n    if (options.preamble) {\r\n      formatingWriter.append(XML_PREAMBLE);\r\n    }\r\n\r\n    new ElementSerializer().build(tree).serializeTo(formatingWriter);\r\n\r\n    if (!writer) {\r\n      return internalWriter.value;\r\n    }\r\n  }\r\n\r\n  return {\r\n    toXML: toXML\r\n  };\r\n}\r\n\r\nmodule.exports = XMLWriter;\n},{\"./common\":21,\"moddle\":22}],21:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nfunction hasLowerCaseAlias(pkg) {\r\n  return pkg.xml && pkg.xml.alias === 'lowerCase';\r\n}\r\n\r\nfunction capitalize(string) {\r\n  return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction aliasToName(alias, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return capitalize(alias);\r\n  } else {\r\n    return alias;\r\n  }\r\n}\r\n\r\n\r\nfunction lower(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nfunction nameToAlias(name, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return lower(name);\r\n  } else {\r\n    return name;\r\n  }\r\n}\r\n\r\n\r\nmodule.exports.aliasToName = aliasToName;\r\nmodule.exports.nameToAlias = nameToAlias;\r\n\r\n\r\nvar DEFAULT_NS_MAP = {\r\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance'\r\n};\r\n\r\n\r\nmodule.exports.DEFAULT_NS_MAP = DEFAULT_NS_MAP;\n},{}],22:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = require('./lib/Model');\r\n\r\nmodule.exports.util = require('./lib/util');\n},{\"./lib/Model\":23,\"./lib/util\":25}],23:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar util = require('./util'),\r\n    logger = util.logger,\r\n    isBuiltInType = util.isBuiltInType,\r\n    parseNameNs = util.parseNameNs;\r\n\r\nvar DESCRIPTOR = '$descriptor',\r\n    MODEL = '$model',\r\n    PACKAGE = '$pkg';\r\n\r\nfunction $descriptor(type) {\r\n  return type[DESCRIPTOR];\r\n}\r\n\r\nfunction $model(type) {\r\n  return type[MODEL];\r\n}\r\n\r\nfunction $pkg(type) {\r\n  return type[PACKAGE];\r\n}\r\n\r\nfunction $define(element, name, value) {\r\n  Object.defineProperty(element, name, {\r\n    value: value\r\n  });\r\n}\r\n\r\nfunction $defineDescriptor(element, descriptor) {\r\n  $define(element, DESCRIPTOR, descriptor);\r\n}\r\n\r\nfunction $defineModel(element, model) {\r\n  $define(element, MODEL, model);\r\n}\r\n\r\nfunction $definePackage(element, pkg) {\r\n  $define(element, PACKAGE, pkg);\r\n}\r\n\r\nfunction isA(name) {\r\n  /* jshint -W040 */\r\n  return !!_.find($descriptor(this).allTypes, function(t) {\r\n    return t.name === name;\r\n  });\r\n}\r\n\r\n//// BaseType implementation /////////////////////////////////////////////////\r\n\r\nfunction BaseType(descriptor, model) {\r\n  $defineDescriptor(this, descriptor);\r\n  $defineModel(this, model);\r\n}\r\n\r\nBaseType.prototype.$propertyDescriptor = function(name) {\r\n  return $descriptor(this).propertiesByName[name];\r\n};\r\n\r\nBaseType.prototype.$instanceOf = isA;\r\n\r\nBaseType.prototype.get = function(name) {\r\n\r\n  var property = this.$propertyDescriptor(name),\r\n      propertyName;\r\n\r\n  if (!property) {\r\n    return this[name];\r\n  }\r\n\r\n  propertyName = property.name;\r\n\r\n  // check if access to collection property and lazily initialize it\r\n  if (!this[propertyName]) {\r\n    if (property.isMany) {\r\n      Object.defineProperty(this, propertyName, {\r\n        enumerable: !property.isReference,\r\n        writable: true,\r\n        value: []\r\n      });\r\n    }\r\n  }\r\n\r\n  return this[propertyName];\r\n};\r\n\r\nBaseType.prototype.set = function(name, value) {\r\n  var property = this.$propertyDescriptor(name);\r\n\r\n  if (!property) {\r\n    this.$attrs[name] = value;\r\n  } else {\r\n    Object.defineProperty(this, property.name, {\r\n      enumerable: !property.isReference,\r\n      writable: true,\r\n      value: value\r\n    });\r\n  }\r\n};\r\n\r\n//// Model implementation /////////////////////////////////////////////////\r\n\r\n/**\r\n * @class Model\r\n *\r\n * A model that can be used to create elements of a specific type.\r\n *\r\n * @example\r\n *\r\n * var Moddle = require('moddle');\r\n *\r\n * var pkg = {\r\n *   name: 'mypackage',\r\n *   prefix: 'my',\r\n *   types: [\r\n *     { name: 'Root' }\r\n *   ]\r\n * };\r\n *\r\n * var moddle = new Moddle([pkg]);\r\n *\r\n * @param {Array<Package>} packages  the packages to contain\r\n * @param {Object} options  additional options to pass to the model\r\n */\r\nfunction Model(packages, options) {\r\n\r\n  var modelInstance = {};\r\n\r\n  var packageMap = {};\r\n  var elementsByName = {};\r\n\r\n  var typeCache = {};\r\n\r\n  options = _.extend({ defaultId: 'id', generateIdProperty: true }, options || {});\r\n\r\n  function getElementByName(name) {\r\n    return elementsByName[name];\r\n  }\r\n\r\n  function createType(descriptor) {\r\n    var proto = new BaseType(descriptor, modelInstance);\r\n\r\n    // early initialize default values via prototype\r\n\r\n    _.forEach(descriptor.properties, function(p) {\r\n      if (!p.isMany && p.default !== undefined) {\r\n        proto[p.name] = p.default;\r\n      }\r\n    });\r\n\r\n    function ModelElement(attrs) {\r\n\r\n      var descriptor = $descriptor(this);\r\n\r\n      Object.defineProperty(this, '$attrs', {\r\n        value: {}\r\n      });\r\n\r\n      Object.defineProperty(this, '$type', {\r\n        value: descriptor.ns.name,\r\n        enumerable: true\r\n      });\r\n\r\n      _.forEach(attrs, function(val, key) {\r\n        this.set(key, val);\r\n      }, this);\r\n    }\r\n\r\n    ModelElement.prototype = proto;\r\n\r\n    // static accessor of the model descriptor\r\n    $defineModel(ModelElement, modelInstance);\r\n    $defineDescriptor(ModelElement, descriptor);\r\n\r\n    ModelElement.isA = isA;\r\n\r\n    return ModelElement;\r\n  }\r\n\r\n  function init() {\r\n    _.forEach(packages, function(pkg) {\r\n      var prefix = pkg.prefix;\r\n\r\n      packageMap[pkg.uri] = pkg;\r\n      packageMap[pkg.prefix] = pkg;\r\n\r\n      function registerType(t) {\r\n\r\n        // namespace types\r\n        var typeNs = parseNameNs(t.name, prefix),\r\n            nsName = typeNs.name;\r\n\r\n        _.extend(t, {\r\n          ns: typeNs,\r\n          name: nsName\r\n        });\r\n\r\n        elementsByName[nsName] = t;\r\n\r\n        // add back link to package\r\n        $definePackage(t, pkg);\r\n\r\n        t.propertiesByName = {};\r\n\r\n        _.forEach(t.properties, function(p) {\r\n\r\n          // namespace property names\r\n          var propertyNs = parseNameNs(p.name, typeNs.prefix),\r\n              propertyName = propertyNs.name;\r\n\r\n          // namespace property types\r\n          if (!isBuiltInType(p.type)) {\r\n            var propertyTypeNs = parseNameNs(p.type, propertyNs.prefix);\r\n            p.type = propertyTypeNs.name;\r\n          }\r\n\r\n          _.extend(p, {\r\n            ns: propertyNs,\r\n            name: propertyName\r\n          });\r\n\r\n          t.propertiesByName[propertyNs.name] = p;\r\n        });\r\n      }\r\n\r\n      _.forEach(pkg.types, registerType);\r\n    });\r\n  }\r\n\r\n  function collectEffectiveTypes(nameNs, result) {\r\n\r\n    var type = elementsByName[nameNs.name];\r\n\r\n    if (!type) {\r\n      throw new Error('unknown type <' + nameNs.name + '>');\r\n    }\r\n\r\n    _.forEach(type.superClass, function(cls) {\r\n      var parentNs = parseNameNs(cls, nameNs.prefix);\r\n      collectEffectiveTypes(parentNs, result);\r\n    });\r\n\r\n    result.push(type);\r\n\r\n    return result;\r\n  }\r\n\r\n  function getEffectiveDescriptor(type) {\r\n\r\n    var nameNs = parseNameNs(type);\r\n\r\n    // filter types for uniqueness\r\n    var allTypes = _.unique(collectEffectiveTypes(nameNs, []));\r\n\r\n    function redefineProperty(descriptor, p) {\r\n      var nsPrefix = p.ns.prefix;\r\n      var parts = p.redefines.split('#');\r\n\r\n      var name = parseNameNs(parts[0], nsPrefix);\r\n      var attrName = parseNameNs(parts[1], name.prefix).name;\r\n\r\n      var redefinedProperty = descriptor.propertiesByName[attrName];\r\n      if (!redefinedProperty) {\r\n        logger.error('[model] ' + type + ' : property <' + attrName + '> ' +\r\n                     'redefined by <' + p.ns.name + '> does not exist');\r\n\r\n        throw new Error('[model] refined property not found');\r\n      } else {\r\n        replaceProperty(descriptor, redefinedProperty, p);\r\n      }\r\n\r\n      delete p.redefines;\r\n    }\r\n\r\n    function addProperty(descriptor, p, idx) {\r\n      addNamedProperty(descriptor, p, true);\r\n\r\n      var properties = descriptor.properties;\r\n\r\n      if (idx !== undefined) {\r\n        properties.splice(idx, 0, p);\r\n      } else {\r\n        properties.push(p);\r\n      }\r\n    }\r\n\r\n    function replaceProperty(descriptor, oldProperty, newProperty) {\r\n      var oldNameNs = oldProperty.ns,\r\n          props = descriptor.properties,\r\n          propsByName = descriptor.propertiesByName;\r\n\r\n      if (oldProperty.isBody) {\r\n\r\n        if (!newProperty.isBody) {\r\n          throw new Error(\r\n            '[model] property <' + newProperty.ns.name + '> must be body property ' +\r\n            'to refine <' + oldProperty.ns.name + '>');\r\n        }\r\n\r\n        // TODO: Check compatibility\r\n        setBodyProperty(descriptor, newProperty, false);\r\n      }\r\n\r\n      addNamedProperty(descriptor, newProperty, true);\r\n\r\n      // replace old property at index with new one\r\n      var idx = props.indexOf(oldProperty);\r\n      if (idx === -1) {\r\n        throw new Error('[model] property <' + oldNameNs.name + '> not found in property list');\r\n      }\r\n\r\n      props[idx] = newProperty;\r\n\r\n      // replace propsByName entry with new property\r\n      propsByName[oldNameNs.name] = newProperty;\r\n      propsByName[oldNameNs.localName] = newProperty;\r\n    }\r\n\r\n    function addNamedProperty(descriptor, p, validate) {\r\n      var ns = p.ns,\r\n          propsByName = descriptor.propertiesByName;\r\n\r\n      if (validate) {\r\n        assertNotDefined(descriptor, p, ns.name);\r\n        assertNotDefined(descriptor, p, ns.localName);\r\n      }\r\n\r\n      propsByName[ns.name] = p;\r\n      propsByName[ns.localName] = p;\r\n    }\r\n\r\n    function setBodyProperty(descriptor, p, validate) {\r\n\r\n      if (descriptor.bodyProperty) {\r\n        throw new Error(\r\n          '[model] body property defined multiple times ' +\r\n          '(<' + descriptor.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\r\n      }\r\n\r\n      descriptor.bodyProperty = p;\r\n    }\r\n\r\n    function removeNamedProperty(descriptor, p) {\r\n      var ns = p.ns,\r\n          propsByName = descriptor.propertiesByName;\r\n\r\n      delete propsByName[ns.name];\r\n      delete propsByName[ns.localName];\r\n    }\r\n\r\n    function createIdProperty(descriptor) {\r\n      var nameNs = parseNameNs(options.defaultId, descriptor.ns.prefix);\r\n\r\n      var idProperty = {\r\n        name: nameNs.localName,\r\n        type: 'String',\r\n        isAttr: true,\r\n        ns: nameNs\r\n      };\r\n\r\n      // ensure that id is always the first attribute (if present)\r\n      addProperty(descriptor, idProperty, 0);\r\n    }\r\n\r\n    function assertNotDefined(descriptor, property, name) {\r\n      var propertyName = property.name,\r\n          definedProperty = descriptor.propertiesByName[propertyName];\r\n\r\n      if (definedProperty) {\r\n        console.error(\r\n          '[model] property <', propertyName, '> already defined. Override of ' +\r\n          '<', definedProperty.definedBy, '>#<', definedProperty, '> by ' +\r\n          '<', property.definedBy, '>#<', property, '> not allowed without redefines.');\r\n\r\n        throw new Error(\r\n          '[model] property <' + propertyName + '> already defined. Override of ' +\r\n          '<' + definedProperty.definedBy.ns.name + '>#<' + definedProperty.ns.name + '> by ' +\r\n          '<' + property.definedBy.ns.name + '>#<' + property.ns.name + '> not allowed without redefines.');\r\n      }\r\n    }\r\n\r\n    function needsId(descriptor) {\r\n      return options.generateIdProperty && !descriptor.propertiesByName[options.defaultId];\r\n    }\r\n\r\n    var descriptor = {\r\n      name: nameNs.name,\r\n      ns: nameNs,\r\n      allTypes: allTypes,\r\n      properties: [],\r\n      propertiesByName: {},\r\n      constraints: []\r\n    };\r\n\r\n    var last = _.last(allTypes);\r\n\r\n    $definePackage(descriptor, $pkg(last));\r\n\r\n    allTypes.forEach(function(t) {\r\n      (t.properties || []).forEach(function(p) {\r\n\r\n        // clone property to allow extensions\r\n        p = _.extend({}, p);\r\n\r\n        //if (p.ns.prefix === descriptor.ns.prefix) {\r\n          // remove prefix if namespace == type namespace\r\n          p.name = p.ns.localName;\r\n        //}\r\n\r\n        Object.defineProperty(p, 'definedBy', {\r\n          value: t\r\n        });\r\n\r\n        // add redefine support\r\n        if (p.redefines) {\r\n          redefineProperty(descriptor, p);\r\n        } else {\r\n          if (p.isBody) {\r\n            setBodyProperty(descriptor, p);\r\n          }\r\n          addProperty(descriptor, p);\r\n        }\r\n      });\r\n\r\n      (t.constraints || []).forEach(function(c) {\r\n        descriptor.constraints.push(c);\r\n      });\r\n    });\r\n\r\n    if (needsId(descriptor)) {\r\n      // create default ns id property unless it exists\r\n      // confirms with the general schema abilities of xml / json\r\n      createIdProperty(descriptor);\r\n    }\r\n\r\n    return descriptor;\r\n  }\r\n\r\n  function getPackage(uriOrPrefix) {\r\n    return packageMap[uriOrPrefix];\r\n  }\r\n\r\n  function getPackages() {\r\n    return _.clone(packages);\r\n  }\r\n\r\n  /**\r\n   * Returns the type representing a given descriptor\r\n   *\r\n   * @method Model#getType\r\n   *\r\n   * @example\r\n   *\r\n   * var Foo = moddle.getType('my:Foo');\r\n   * var foo = new Foo({ 'id' : 'FOO_1' });\r\n   *\r\n   * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n   * @return {Object}         the type representing the descriptor\r\n   */\r\n  function getType(descriptor) {\r\n\r\n    var name = _.isString(descriptor) ? descriptor : descriptor.ns.name;\r\n\r\n    var type = typeCache[name];\r\n\r\n    if (!type) {\r\n      descriptor = getEffectiveDescriptor(name);\r\n      type = typeCache[descriptor.name] = createType(descriptor);\r\n    }\r\n\r\n    return type;\r\n  }\r\n\r\n  /**\r\n   * Create an instance of the specified type.\r\n   *\r\n   * @method Model#create\r\n   *\r\n   * @example\r\n   *\r\n   * var foo = moddle.create('my:Foo');\r\n   * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\r\n   *\r\n   * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n   * @param  {Object} attrs   a number of attributes to initialize the model instance with\r\n   * @return {Object}         model instance\r\n   */\r\n  function create(descriptor, attrs) {\r\n\r\n    var Type = getType(descriptor);\r\n\r\n    var instance = new Type(attrs);\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * Creates an any-element type to be used within model instances.\r\n   *\r\n   * This can be used to create custom elements that lie outside the meta-model.\r\n   * The created element contains all the meta-data required to serialize it\r\n   * as part of meta-model elements.\r\n   *\r\n   * @method Model#createAny\r\n   *\r\n   * @example\r\n   *\r\n   * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\r\n   *   value: 'bar'\r\n   * });\r\n   *\r\n   * var container = moddle.create('my:Container', 'http://my', {\r\n   *   any: [ foo ]\r\n   * });\r\n   *\r\n   * // go ahead and serialize the stuff\r\n   *\r\n   *\r\n   * @param  {String} name  the name of the element\r\n   * @param  {String} nsUri the namespace uri of the element\r\n   * @param  {Object} [properties] a map of properties to initialize the instance with\r\n   * @return {Object} the any type instance\r\n   */\r\n  function createAny(name, nsUri, properties) {\r\n\r\n    var nameNs = parseNameNs(name);\r\n\r\n    var element = {\r\n      $type: name\r\n    };\r\n\r\n    var descriptor = {\r\n      name: name,\r\n      isGeneric: true,\r\n      ns: {\r\n        prefix: nameNs.prefix,\r\n        localName: nameNs.localName,\r\n        uri: nsUri\r\n      }\r\n    };\r\n\r\n    Object.defineProperty(element, '$descriptor', {\r\n      enumerable: false,\r\n      value: descriptor\r\n    });\r\n\r\n    _.forEach(properties, function(a, key) {\r\n      if (_.isObject(a) && a.value !== undefined) {\r\n        element[a.name] = a.value;\r\n      } else {\r\n        element[key] = a;\r\n      }\r\n    });\r\n\r\n    return element;\r\n  }\r\n\r\n  init();\r\n\r\n  return _.extend(modelInstance, {\r\n    create: create,\r\n    createAny: createAny,\r\n    getDescriptor: $descriptor,\r\n    getType: getType,\r\n    getPackage: getPackage,\r\n    getPackages: getPackages\r\n  });\r\n}\r\n\r\nmodule.exports = Model;\n},{\"./util\":25}],24:[function(require,module,exports){\n'use strict';\r\n\r\nvar LEVEL_MAP = {\r\n  'trace': 0,\r\n  'debug': 1,\r\n  'info': 2,\r\n  'warn': 3,\r\n  'error': 4,\r\n  'none': 5\r\n};\r\n\r\nvar DEFAULT_LEVEL = 'warn';\r\n\r\nfunction Logger(defaultLevel, handler) {\r\n\r\n  var level;\r\n\r\n  function setLevel(l) {\r\n    level = LEVEL_MAP[l || DEFAULT_LEVEL] || LEVEL_MAP[DEFAULT_LEVEL];\r\n  }\r\n\r\n  function setHandler(h) {\r\n    handler = h || console;\r\n  }\r\n\r\n  function log(type, args) {\r\n\r\n    var requestedLevel = LEVEL_MAP[type] || LEVEL_MAP.none,\r\n        logArgs,\r\n        fn;\r\n\r\n    if (level <= requestedLevel) {\r\n      if (handler) {\r\n        logArgs = Array.prototype.slice.call(args);\r\n\r\n        fn = handler[type] || handler.log;\r\n        if (fn) {\r\n          fn.apply(handler, logArgs);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setLevel(defaultLevel);\r\n  setHandler(handler || console);\r\n\r\n  return {\r\n    info: function() {\r\n      log('info', arguments);\r\n    },\r\n\r\n    warn: function() {\r\n      log('warn', arguments);\r\n    },\r\n\r\n    error: function() {\r\n      log('error', arguments);\r\n    },\r\n\r\n    debug: function() {\r\n      log('debug', arguments);\r\n    },\r\n\r\n    setLevel: setLevel,\r\n\r\n    getLevels: function() {\r\n      return LEVEL_MAP;\r\n    },\r\n\r\n    logging: function(temporaryLevel, fn) {\r\n      var old = level;\r\n\r\n      setLevel(temporaryLevel);\r\n\r\n      fn();\r\n\r\n      level = old;\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = Logger;\n},{}],25:[function(require,module,exports){\n'use strict';\r\n\r\n/**\r\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\r\n * given a default prefix to assume in case no explicit namespace is given.\r\n */\r\nfunction parseNameNs(name, defaultPrefix) {\r\n  var parts = name.split(/:/),\r\n      localName, prefix;\r\n\r\n  // no prefix (i.e. only local name)\r\n  if (parts.length === 1) {\r\n    localName = name;\r\n    prefix = defaultPrefix;\r\n  } else\r\n  // prefix + local name\r\n  if (parts.length === 2) {\r\n    localName = parts[1];\r\n    prefix = parts[0];\r\n  } else {\r\n    throw new Error('expected <prefix:localName> or <localName>');\r\n  }\r\n\r\n  name = (prefix ? prefix + ':' : '') + localName;\r\n\r\n  return {\r\n    name: name,\r\n    prefix: prefix,\r\n    localName: localName\r\n  };\r\n}\r\n\r\n/**\r\n * Built in moddle types\r\n */\r\nvar BUILD_IN_TYPES = {\r\n  'String': true,\r\n  'Boolean': true,\r\n  'Integer': true,\r\n  'Real': true,\r\n  'Element': true,\r\n};\r\n\r\n/**\r\n * Converters for built in types from string representations\r\n */\r\nvar TYPE_CONVERTERS = {\r\n  'String': function(s) { return s; },\r\n  'Boolean': function(s) { return s === 'true'; },\r\n  'Integer': function(s) { return parseInt(s, 10); },\r\n  'Real': function(s) { return parseFloat(s, 10); }\r\n};\r\n\r\nfunction coerceType(type, value) {\r\n\r\n  var converter = TYPE_CONVERTERS[type];\r\n\r\n  if (converter) {\r\n    return converter(value);\r\n  } else {\r\n    return value;\r\n  }\r\n}\r\n\r\nfunction isBuiltInType(type) {\r\n  return !!BUILD_IN_TYPES[type];\r\n}\r\n\r\nfunction isSimpleType(type) {\r\n  return !!TYPE_CONVERTERS[type];\r\n}\r\n\r\nmodule.exports.coerceType = coerceType;\r\nmodule.exports.isBuiltInType = isBuiltInType;\r\nmodule.exports.isSimpleType = isSimpleType;\r\nmodule.exports.parseNameNs = parseNameNs;\r\n\r\nvar Logger = require('./Logger');\r\n\r\nmodule.exports.logger = new Logger();\n},{\"./Logger\":24}],26:[function(require,module,exports){\n/**\n * Tiny stack for browser or server\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2014 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/tiny-stack/master/LICENSE>\n * @link http://avoidwork.github.io/tiny-stack\n * @module tiny-stack\n * @version 0.1.0\n */\n\n( function ( global ) {\n\n\"use strict\";\n\n/**\n * TinyStack\n *\n * @constructor\n */\nfunction TinyStack () {\n\tthis.data = [null];\n\tthis.top  = 0;\n}\n\n/**\n * Clears the stack\n *\n * @method clear\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.clear = function clear () {\n\tthis.data = [null];\n\tthis.top  = 0;\n\n\treturn this;\n};\n\n/**\n * Gets the size of the stack\n *\n * @method length\n * @memberOf TinyStack\n * @return {Number} Size of stack\n */\nTinyStack.prototype.length = function length () {\n\treturn this.top;\n};\n\n/**\n * Gets the item at the top of the stack\n *\n * @method peek\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.peek = function peek () {\n\treturn this.data[this.top];\n};\n\n/**\n * Gets & removes the item at the top of the stack\n *\n * @method pop\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.pop = function pop () {\n\tif ( this.top > 0 ) {\n\t\tthis.top--;\n\n\t\treturn this.data.pop();\n\t}\n\telse {\n\t\treturn undefined;\n\t}\n};\n\n/**\n * Pushes an item onto the stack\n *\n * @method push\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.push = function push ( arg ) {\n\tthis.data[++this.top] = arg;\n\n\treturn this;\n};\n\n/**\n * TinyStack factory\n *\n * @method factory\n * @return {Object} {@link TinyStack}\n */\nfunction factory () {\n\treturn new TinyStack();\n}\n\n// Node, AMD & window supported\nif ( typeof exports != \"undefined\" ) {\n\tmodule.exports = factory;\n}\nelse if ( typeof define == \"function\" ) {\n\tdefine( function () {\n\t\treturn factory;\n\t} );\n}\nelse {\n\tglobal.stack = factory;\n}\n} )( this );\n\n},{}],27:[function(require,module,exports){\nmodule.exports=require(22)\n},{\"./lib/Model\":28,\"./lib/util\":30}],28:[function(require,module,exports){\nmodule.exports=require(23)\n},{\"./util\":30}],29:[function(require,module,exports){\nmodule.exports=require(24)\n},{}],30:[function(require,module,exports){\nmodule.exports=require(25)\n},{\"./Logger\":29}],31:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"BPMN20\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/MODEL\",\n  \"associations\": [],\n  \"types\": [\n    {\n      \"name\": \"Interface\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operations\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operations_interface\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"Element\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Operation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_inMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_outMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"errorRefs\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRefs_operation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"Element\"\n        }\n      ]\n    },\n    {\n      \"name\": \"EndPoint\",\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"Auditing\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"GlobalTask\",\n      \"superClass\": [\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_globalTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Monitoring\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Performer\",\n      \"superClass\": [\n        \"ResourceRole\"\n      ]\n    },\n    {\n      \"name\": \"Process\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"processType\",\n          \"type\": \"ProcessType\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_process\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_process\"\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"supports\",\n          \"type\": \"Process\",\n          \"association\": \"A_supports_process\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"definitionalCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_definitionalCollaborationRef_process\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"isExecutable\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationSubscriptions\",\n          \"type\": \"CorrelationSubscription\",\n          \"association\": \"A_correlationSubscriptions_process\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LaneSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_lanes_laneSet\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Lane\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"childLaneSet\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_childLaneSet_parentLane\"\n        },\n        {\n          \"name\": \"partitionElementRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElementRef_lane\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"flowNodeRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"partitionElement\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElement_lane\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalManualTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ]\n    },\n    {\n      \"name\": \"ManualTask\",\n      \"superClass\": [\n        \"Task\"\n      ]\n    },\n    {\n      \"name\": \"UserTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_usertask\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Rendering\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"HumanPerformer\",\n      \"superClass\": [\n        \"Performer\"\n      ]\n    },\n    {\n      \"name\": \"PotentialOwner\",\n      \"superClass\": [\n        \"HumanPerformer\"\n      ]\n    },\n    {\n      \"name\": \"GlobalUserTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_globalUserTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Gateway\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"gatewayDirection\",\n          \"type\": \"GatewayDirection\",\n          \"default\": \"unspecified\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"eventGatewayType\",\n          \"type\": \"EventBasedGatewayType\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"activationCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_activationCondition_complexGateway\"\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_complexGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_exclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_inclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParallelGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ]\n    },\n    {\n      \"name\": \"RootElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Relationship\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"direction\",\n          \"type\": \"RelationshipDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sources\",\n          \"association\": \"A_sources_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"targets\",\n          \"association\": \"A_targets_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BaseElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"id\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionDefinitions\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionDefinitions_baseElement\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"extensionElements\",\n          \"type\": \"ExtensionElements\",\n          \"association\": \"A_extensionElements_baseElement\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"type\": \"Documentation\",\n          \"association\": \"A_documentation_baseElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Extension\",\n      \"properties\": [\n        {\n          \"name\": \"mustUnderstand\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"definition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_definition_extension\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionAttributeDefinitions\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionAttributeDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isReference\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"extensionDefinition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionElements\",\n      \"properties\": [\n        {\n          \"name\": \"valueRef\",\n          \"association\": \"A_valueRef_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"values\",\n          \"association\": \"A_value_extensionElements\",\n          \"type\": \"Element\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensionAttributeDefinition\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinition_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Documentation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"isAttr\": true,\n          \"type\": \"String\",\n          \"isBody\": true\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Event\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\",\n        \"InteractionNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_event\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"IntermediateCatchEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ]\n    },\n    {\n      \"name\": \"IntermediateThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"EndEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"StartEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isInterrupting\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ThrowEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSet\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSet_throwEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_throwEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociation\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociation_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_throwEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CatchEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"parallelMultiple\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSet\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSet_catchEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_catchEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataOutputAssociation\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociation_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_catchEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"BoundaryEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"cancelActivity\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"attachedToRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventDefinition\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CancelEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"ErrorEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"errorRef\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRef_errorEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TerminateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"EscalationEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"escalationRef\",\n          \"type\": \"Escalation\",\n          \"association\": \"A_escalationRef_escalationEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Escalation\",\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_escalation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"escalationCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ],\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CompensateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"waitForCompletion\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"activityRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_activityRef_compensateEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TimerEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"timeDate\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDate_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeCycle\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeCycle_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeDuration\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDuration_timerEventDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"LinkEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"source\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConditionalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_condition_conditionalEventDefinition\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"SignalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"signalRef\",\n          \"type\": \"Signal\",\n          \"association\": \"A_signalRef_signalEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Signal\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_signal\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ImplicitThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"DataState\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemAwareElement\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemSubjectRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemSubjectRef_itemAwareElement\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataState\",\n          \"type\": \"DataState\",\n          \"association\": \"A_dataState_itemAwareElement\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"transformation\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_transformation_dataAssociation\"\n        },\n        {\n          \"name\": \"assignment\",\n          \"type\": \"Assignment\",\n          \"association\": \"A_assignment_dataAssociation\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_sourceRef_dataAssociation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_targetRef_dataAssociation\",\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithOptional\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithWhileExecuting\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataOutput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithOptional\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithWhileExecuting\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"dataInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"OutputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Property\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"DataOutputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"InputOutputSpecification\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSets\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"outputSets\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_inputOutputSpecification\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObject\",\n      \"superClass\": [\n        \"FlowElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"InputOutputBinding\",\n      \"properties\": [\n        {\n          \"name\": \"inputDataRef\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputDataRef\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_ioBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Assignment\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"from\",\n          \"type\": \"Expression\",\n          \"association\": \"A_from_assignment\"\n        },\n        {\n          \"name\": \"to\",\n          \"type\": \"Expression\",\n          \"association\": \"A_to_assignment\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStore\",\n      \"superClass\": [\n        \"RootElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"capacity\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"isUnlimited\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStoreReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataStoreRef\",\n          \"type\": \"DataStore\",\n          \"association\": \"A_dataStoreRef_dataStoreReference\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObjectReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataObjectRef\",\n          \"type\": \"DataObject\",\n          \"association\": \"A_dataObjectRef_dataObject\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationLink\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_innerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_outerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_calledCollaborationRef_callConversation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Conversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ]\n    },\n    {\n      \"name\": \"SubConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"conversationNodes\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversationNodes_subConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_conversationNode\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageFlowRefs\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRefs_communication\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_conversationNode\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalConversation\",\n      \"superClass\": [\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"PartnerEntity\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerEntityRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"PartnerRole\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerRoleRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationProperty\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRetrievalExpression\",\n          \"type\": \"CorrelationPropertyRetrievalExpression\",\n          \"association\": \"A_correlationPropertyRetrievalExpression_correlationproperty\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_correlationProperty\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Error\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_error\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"errorCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationKey\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationKey\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Expression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"FormalExpression\",\n      \"superClass\": [\n        \"Expression\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"language\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"body\",\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"evaluatesToTypeRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_evaluatesToTypeRef_formalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Message\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"itemRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemRef_message\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemDefinition\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemKind\",\n          \"type\": \"ItemKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"import\",\n          \"type\": \"Import\",\n          \"association\": \"A_import_itemDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_flowElement\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_flowElement\"\n        },\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SequenceFlow\",\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isImmediate\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"conditionExpression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_conditionExpression_sequenceFlow\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElementsContainer\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"laneSets\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_laneSets_flowElementsContainer\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"flowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_flowElements_container\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallableElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_callableElement\"\n        },\n        {\n          \"name\": \"supportedInterfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_supportedInterfaceRefs_callableElements\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ioBinding\",\n          \"type\": \"InputOutputBinding\",\n          \"association\": \"A_ioBinding_callableElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"incoming\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoing\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyRetrievalExpression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messagePath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_messagePath_correlationset\"\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_correlationPropertyRetrievalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyBinding\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataPath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_dataPath_correlationPropertyBinding\"\n        },\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationPropertyBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Resource\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resourceParameters\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_resourceParameters_resource\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameter\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isRequired\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_resourceParameter\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationSubscription\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationKeyRef\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeyRef_correlationSubscription\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationPropertyBinding\",\n          \"type\": \"CorrelationPropertyBinding\",\n          \"association\": \"A_correlationPropertyBinding_correlationSubscription\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlow\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlowAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_innerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_outerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InteractionNode\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"incomingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Participant\",\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"interfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_interfaceRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantMultiplicity\",\n          \"type\": \"ParticipantMultiplicity\",\n          \"association\": \"A_participantMultiplicity_participant\"\n        },\n        {\n          \"name\": \"endPointRefs\",\n          \"type\": \"EndPoint\",\n          \"association\": \"A_endPointRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"processRef\",\n          \"type\": \"Process\",\n          \"association\": \"A_processRef_participant\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_innerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_outerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantMultiplicity\",\n      \"properties\": [\n        {\n          \"name\": \"minimum\",\n          \"default\": \"0\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"maximum\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Collaboration\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"choreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_choreographyRef_collaboration\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlowAssociations\",\n          \"type\": \"MessageFlowAssociation\",\n          \"association\": \"A_messageFlowAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationAssociations\",\n          \"type\": \"ConversationAssociation\",\n          \"association\": \"A_conversationAssociations_converstaionAssociations\"\n        },\n        {\n          \"name\": \"participants\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participants_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlows\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlows_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversations\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_conversationLinks_collaboration\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyActivity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_choreographyActivity\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_choreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_choreographyActivity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"loopType\",\n          \"type\": \"ChoreographyLoopType\",\n          \"default\": \"None\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledChoreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_calledChoreographyRef_callChoreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callChoreographyActivity\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subChoreography\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyTask\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRef_choreographyTask\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Choreography\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"GlobalChoreographyTask\",\n      \"superClass\": [\n        \"Choreography\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_globalChoreographyTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TextAnnotation\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Group\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValueRef_categoryValueRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Association\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"associationDirection\",\n          \"type\": \"AssociationDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_sourceRef_outgoing_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_targetRef_incoming_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Category\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValue\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValue_category\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Artifact\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"CategoryValue\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categorizedFlowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"value\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Activity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isForCompensation\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCharacteristics\",\n          \"type\": \"LoopCharacteristics\",\n          \"association\": \"A_loopCharacteristics_activity\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_activity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_activity\"\n        },\n        {\n          \"name\": \"boundaryEventRefs\",\n          \"type\": \"BoundaryEvent\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociations\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputAssociations\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"startQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"completionQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ServiceTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_serviceTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubProcess\",\n      \"superClass\": [\n        \"Activity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"triggeredByEvent\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subProcess\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LoopCharacteristics\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isSequential\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"behavior\",\n          \"type\": \"MultiInstanceBehavior\",\n          \"default\": \"All\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"loopCardinality\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCardinality_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopDataInputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataInputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"loopDataOutputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataOutputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputDataItem\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_inputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"outputDataItem\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"complexBehaviorDefinition\",\n          \"type\": \"ComplexBehaviorDefinition\",\n          \"association\": \"A_complexBehaviorDefinition_multiInstanceLoopCharacteristics\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"oneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_oneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"noneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_noneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"StandardLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"testBefore\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCondition_standardLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopMaximum\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopMaximum_standardLoopCharacteristics\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CallActivity\",\n      \"superClass\": [\n        \"Activity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledElementRef\",\n          \"type\": \"CallableElement\",\n          \"association\": \"A_calledElementRef_callActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Task\",\n      \"superClass\": [\n        \"Activity\",\n        \"InteractionNode\"\n      ]\n    },\n    {\n      \"name\": \"SendTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ReceiveTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ScriptTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptFormat\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BusinessRuleTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocSubProcess\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_adHocSubProcess\"\n        },\n        {\n          \"name\": \"ordering\",\n          \"type\": \"AdHocOrdering\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"cancelRemainingInstances\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Transaction\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"protocol\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"method\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalScriptTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptLanguage\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalBusinessRuleTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexBehaviorDefinition\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_condition_complexBehaviorDefinition\"\n        },\n        {\n          \"name\": \"event\",\n          \"type\": \"ImplicitThrowEvent\",\n          \"association\": \"A_event_complexBehaviorDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceRole\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resourceRef\",\n          \"type\": \"Resource\",\n          \"association\": \"A_resourceRef_activityResource\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"resourceParameterBindings\",\n          \"type\": \"ResourceParameterBinding\",\n          \"association\": \"A_resourceParameterBindings_activityResource\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"resourceAssignmentExpression\",\n          \"type\": \"ResourceAssignmentExpression\",\n          \"association\": \"A_resourceAssignmentExpression_activityResource\"\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameterBinding\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceParameterBinding\"\n        },\n        {\n          \"name\": \"parameterRef\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_parameterRef_resourceParameterBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceAssignmentExpression\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceAssignmentExpression\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Import\",\n      \"properties\": [\n        {\n          \"name\": \"importType\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"location\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"namespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Definitions\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"targetNamespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"expressionLanguage\",\n          \"default\": \"http://www.w3.org/1999/XPath\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"typeLanguage\",\n          \"default\": \"http://www.w3.org/2001/XMLSchema\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"imports\",\n          \"type\": \"Import\",\n          \"association\": \"A_imports_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensions\",\n          \"type\": \"Extension\",\n          \"association\": \"A_extensions_definitions\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"relationships\",\n          \"type\": \"Relationship\",\n          \"association\": \"A_relationships_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"rootElements\",\n          \"type\": \"RootElement\",\n          \"association\": \"A_rootElements_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"diagrams\",\n          \"association\": \"A_diagrams_definitions\",\n          \"isMany\": true,\n          \"type\": \"bpmndi:BPMNDiagram\"\n        },\n        {\n          \"name\": \"exporter\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"exporterVersion\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ProcessType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Public\"\n        },\n        {\n          \"name\": \"Private\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GatewayDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"Unspecified\"\n        },\n        {\n          \"name\": \"Converging\"\n        },\n        {\n          \"name\": \"Diverging\"\n        },\n        {\n          \"name\": \"Mixed\"\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGatewayType\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Exclusive\"\n        }\n      ]\n    },\n    {\n      \"name\": \"RelationshipDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Forward\"\n        },\n        {\n          \"name\": \"Backward\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"Physical\"\n        },\n        {\n          \"name\": \"Information\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyLoopType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Standard\"\n        },\n        {\n          \"name\": \"MultiInstanceSequential\"\n        },\n        {\n          \"name\": \"MultiInstanceParallel\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AssociationDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceBehavior\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"All\"\n        },\n        {\n          \"name\": \"Complex\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocOrdering\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Sequential\"\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"bpmn\",\n  \"xml\": {\n    \"alias\": \"lowerCase\"\n  }\n}\n},{}],32:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"BPMNDI\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"BPMNDiagram\",\n      \"properties\": [\n        {\n          \"name\": \"plane\",\n          \"type\": \"BPMNPlane\",\n          \"association\": \"A_plane_diagram\",\n          \"redefines\": \"di:Diagram#rootElement\"\n        },\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_diagram\",\n          \"isMany\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:Diagram\"\n      ]\n    },\n    {\n      \"name\": \"BPMNPlane\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_plane\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Plane\"\n      ]\n    },\n    {\n      \"name\": \"BPMNShape\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_shape\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"isHorizontal\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isExpanded\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isMarkerVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_shape\"\n        },\n        {\n          \"name\": \"isMessageVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"participantBandKind\",\n          \"type\": \"ParticipantBandKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"choreographyActivityShape\",\n          \"type\": \"BPMNShape\",\n          \"association\": \"A_choreographyActivityShape_participantBandShape\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledShape\"\n      ]\n    },\n    {\n      \"name\": \"BPMNEdge\",\n      \"properties\": [\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_edge\"\n        },\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_edge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"sourceElement\",\n          \"association\": \"A_sourceElement_sourceEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#source\"\n        },\n        {\n          \"name\": \"targetElement\",\n          \"association\": \"A_targetElement_targetEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#target\"\n        },\n        {\n          \"name\": \"messageVisibleKind\",\n          \"type\": \"MessageVisibleKind\",\n          \"isAttr\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledEdge\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabel\",\n      \"properties\": [\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_label\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"redefines\": \"di:DiagramElement#style\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Label\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabelStyle\",\n      \"properties\": [\n        {\n          \"name\": \"font\",\n          \"type\": \"dc:Font\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Style\"\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ParticipantBandKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"top_initiating\"\n        },\n        {\n          \"name\": \"middle_initiating\"\n        },\n        {\n          \"name\": \"bottom_initiating\"\n        },\n        {\n          \"name\": \"top_non_initiating\"\n        },\n        {\n          \"name\": \"middle_non_initiating\"\n        },\n        {\n          \"name\": \"bottom_non_initiating\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageVisibleKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"initiating\"\n        },\n        {\n          \"name\": \"non_initiating\"\n        }\n      ]\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"bpmndi\"\n}\n},{}],33:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"DC\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DC\",\n  \"types\": [\n    {\n      \"name\": \"Boolean\"\n    },\n    {\n      \"name\": \"Integer\"\n    },\n    {\n      \"name\": \"Real\"\n    },\n    {\n      \"name\": \"String\"\n    },\n    {\n      \"name\": \"Font\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"size\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isBold\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isItalic\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isUnderline\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isStrikeThrough\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Point\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Bounds\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"width\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"height\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"dc\",\n  \"associations\": []\n}\n},{}],34:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"DI\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"DiagramElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"owningDiagram\",\n          \"type\": \"Diagram\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"owningElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"modelElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_modelElement_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"style\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_style_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ownedElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Node\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ]\n    },\n    {\n      \"name\": \"Edge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"source\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_source_sourceEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_target_targetEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"waypoint\",\n          \"isUnique\": false,\n          \"isMany\": true,\n          \"type\": \"dc:Point\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Diagram\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"rootElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resolution\",\n          \"isAttr\": true,\n          \"type\": \"Real\"\n        },\n        {\n          \"name\": \"ownedStyle\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedStyle_owningDiagram\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Shape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Plane\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"planeElement\",\n          \"type\": \"DiagramElement\",\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_planeElement_plane\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledEdge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Edge\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningEdge\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledShape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Shape\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningShape\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Label\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Style\",\n      \"isAbstract\": true\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"di\"\n}\n},{}],35:[function(require,module,exports){\nmodule.exports = require('./lib/Diagram');\n},{\"./lib/Diagram\":36}],36:[function(require,module,exports){\n'use strict';\r\n\r\nvar di = require('didi');\r\n\r\n/**\r\n * @namespace djs\r\n */\r\n\r\n/**\r\n * Bootstrap an injector from a list of modules, instantiating a number of default components\r\n *\r\n * @param {Array<didi.Module>} bootstrapModules\r\n *\r\n * @return {didi.Injector} a injector to use to access the components\r\n */\r\nfunction bootstrap(bootstrapModules) {\r\n\r\n  var modules = [];\r\n  var components = [];\r\n\r\n  function hasModule(m) {\r\n    return modules.indexOf(m) >= 0;\r\n  }\r\n\r\n  function addModule(m) {\r\n    modules.push(m);\r\n  }\r\n\r\n  function visit(m) {\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    (m.__depends__ || []).forEach(visit);\r\n\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    addModule(m);\r\n\r\n    (m.__init__ || []).forEach(function(c) {\r\n      components.push(c);\r\n    });\r\n  }\r\n\r\n  bootstrapModules.forEach(visit);\r\n\r\n  var injector = new di.Injector(modules);\r\n\r\n  components.forEach(function(c) {\r\n    // eagerly resolve main components\r\n    injector.get(c);\r\n  });\r\n\r\n  return injector;\r\n}\r\n\r\n/**\r\n * Creates an injector from passed options.\r\n *\r\n * @param  {Object} options\r\n * @return {didi.Injector}\r\n */\r\nfunction createInjector(options) {\r\n\r\n  options = options || {};\r\n\r\n  var configModule = {\r\n    'config': ['value', options]\r\n  };\r\n\r\n  var coreModule = require('./core');\r\n\r\n  var modules = [ configModule, coreModule ].concat(options.modules || []);\r\n\r\n  return bootstrap(modules);\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * The main diagram-js entry point that bootstraps the diagram with the given\r\n * configuration.\r\n *\r\n *\r\n * To register extensions with the diagram, pass them as Array<didi.Module> to the constructor\r\n *\r\n * @example\r\n *\r\n * Given you would like to create a plug-in that logs whenever a shape\r\n * or connection was added to the canvas:\r\n *\r\n *   * Create the plug-in file:\r\n *\r\n *     ```javascript\r\n *     function MyLoggingPlugin(events) {\r\n *       events.on('shape.added', function(event) {\r\n *         console.log('shape ', event.shape, ' was added to the diagram');\r\n *       });\r\n *     }\r\n *\r\n *     module.exports = {\r\n *       __init__: [ 'myLoggingPlugin'],\r\n *       myLoggingPlugin: [ 'type', [ 'eventBus', MyLoggingPlugin ]]\r\n *     };\r\n *     ```\r\n *\r\n *   * Instantiate the diagram with the new plug-in\r\n *\r\n *     ```javascript\r\n *     var diagram = new Diagram({ modules: [ require('path-to-plugin-file') ] });\r\n *\r\n *     diagram.invoke([ 'canvas', function(canvas) {\r\n *       // add shape to drawing canvas\r\n *       canvas.addShape({ x: 10, y: 10 });\r\n *     });\r\n *\r\n *     // 'shape ... was added to the diagram' logged to console\r\n *     ```\r\n *\r\n * @param {Object} options\r\n * @param {Array<didi.Module>} [options.modules] external modules to instantiate with the diagram\r\n * @param {didi.Injector} [injector] an (optional) injector to bootstrap the diagram with\r\n */\r\nfunction Diagram(options, injector) {\r\n\r\n  // create injector unless explicitly specified\r\n  this.injector = injector = injector || createInjector(options);\r\n\r\n  // API\r\n\r\n  /**\r\n   * Resolves a diagram service\r\n   *\r\n   * @method Diagram#get\r\n   *\r\n   * @param {String} name the name of the diagram service to be retrieved\r\n   * @param {Object} [locals] a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.get = injector.get;\r\n\r\n  /**\r\n   * Executes a function into which diagram services are injected\r\n   *\r\n   * @method Diagram#invoke\r\n   *\r\n   * @param {Function|Object[]} fn the function to resolve\r\n   * @param {Object} locals a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.invoke = injector.invoke;\r\n\r\n  // init\r\n\r\n  // indicate via event\r\n\r\n\r\n  /**\r\n   * An event indicating that all plug-ins are loaded.\r\n   *\r\n   * Use this event to fire other events to interested plug-ins\r\n   *\r\n   * @memberOf Diagram\r\n   *\r\n   * @event diagram.init\r\n   *\r\n   * @example\r\n   *\r\n   * events.on('diagram.init', function() {\r\n   *   events.fire('my-custom-event', { foo: 'BAR' });\r\n   * });\r\n   *\r\n   * @type {Object}\r\n   * @property {snapsvg.Paper} paper the initialized drawing paper\r\n   */\r\n  this.get('eventBus').fire('diagram.init');\r\n}\r\n\r\nmodule.exports = Diagram;\r\n\r\n\r\n/**\r\n * Destroys the diagram\r\n *\r\n * @method  Diagram#destroy\r\n */\r\nDiagram.prototype.destroy = function() {\r\n  this.get('eventBus').fire('diagram.destroy');\r\n};\n},{\"./core\":44,\"didi\":61}],37:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar AddShapeHandler = require('./cmd/AddShapeHandler'),\r\n    AddConnectionHandler = require('./cmd/AddConnectionHandler');\r\n\r\n\r\n/**\r\n * @type djs.ShapeDescriptor\r\n */\r\n\r\n/**\r\n * Creates a HTML container element for a SVG element with\r\n * the given configuration\r\n *\r\n * @param  {Object} options\r\n * @return {DOMElement} the container element\r\n */\r\nfunction createContainer(options) {\r\n\r\n  options = _.extend({}, { width: '100%', height: '100%' }, options);\r\n\r\n  var container = options.container || document.body;\r\n\r\n  // create a <div> around the svg element with the respective size\r\n  // this way we can always get the correct container size\r\n  // (this is impossible for <svg> elements at the moment)\r\n  var parent = document.createElement('div');\r\n  parent.setAttribute('class', 'djs-container');\r\n\r\n  parent.style.position = 'relative';\r\n  parent.style.width = _.isNumber(options.width) ? options.width + 'px' : options.width;\r\n  parent.style.height = _.isNumber(options.height) ? options.height + 'px' : options.height;\r\n\r\n  container.appendChild(parent);\r\n\r\n  return parent;\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * @emits Canvas#canvas.init\r\n *\r\n * @param {Object} config\r\n * @param {EventBus} events\r\n * @param {CommandStack} commandStack\r\n * @param {GraphicsFactory} graphicsFactory\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction Canvas(config, events, commandStack, graphicsFactory, elementRegistry) {\r\n\r\n  var options = _.extend(config.canvas || {});\r\n\r\n\r\n  // Creates a <svg> element that is wrapped into a <div>.\r\n  // This way we are always able to correctly figure out the size of the svg element\r\n  // by querying the parent node.\r\n  //\r\n  // (It is not possible to get the size of a svg element cross browser @ 2014-04-01)\r\n  //\r\n  // <div class=\"djs-container\" style=\"width: {desired-width}, height: {desired-height}\">\r\n  //   <svg width=\"100%\" height=\"100%\">\r\n  //    ...\r\n  //   </svg>\r\n  // </div>\r\n\r\n  var container = createContainer(options);\r\n  var paper = createPaper(container);\r\n\r\n\r\n  function createPaper(container) {\r\n    return graphicsFactory.createPaper({ container: container, width: '100%', height: '100%' });\r\n  }\r\n\r\n  /**\r\n   * Validate the id of an element, ensuring it is present and not yet assigned\r\n   */\r\n  function validateId(element) {\r\n\r\n    if (!element.id) {\r\n      throw new Error('element must have an id');\r\n    }\r\n\r\n    if (elementRegistry.getById(element.id)) {\r\n      throw new Error('element with id ' + element.id + ' already exists');\r\n    }\r\n  }\r\n\r\n\r\n  // register shape add handlers\r\n  commandStack.registerHandler('shape.add', AddShapeHandler);\r\n\r\n  // register connection add handlers\r\n  commandStack.registerHandler('connection.add', AddConnectionHandler);\r\n\r\n\r\n\r\n  /**\r\n   * Adds a shape to the canvas\r\n   *\r\n   * @method Canvas#addShape\r\n   *\r\n   * @param {djs.ShapeDescriptor} shape a descriptor for the shape\r\n   *\r\n   * @return {Canvas} the canvas api\r\n   */\r\n  function addShape(shape) {\r\n\r\n    validateId(shape);\r\n\r\n    /**\r\n     * An event indicating that a new shape has been added to the canvas.\r\n     *\r\n     * @memberOf Canvas\r\n     *\r\n     * @event shape.added\r\n     * @type {Object}\r\n     * @property {djs.ElementDescriptor} element the shape descriptor\r\n     * @property {Object} gfx the graphical representation of the shape\r\n     */\r\n\r\n    commandStack.execute('shape.add', { shape: shape });\r\n\r\n    /* jshint -W040 */\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * Adds a connection to the canvas\r\n   *\r\n   * @method Canvas#addConnection\r\n   *\r\n   * @param {djs.ElementDescriptor} connection a descriptor for the connection\r\n   *\r\n   * @return {Canvas} the canvas api\r\n   */\r\n  function addConnection(connection) {\r\n\r\n    validateId(connection);\r\n\r\n    /**\r\n     * An event indicating that a new connection has been added to the canvas.\r\n     *\r\n     * @memberOf Canvas\r\n     *\r\n     * @event connection.added\r\n     * @type {Object}\r\n     * @property {djs.ElementDescriptor} element the connection descriptor\r\n     * @property {Object} gfx the graphical representation of the connection\r\n     */\r\n\r\n    commandStack.execute('connection.add', { connection: connection });\r\n\r\n    /* jshint -W040 */\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Sends a shape to the front.\r\n   *\r\n   * This method takes parent / child relationships between shapes into account\r\n   * and makes sure that children are properly handled, too.\r\n   *\r\n   * @method Canvas#sendToFront\r\n   *\r\n   * @param {djs.ElementDescriptor} shape descriptor of the shape to be sent to front\r\n   * @param {boolean} bubble=true whether to send parent shapes to front, too\r\n   */\r\n  function sendToFront(shape, bubble) {\r\n\r\n    if (bubble !== false) {\r\n      bubble = true;\r\n    }\r\n\r\n    if (bubble && shape.parent) {\r\n      sendToFront(shape.parent);\r\n    }\r\n\r\n    if (shape.children) {\r\n      shape.children.forEach(function(child) {\r\n        sendToFront(child, false);\r\n      });\r\n    }\r\n\r\n    var gfx = getGraphics(shape),\r\n        gfxParent = gfx.parent();\r\n\r\n    gfx.remove().appendTo(gfxParent);\r\n  }\r\n\r\n  /**\r\n   * Return the graphical object underlaying a certain diagram element\r\n   *\r\n   * @method Canvas#getGraphics\r\n   *\r\n   * @param {djs.ElementDescriptor} element descriptor of the element\r\n   */\r\n  function getGraphics(element) {\r\n    return elementRegistry.getGraphicsByElement(element);\r\n  }\r\n\r\n  /**\r\n   * Returns the underlaying graphics context.\r\n   *\r\n   * @method Canvas#getPaper\r\n   *\r\n   * @returns {snapsvg.Paper} the global paper object\r\n   */\r\n  function getPaper() {\r\n    return paper;\r\n  }\r\n\r\n  /**\r\n   * Returns the size of the canvas\r\n   *\r\n   * @return {Object} with x/y coordinates\r\n   */\r\n  function getSize() {\r\n\r\n    return {\r\n      width: container.clientWidth,\r\n      height: container.clientHeight\r\n    };\r\n  }\r\n\r\n  function parseViewBox(str) {\r\n    if (!str) {\r\n      return;\r\n    }\r\n\r\n    var value = str.split(/\\s/);\r\n\r\n    return {\r\n      x: parseInt(value[0], 10),\r\n      y: parseInt(value[1], 10),\r\n      width: parseInt(value[2], 10),\r\n      height: parseInt(value[3], 10),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Gets or sets the view box of the canvas, i.e. the area that is currently displayed\r\n   *\r\n   * @method Canvas#viewbox\r\n   *\r\n   * @param  {Object} [box] the new view box to set\r\n   * @return {Object} the current view box\r\n   */\r\n  function viewbox(box) {\r\n\r\n    var svg = paper.node,\r\n        bbox = svg.getBBox();\r\n\r\n    function round(i, accuracy) {\r\n      if (!i) {\r\n        return i;\r\n      }\r\n\r\n      accuracy = accuracy || 100;\r\n      return Math.round(i * accuracy) / accuracy;\r\n    }\r\n\r\n    var inner = {\r\n      width: round(bbox.width + bbox.x),\r\n      height: round(bbox.height + bbox.y)\r\n    };\r\n\r\n    // returns the acutal embedded size of the SVG element\r\n    // would be awesome to be able to use svg.client(Width|Height) or\r\n    // svg.getBoundingClientRect(). Not supported in IE/Firefox though\r\n    var outer = getSize(svg);\r\n\r\n    if (box === undefined) {\r\n      box = parseViewBox(svg.getAttribute('viewBox'));\r\n\r\n      if (!box) {\r\n        box = { x: 0, y: 0, width: outer.width, height: outer.height };\r\n      }\r\n\r\n      // calculate current scale based on svg bbox (inner) and viewbox (outer)\r\n      box.scale = round(Math.min(outer.width / box.width, outer.height / box.height));\r\n\r\n      box.inner = inner;\r\n      box.outer = outer;\r\n    } else {\r\n      svg.setAttribute('viewBox', [ box.x, box.y, box.width, box.height ].join(' '));\r\n      events.fire('canvas.viewbox.changed', { viewbox: viewbox() });\r\n    }\r\n\r\n    return box;\r\n  }\r\n\r\n  /**\r\n   * Gets or sets the scroll of the canvas.\r\n   *\r\n   * @param {Object} [delta] the new scroll to apply.\r\n   *\r\n   * @param {Number} [delta.dx]\r\n   * @param {Number} [delta.dy]\r\n   *\r\n   * @return {Point} the new scroll\r\n   */\r\n  function scroll(delta) {\r\n\r\n    var vbox = viewbox();\r\n\r\n    if (delta) {\r\n      if (delta.dx) {\r\n        vbox.x += delta.dx;\r\n      }\r\n\r\n      if (delta.dy) {\r\n        vbox.y += delta.dy;\r\n      }\r\n\r\n      viewbox(vbox);\r\n    }\r\n\r\n    return { x: vbox.x, y: vbox.y };\r\n  }\r\n\r\n  /**\r\n   * Gets or sets the current zoom of the canvas, optionally zooming to the specified position.\r\n   *\r\n   * @method Canvas#zoom\r\n   *\r\n   * @param {String|Number} [newScale] the new zoom level, either a number, i.e. 0.9,\r\n   *                                   or `fit-viewport` to adjust the size to fit the current viewport\r\n   * @param {String|Point} [center] the reference point { x: .., y: ..} to zoom to, 'auto' to zoom into mid or null\r\n   *\r\n   * @return {Number} the current scale\r\n   */\r\n  function zoom(newScale, center) {\r\n\r\n    var vbox = viewbox(),\r\n        inner = vbox.inner,\r\n        outer = vbox.outer;\r\n\r\n    if (newScale === undefined) {\r\n      return vbox.scale;\r\n    }\r\n\r\n    if (newScale === 'fit-viewport') {\r\n      newScale = Math.min(outer.width / inner.width, outer.height / inner.height, 1.0);\r\n\r\n      // reset viewbox so that everything is visible\r\n      _.extend(vbox, { x: 0, y: 0 });\r\n    }\r\n\r\n    if (center === 'auto') {\r\n      center = {\r\n        x: outer.width / 2 - 1,\r\n        y: outer.height / 2 - 1\r\n      };\r\n    }\r\n\r\n    if (center) {\r\n\r\n      // zoom to center (i.e. simulate a maps like behavior)\r\n\r\n      // center on old zoom\r\n      var pox = center.x / vbox.scale + vbox.x;\r\n      var poy = center.y / vbox.scale + vbox.y;\r\n\r\n      // center on new zoom\r\n      var pnx = center.x / newScale;\r\n      var pny = center.y / newScale;\r\n\r\n      // delta = new offset\r\n      var px = pox - pnx;\r\n      var py = poy - pny;\r\n\r\n      var position = {\r\n        x: px,\r\n        y: py\r\n      };\r\n\r\n      _.extend(vbox, position);\r\n    }\r\n\r\n    _.extend(vbox, {\r\n      width: outer.width / newScale,\r\n      height: outer.height / newScale\r\n    });\r\n\r\n    viewbox(vbox);\r\n\r\n    // return current scale\r\n    return newScale;\r\n  }\r\n\r\n  events.on('diagram.init', function(event) {\r\n\r\n    /**\r\n     * An event indicating that the canvas is ready to be drawn on.\r\n     *\r\n     * @memberOf Canvas\r\n     *\r\n     * @event canvas.init\r\n     *\r\n     * @type {Object}\r\n     * @property {snapsvg.Paper} paper the initialized drawing paper\r\n     */\r\n    events.fire('canvas.init', { paper: paper });\r\n  });\r\n\r\n  events.on('diagram.destroy', function() {\r\n\r\n    if (container) {\r\n      var parent = container.parentNode;\r\n      parent.removeChild(container);\r\n    }\r\n\r\n    container = null;\r\n    paper = null;\r\n  });\r\n\r\n\r\n  // redraw shapes / connections on change\r\n\r\n  var self = this;\r\n\r\n  events.on('element.changed', function(event) {\r\n\r\n    if (event.element.waypoints) {\r\n      events.fire('connection.changed', event);\r\n    } else {\r\n      events.fire('shape.changed', event);\r\n    }\r\n  });\r\n\r\n  events.on('shape.changed', function(event) {\r\n    var element = event.element;\r\n    graphicsFactory.updateShape(element, event.gfx || self.getGraphics(element));\r\n  });\r\n\r\n  events.on('connection.changed', function(event) {\r\n    var element = event.element;\r\n    graphicsFactory.updateConnection(element, event.gfx || self.getGraphics(element));\r\n  });\r\n\r\n\r\n  this.zoom = zoom;\r\n  this.scroll = scroll;\r\n\r\n  this.viewbox = viewbox;\r\n  this.addShape = addShape;\r\n\r\n  this.addConnection = addConnection;\r\n  this.getPaper = getPaper;\r\n\r\n  this.getGraphics = getGraphics;\r\n\r\n  this.sendToFront = sendToFront;\r\n}\r\n\r\n/**\r\n * Return the absolute bounding box for the given element\r\n *\r\n * The absolute bounding box may be used to display overlays in the\r\n * callers (browser) coordinate system rather than the zoomed in/out\r\n * canvas coordinates.\r\n *\r\n * @param  {ElementDescriptor} element\r\n * @return {Bounds} the absolute bounding box\r\n */\r\nCanvas.prototype.getAbsoluteBBox = function(element) {\r\n  var vbox = this.viewbox();\r\n\r\n  var gfx = this.getGraphics(element);\r\n\r\n  var transformBBox = gfx.getBBox(true);\r\n  var bbox = gfx.getBBox();\r\n\r\n  var x = (bbox.x - transformBBox.x) * vbox.scale - vbox.x * vbox.scale;\r\n  var y = (bbox.y - transformBBox.y) * vbox.scale - vbox.y * vbox.scale;\r\n\r\n  var width = (bbox.width + 2 * transformBBox.x) * vbox.scale;\r\n  var height = (bbox.height + 2 * transformBBox.y) * vbox.scale;\r\n\r\n  return {\r\n    x: x,\r\n    y: y,\r\n    width: width,\r\n    height: height\r\n  };\r\n};\r\n\r\nCanvas.$inject = [\r\n  'config',\r\n  'eventBus',\r\n  'commandStack',\r\n  'graphicsFactory',\r\n  'elementRegistry' ];\r\n\r\nmodule.exports = Canvas;\n},{\"./cmd/AddConnectionHandler\":42,\"./cmd/AddShapeHandler\":43}],38:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @namespace djs\r\n */\r\n\r\n/**\r\n * @class\r\n *\r\n * This service offer an action history for the application.\r\n * So that the diagram can support undo/redo. All actions applied\r\n * to the diagram must be invoked through this Service.\r\n *\r\n * @param {Injector} injector\r\n * @param {EventBus} events\r\n */\r\nfunction CommandStack(injector, events) {\r\n\r\n  /**\r\n   *\r\n   * @type {Object} Key is the command id and value is a list of registered handler methods}\r\n   */\r\n  var handlerMap = {};\r\n\r\n  /**\r\n   * The stack containing all re/undoable actions on the diagram\r\n   * @type {Array<Object>}\r\n   */\r\n  var stack = [];\r\n\r\n  /**\r\n   * The current index on the stack\r\n   * @type {Number}\r\n   */\r\n  var stackIdx = -1;\r\n\r\n\r\n  function redoAction() {\r\n    return stack[stackIdx + 1];\r\n  }\r\n\r\n  function undoAction() {\r\n    return stack[stackIdx];\r\n  }\r\n\r\n  /**\r\n   * Execute all registered actions for this command id\r\n   *\r\n   * @param {String} id of the action\r\n   * @param {Object} ctx is a parameter object for the executed action\r\n   */\r\n  function execute(id, ctx) {\r\n    var action = { id: id, ctx: ctx };\r\n\r\n    internalExecute(action);\r\n  }\r\n\r\n  /**\r\n   * Execute all registered actions for this command id\r\n   *\r\n   * @param {String} id of the action\r\n   * @param {Object} ctx is a parameter object for the executed action\r\n   * @param {Boolean} saveRedoStack if true the redo stack is not reset.\r\n   *                  This must be set when an redo action is applied.\r\n   */\r\n  function internalExecute(action) {\r\n    var id = action.id,\r\n        ctx = action.ctx;\r\n\r\n    if (!action.id) {\r\n      throw new Error('action has no id');\r\n    }\r\n\r\n    events.fire('commandStack.execute', { id: id });\r\n\r\n    var handlers = getHandlers(id);\r\n\r\n    if (!(handlers && handlers.length)) {\r\n      console.warn('no command handler registered for ', id);\r\n    }\r\n\r\n    var executedHandlers = [];\r\n\r\n    _.forEach(handlers, function(handler) {\r\n      if (handler.execute(ctx)) {\r\n        executedHandlers.push(handler);\r\n      } else {\r\n        // TODO(nre): handle revert case, i.e. the situation that one of a number of handlers fail\r\n      }\r\n    });\r\n\r\n    executeFinished(action);\r\n  }\r\n\r\n  function executeFinished(action) {\r\n    if (redoAction() !== action) {\r\n      stack.splice(stackIdx + 1, stack.length, action);\r\n    }\r\n\r\n    stackIdx++;\r\n\r\n    events.fire('commandStack.changed');\r\n  }\r\n\r\n\r\n  function undo() {\r\n\r\n    var action = undoAction();\r\n    if (!action) {\r\n      return false;\r\n    }\r\n\r\n    events.fire('commandStack.revert', { id: action.id });\r\n\r\n    var handlers = getHandlers(action.id);\r\n    _.forEach(handlers, function(handler) {\r\n      handler.revert(action.ctx);\r\n    });\r\n\r\n    revertFinished(action);\r\n  }\r\n\r\n  function revertFinished(action) {\r\n    stackIdx--;\r\n\r\n    events.fire('commandStack.changed');\r\n  }\r\n\r\n  function redo() {\r\n\r\n    var action = redoAction();\r\n    if (action) {\r\n      internalExecute(action);\r\n    }\r\n\r\n    return action;\r\n  }\r\n\r\n  function getHandlers(id) {\r\n    if (id) {\r\n      return handlerMap[id];\r\n    } else {\r\n      return handlerMap;\r\n    }\r\n  }\r\n\r\n  function addHandler(id, handler) {\r\n    assertValidId(id);\r\n\r\n    var handlers = handlerMap[id];\r\n    if (!handlers) {\r\n      handlerMap[id] = handlers = [];\r\n    }\r\n\r\n    handlers.push(handler);\r\n  }\r\n\r\n  function getStack() {\r\n    return stack;\r\n  }\r\n\r\n  function getStackIndex() {\r\n    return stackIdx;\r\n  }\r\n\r\n  function clear() {\r\n    stack.length = 0;\r\n    stackIdx = -1;\r\n\r\n    events.fire('commandStack.changed');\r\n  }\r\n\r\n\r\n  ////// registration ////////////////////////////////////////\r\n\r\n  function assertValidId(id) {\r\n    if (!id) {\r\n      throw new Error('no id specified');\r\n    }\r\n  }\r\n\r\n  function register(id, handler) {\r\n    addHandler(id, handler);\r\n  }\r\n\r\n  function registerHandler(command, handlerCls) {\r\n\r\n    if (!command || !handlerCls) {\r\n      throw new Error('command and handlerCls must be defined');\r\n    }\r\n\r\n    var handler = injector.instantiate(handlerCls);\r\n    register(command, handler);\r\n  }\r\n\r\n  this.execute = execute;\r\n  this.undo = undo;\r\n  this.redo = redo;\r\n  this.clear = clear;\r\n  this.getStack = getStack;\r\n  this.getStackIndex = getStackIndex;\r\n  this.getHandlers = getHandlers;\r\n  this.registerHandler = registerHandler;\r\n  this.register = register;\r\n}\r\n\r\nCommandStack.$inject = [ 'injector', 'eventBus' ];\r\n\r\nmodule.exports = CommandStack;\n},{}],39:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A registry that keeps track of all shapes in the diagram.\r\n *\r\n * @param {EventBus} eventBus the event bus\r\n */\r\nfunction ElementRegistry(eventBus) {\r\n\r\n  // mapping shape.id -> container\r\n  var shapeMap = {};\r\n\r\n  // mapping gfx.id -> container\r\n  var graphicsMap = {};\r\n\r\n  function addShape(shape, gfx) {\r\n    if (!shape.id) {\r\n      throw new Error('[shapes] shape has no id');\r\n    }\r\n\r\n    if (!gfx.id) {\r\n      throw new Error('[shapes] graphics has no id');\r\n    }\r\n\r\n    if (graphicsMap[gfx.id]) {\r\n      throw new Error('graphics with id ' + gfx.id + ' already registered');\r\n    }\r\n\r\n    if (shapeMap[shape.id]) {\r\n      throw new Error('shape with id ' + shape.id + ' already added');\r\n    }\r\n\r\n    shapeMap[shape.id] = graphicsMap[gfx.id] = { shape: shape, gfx: gfx };\r\n  }\r\n\r\n  function removeShape(shape) {\r\n    var gfx = getGraphicsByElement(shape);\r\n\r\n    if (shape.parent) {\r\n      for(var i = 0; i < shape.parent.children.length;i++) {\r\n        if(shape.parent.children[i].id === shape.id) {\r\n          shape.parent.children.splice(i, 1);\r\n        }\r\n      }\r\n    }\r\n   // delete shape.parent.children[];\r\n    delete shapeMap[shape.id];\r\n    delete graphicsMap[gfx.id];\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getByGraphics\r\n   */\r\n  function getByGraphics(gfx) {\r\n    var id = _.isString(gfx) ? gfx : gfx.id;\r\n\r\n    var container = graphicsMap[id];\r\n    if (container) {\r\n      return container.shape;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getById\r\n   */\r\n  function getById(id) {\r\n    var container = shapeMap[id];\r\n    if (container) {\r\n      return container.shape;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @method ElementRegistry#getGraphicsByElement\r\n   */\r\n  function getGraphicsByElement(shape) {\r\n    var id = _.isString(shape) ? shape : shape.id;\r\n\r\n    var container = shapeMap[id];\r\n    if (container) {\r\n      return container.gfx;\r\n    }\r\n  }\r\n\r\n  eventBus.on('shape.added', function(event) {\r\n    addShape(event.element, event.gfx);\r\n  });\r\n\r\n  eventBus.on('connection.added', function(event) {\r\n    addShape(event.element, event.gfx);\r\n  });\r\n\r\n  eventBus.on('shape.removed', function(event) {\r\n    removeShape(event.element);\r\n  });\r\n\r\n  eventBus.on('connection.removed', function(event) {\r\n    removeShape(event.element);\r\n  });\r\n\r\n  return {\r\n    getGraphicsByElement: getGraphicsByElement,\r\n    getById: getById,\r\n    getByGraphics: getByGraphics\r\n  };\r\n}\r\n\r\nElementRegistry.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = ElementRegistry;\n},{}],40:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n/**\r\n * @global\r\n * @type {Object}\r\n * @static\r\n */\r\nvar EventPriority = {\r\n  standard: 1000,\r\n  overwrite: 10000\r\n};\r\n\r\n/**\r\n * @class\r\n *\r\n * A general purpose event bus\r\n */\r\nfunction EventBus() {\r\n  var listenerMap = {};\r\n\r\n  function getListeners(name) {\r\n    var listeners = listenerMap[name];\r\n\r\n    if (!listeners) {\r\n      listeners = listenerMap[name] = [];\r\n    }\r\n\r\n    return listeners;\r\n  }\r\n\r\n  function extendEvent(event, type) {\r\n\r\n    var propagationStopped,\r\n        defaultPrevented;\r\n\r\n    _.extend(event, {\r\n      type: type,\r\n\r\n      stopPropagation: function() {\r\n        this.propagationStopped = true;\r\n      },\r\n      preventDefault: function() {\r\n        this.defaultPrevented = true;\r\n      },\r\n\r\n      isPropagationStopped: function() {\r\n        return !!this.propagationStopped;\r\n      },\r\n\r\n      isDefaultPrevented: function() {\r\n        return !!this.defaultPrevented;\r\n      }\r\n    });\r\n\r\n    return event;\r\n  }\r\n\r\n  /**\r\n   * Register an event listener for events with the given name.\r\n   *\r\n   * The callback will be invoked with `event, ...additionalArguments`\r\n   * that have been passed to the evented element.\r\n   *\r\n   * @method Events#on\r\n   *\r\n   * @param {String} event\r\n   * @param {Function} callback\r\n   * @param {Number} Set priority to influence the execution order of the callbacks.\r\n   * The default priority is 1000. It should only set to higher values (> {@link EventPriority#overwrite}) if\r\n   * there is real need for a changed execution priority.\r\n   */\r\n  function on(event, callback, priority) {\r\n    if(priority && !_.isNumber(priority)) {\r\n      console.error('Priority needs to be a number');\r\n      priority = EventPriority.standard;\r\n    }\r\n    if(!priority) {\r\n      priority = EventPriority.standard;\r\n    }\r\n    var listeners = getListeners(event);\r\n    addEventToArray(listeners, callback, priority);\r\n  }\r\n\r\n  /**\r\n   * Register an event listener that is executed only once.\r\n   *\r\n   * @method Events#once\r\n   *\r\n   * @param {String} event the event name to register for\r\n   * @param {Function} callback the callback to execute\r\n   *\r\n   * @see Events#on\r\n   */\r\n  function once(event, callback) {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var self = this;\r\n    var wrappedCallback = function() {\r\n      var eventType = arguments[0].type;\r\n      callback.apply(this, arguments);\r\n      self.off(eventType, wrappedCallback);\r\n    };\r\n\r\n    this.on(event, wrappedCallback);\r\n  }\r\n\r\n  /**\r\n   * Removes event listeners by event and callback.\r\n   *\r\n   * If no callback is given, all listeners for a given event name are being removed.\r\n   *\r\n   * @method Events#off\r\n   *\r\n   * @param {String} event\r\n   * @param {Function} [callback]\r\n   */\r\n  function off(event, callback) {\r\n    var listeners, idx;\r\n\r\n    listeners = getListeners(event);\r\n    if (callback) {\r\n      _.forEach(listeners, function(listener) {\r\n        if(listener.callback === callback) {\r\n          idx = listeners.indexOf(listener);\r\n        }\r\n      });\r\n\r\n      if (idx !== -1) {\r\n        listeners.splice(idx, 1);\r\n      }\r\n    } else {\r\n      listeners.length = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fires a named event.\r\n   *\r\n   * @method Events#fire\r\n   *\r\n   * @example\r\n   *\r\n   * // fire event by name\r\n   * events.fire('foo');\r\n   *\r\n   * // fire event object with nested type\r\n   * var event = { type: 'foo' };\r\n   * events.fire(event);\r\n   *\r\n   * // fire event with explicit type\r\n   * var event = { x: 10, y: 20 };\r\n   * events.fire('element.moved', event);\r\n   *\r\n   * // pass additional arguments to the event\r\n   * events.on('foo', function(event, bar) {\r\n   *   alert(bar);\r\n   * });\r\n   *\r\n   * events.fire({ type: 'foo' }, 'I am bar!');\r\n   *\r\n   * @param {String} [name] the optional event name\r\n   * @param {Object} [event] the event object\r\n   * @param {...Object} additional arguments to be passed to the callback functions\r\n   */\r\n  function fire() {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var event, eventType,\r\n        listeners, i, l,\r\n        args;\r\n\r\n    args = Array.prototype.slice.call(arguments);\r\n\r\n    eventType = args[0];\r\n\r\n    if (_.isObject(eventType)) {\r\n      event = eventType;\r\n\r\n      // parse type from event\r\n      eventType = event.type;\r\n    } else {\r\n      // remove name parameter\r\n      args.shift();\r\n\r\n      event = args[0] || {};\r\n      event.type = eventType;\r\n      if(args.length === 0) {\r\n        args.push(event);\r\n      }\r\n    }\r\n\r\n    listeners = getListeners(eventType);\r\n    event = extendEvent(event, eventType);\r\n\r\n    for (i = 0, l; !!(l = listeners[i]); i++) {\r\n      if (event.isPropagationStopped()) {\r\n        break;\r\n      }\r\n      l.callback.apply(this, args);\r\n    }\r\n  }\r\n\r\n  function addEventToArray(array, callback, priority) {\r\n\r\n    array.push({\r\n      priority: priority,\r\n      callback: callback\r\n    });\r\n\r\n    array.sort(function(a, b) {\r\n      if(a.priority < b.priority) {\r\n        return 1;\r\n      } else if (a.priority > b.priority) {\r\n        return -1;\r\n      } else {\r\n        return 0;\r\n      }\r\n    });\r\n  }\r\n\r\n  this.on = on;\r\n  this.once = once;\r\n  this.off = off;\r\n  this.fire = fire;\r\n}\r\n\r\n\r\nmodule.exports = EventBus;\n},{}],41:[function(require,module,exports){\n'use strict';\r\n\r\n/**\r\n * Creates a gfx container for shapes and connections\r\n *\r\n * The layout is as follows:\r\n *\r\n * <g data-element-id=\"element-1\" class=\"djs-group djs-(type=shape|connection)\">\r\n *   <g class=\"djs-visual\">\r\n *     <!-- the renderer draws in here -->\r\n *   </g>\r\n *\r\n *   <!-- extensions (overlays, click box, ...) goes here\r\n * </g>\r\n *\r\n * @param {Object} root\r\n * @param {String} type the type of the element, i.e. shape | connection\r\n */\r\nfunction createContainer(root, type) {\r\n  var gfxContainer = root.group();\r\n\r\n  gfxContainer\r\n    .addClass('djs-group')\r\n    .addClass('djs-' + type);\r\n\r\n  var gfxGroup = gfxContainer.group().addClass('djs-visual');\r\n\r\n  return gfxContainer;\r\n}\r\n\r\n/**\r\n * Clears the graphical representation of the element and returns the\r\n * cleared result (the <g class=\"djs-visual\" /> element).\r\n */\r\nfunction clearVisual(gfx) {\r\n\r\n  var oldVisual = gfx.select('.djs-visual');\r\n\r\n  var newVisual = gfx.group().addClass('djs-visual').before(oldVisual);\r\n\r\n  oldVisual.remove();\r\n\r\n  return newVisual;\r\n}\r\n\r\n\r\nfunction createContainerFactory(type) {\r\n  return function(root, data) {\r\n    return createContainer(root, type).attr('data-element-id', data.id);\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * A factory that creates graphical elements\r\n *\r\n * @param {Renderer} renderer\r\n * @param {Snap} snap\r\n */\r\nfunction GraphicsFactory(renderer, snap) {\r\n  this._renderer = renderer;\r\n  this._snap = snap;\r\n}\r\n\r\nGraphicsFactory.prototype.createShape = createContainerFactory('shape');\r\n\r\nGraphicsFactory.prototype.createConnection = createContainerFactory('connection');\r\n\r\nGraphicsFactory.prototype.createPaper = function(options) {\r\n  return this._snap.createSnapAt(options.width, options.height, options.container);\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateShape = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n\r\n  // redraw\r\n  this._renderer.drawShape(gfxGroup, element);\r\n\r\n  // update positioning\r\n  gfx.translate(element.x, element.y);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateConnection = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n  this._renderer.drawConnection(gfxGroup, element);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.$inject = [ 'renderer', 'snap' ];\r\n\r\nmodule.exports = GraphicsFactory;\n},{}],42:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * Implements re- and undoable addition of connections to the diagram\r\n *\r\n * @param {EventBus} events\r\n * @param {GraphicsFactory} graphicsFactory\r\n * @param {ElementRegistry} shapes\r\n */\r\nfunction AddConnectionHandler(events, graphicsFactory, shapes) {\r\n\r\n  var paper;\r\n\r\n  /**\r\n   * Execute add\r\n   */\r\n  function execute(ctx) {\r\n\r\n    var connection = ctx.connection;\r\n\r\n    var gfx = graphicsFactory.createConnection(paper, connection);\r\n\r\n    events.fire('connection.changed', { element: connection, gfx: gfx });\r\n    events.fire('connection.added', { element: connection, gfx: gfx });\r\n\r\n    return gfx;\r\n  }\r\n\r\n\r\n  /**\r\n   * Execute revert\r\n   */\r\n  function revert(ctx) {\r\n\r\n    var connection = ctx.connection,\r\n        gfx = shapes.getGraphicsByElement(connection);\r\n\r\n    events.fire('connection.removed', { element: connection, gfx: gfx });\r\n\r\n    gfx.remove();\r\n  }\r\n\r\n\r\n  function canExecute(ctx) {\r\n    return true;\r\n  }\r\n\r\n\r\n  // load paper from canvas init event\r\n  events.on('canvas.init', function(e) {\r\n    paper = e.paper;\r\n  });\r\n\r\n\r\n  // API\r\n\r\n  this.execute = execute;\r\n  this.revert = revert;\r\n\r\n  this.canExecute = canExecute;\r\n}\r\n\r\n\r\nAddConnectionHandler.$inject = ['eventBus', 'graphicsFactory', 'elementRegistry'];\r\n\r\n// export\r\nmodule.exports = AddConnectionHandler;\n},{}],43:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._),\r\n    setParent = require('../../util/ShapeUtil').setParent;\r\n\r\n\r\n/**\r\n * Implements re- and undoable addition of shapes to the diagram\r\n *\r\n * @param {EventBus} events\r\n * @param {GraphicsFactory} graphicsFactory\r\n * @param {ElementRegistry} shapes\r\n */\r\nfunction AddShapeHandler(events, graphicsFactory, shapes) {\r\n\r\n  var paper;\r\n\r\n  /**\r\n   * Execute add\r\n   */\r\n  function execute(ctx) {\r\n\r\n    var shape = ctx.shape,\r\n        parent = ctx.parent || shape.parent;\r\n\r\n    // remember parent outside shape\r\n    ctx.parent = parent;\r\n\r\n    // establish shape -> parent -> shape relationship\r\n    setParent(shape, parent);\r\n\r\n    var gfx = graphicsFactory.createShape(paper, shape);\r\n\r\n    events.fire('shape.changed', { element: shape, gfx: gfx });\r\n\r\n    events.fire('shape.added', { element: shape, gfx: gfx });\r\n\r\n    return gfx;\r\n  }\r\n\r\n\r\n  /**\r\n   * Execute revert\r\n   */\r\n  function revert(ctx) {\r\n\r\n    var shape = ctx.shape,\r\n        gfx = shapes.getGraphicsByElement(shape);\r\n\r\n    setParent(shape, null);\r\n\r\n    events.fire('shape.removed', { element: shape, gfx: gfx });\r\n\r\n    gfx.remove();\r\n  }\r\n\r\n\r\n  function canExecute(ctx) {\r\n    return true;\r\n  }\r\n\r\n\r\n  // load paper from canvas init event\r\n  events.on('canvas.init', function(e) {\r\n    paper = e.paper;\r\n  });\r\n\r\n\r\n  // API\r\n\r\n  this.execute = execute;\r\n  this.revert = revert;\r\n\r\n  this.canExecute = canExecute;\r\n}\r\n\r\n\r\nAddShapeHandler.$inject = ['eventBus', 'graphicsFactory', 'elementRegistry'];\r\n\r\n// export\r\nmodule.exports = AddShapeHandler;\n},{\"../../util/ShapeUtil\":59}],44:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __depends__: [ require('../draw') ],\r\n  __init__: [ 'canvas' ],\r\n  canvas: [ 'type', require('./Canvas') ],\r\n  commandStack: [ 'type', require('./CommandStack') ],\r\n  elementRegistry: [ 'type', require('./ElementRegistry') ],\r\n  eventBus: [ 'type', require('./EventBus') ],\r\n  graphicsFactory: [ 'type', require('./GraphicsFactory') ]\r\n};\n},{\"../draw\":48,\"./Canvas\":37,\"./CommandStack\":38,\"./ElementRegistry\":39,\"./EventBus\":40,\"./GraphicsFactory\":41}],45:[function(require,module,exports){\n'use strict';\r\n\r\n// required components\r\n\r\nfunction flattenPoints(points) {\r\n  var result = [];\r\n\r\n  for (var i = 0, p; !!(p = points[i]); i++) {\r\n    result.push(p.x);\r\n    result.push(p.y);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n\r\n/**\r\n * @class Renderer\r\n *\r\n * The default renderer used for shapes and connections.\r\n *\r\n * @param {Styles} styles\r\n */\r\nfunction Renderer(styles) {\r\n  this.CONNECTION_STYLE = styles.style([ 'no-fill' ]);\r\n  this.SHAPE_STYLE = styles.style({ fill: 'fuchsia' });\r\n}\r\n\r\nRenderer.prototype.drawShape = function drawShape(gfxGroup, data) {\r\n  if (!data.width || !data.height) {\r\n    throw new Error('must specify width and height properties for new shape');\r\n  }\r\n\r\n  return gfxGroup.rect(0, 0, data.width, data.height, 10, 10).attr(this.SHAPE_STYLE);\r\n};\r\n\r\nRenderer.prototype.drawConnection = function drawConnection(gfxGroup, data) {\r\n  var points = flattenPoints(data.waypoints);\r\n  return gfxGroup.polyline(points).attr(this.CONNECTION_STYLE);\r\n};\r\n\r\n\r\nRenderer.$inject = ['styles'];\r\n\r\n\r\nmodule.exports = Renderer;\r\nmodule.exports.flattenPoints = flattenPoints;\n},{}],46:[function(require,module,exports){\nvar snapsvg = (window.Snap);\r\n\r\n// require snapsvg extensions\r\nrequire('./snapsvg-extensions');\r\n\r\nmodule.exports = snapsvg;\n},{\"./snapsvg-extensions\":49}],47:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * A component that manages shape styles\r\n */\r\nfunction Styles() {\r\n\r\n  var defaultTraits = {\r\n\r\n    'no-fill': {\r\n      fill: 'none'\r\n    },\r\n    'no-border': {\r\n      strokeOpacity: 0.0\r\n    },\r\n    'no-events': {\r\n      pointerEvents: 'none'\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a className, a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {String} className\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.cls = function(className, traits, additionalAttrs) {\r\n    var attrs = this.style(traits, additionalAttrs);\r\n\r\n    return _.extend(attrs, { 'class': className });\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.style = function(traits, additionalAttrs) {\r\n\r\n    if (!_.isArray(traits) && !additionalAttrs) {\r\n      additionalAttrs = traits;\r\n      traits = [];\r\n    }\r\n\r\n    var attrs = _.inject(traits, function(attrs, t) {\r\n      return _.extend(attrs, defaultTraits[t] || {});\r\n    }, {});\r\n\r\n    return additionalAttrs ? _.extend(attrs, additionalAttrs) : attrs;\r\n  };\r\n}\r\n\r\nmodule.exports = Styles;\n},{}],48:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  renderer: [ 'type', require('./Renderer') ],\r\n  snap: [ 'value', require('./Snap') ],\r\n  styles: [ 'type', require('./Styles') ]\r\n};\n},{\"./Renderer\":45,\"./Snap\":46,\"./Styles\":47}],49:[function(require,module,exports){\n'use strict';\r\n\r\nvar Snap = (window.Snap);\r\n\r\n/**\r\n * @module snapsvg/extensions\r\n */\r\n\r\n/**\r\n * @namespace snapsvg\r\n */\r\n\r\n/**\r\n * @class snapsvg.Element\r\n */\r\n\r\n/**\r\n * @class ClassPlugin\r\n *\r\n * Extends snapsvg with methods to add and remove classes\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  function split(str) {\r\n    return str.split(/\\s+/);\r\n  }\r\n\r\n  function join(array) {\r\n    return array.join(' ');\r\n  }\r\n\r\n  function getClasses(e) {\r\n    return split(e.attr('class') || '');\r\n  }\r\n\r\n  function setClasses(e, classes) {\r\n    e.attr('class', join(classes));\r\n  }\r\n\r\n  /**\r\n   * @method snapsvg.Element#addClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'selector');\r\n   *\r\n   * e.addClass('foo bar'); // adds classes foo and bar\r\n   * e.attr('class'); // -> 'selector foo bar'\r\n   *\r\n   * e.addClass('fooBar');\r\n   * e.attr('class'); // -> 'selector foo bar fooBar'\r\n   *\r\n   * @param {String} cls classes to be added to the element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.addClass = function(cls) {\r\n    var current = getClasses(this),\r\n        add = split(cls),\r\n        i, e;\r\n\r\n    for (i = 0, e; !!(e = add[i]); i++) {\r\n      if (current.indexOf(e) === -1) {\r\n        current.push(e);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#hasClass\r\n   *\r\n   * @param  {String}  cls the class to query for\r\n   * @return {Boolean} returns true if the element has the given class\r\n   */\r\n  Element.prototype.hasClass = function(cls) {\r\n    if (!cls) {\r\n      throw new Error('[snapsvg] syntax: hasClass(clsStr)');\r\n    }\r\n\r\n    return getClasses(this).indexOf(cls) !== -1;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#removeClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'foo bar');\r\n   *\r\n   * e.removeClass('foo');\r\n   * e.attr('class'); // -> 'bar'\r\n   *\r\n   * e.removeClass('foo bar'); // removes classes foo and bar\r\n   * e.attr('class'); // -> ''\r\n   *\r\n   * @param {String} cls classes to be removed from element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.removeClass = function(cls) {\r\n    var current = getClasses(this),\r\n        remove = split(cls),\r\n        i, e, idx;\r\n\r\n    for (i = 0, e; !!(e = remove[i]); i++) {\r\n      idx = current.indexOf(e);\r\n\r\n      if (idx !== -1) {\r\n        // remove element from array\r\n        current.splice(idx, 1);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n});\r\n\r\n/**\r\n * @class TranslatePlugin\r\n *\r\n * Extends snapsvg with methods to translate elements\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.Element#translate\r\n   *\r\n   * @example\r\n   *\r\n   * e.translate(10, 20);\r\n   *\r\n   * // sets transform matrix to translate(10, 20)\r\n   *\r\n   * @param {Number} x translation\r\n   * @param {Number} y translation\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.translate = function(x, y) {\r\n    var matrix = new Snap.Matrix();\r\n    matrix.translate(x, y);\r\n    this.transform(matrix);\r\n  };\r\n});\r\n\r\n/**\r\n * @class CreatSnapAtPlugin\r\n *\r\n * Extends snap.svg with a method to create a SVG element\r\n * at a specific position in the DOM.\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.createSnapAt\r\n   *\r\n   * @example\r\n   *\r\n   * snapsvg.createSnapAt(parentNode, 200, 200);\r\n   *\r\n   * @param {Number} width of svg\r\n   * @param {Number} height of svg\r\n   * @param {Object} parentNode svg Element will be child of this\r\n   *\r\n   * @return {snapsvg.Element} the newly created wrapped SVG element instance\r\n   */\r\n  Snap.createSnapAt = function(width, height, parentNode) {\r\n\r\n    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n    svg.setAttribute('width', width);\r\n    svg.setAttribute('height', height);\r\n    if (!parentNode) {\r\n      parentNode = document.body;\r\n    }\r\n    parentNode.appendChild(svg);\r\n\r\n    return new Snap(svg);\r\n  };\r\n});\n},{}],50:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar GraphicsUtil = require('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that provides interactivity in terms of events (mouse over and selection to a diagram).\r\n *\r\n * @param {EventBus} events the event bus to attach to\r\n */\r\nfunction InteractionEvents(events, styles) {\r\n\r\n  var HIT_STYLE = styles.cls('djs-hit', [ 'no-fill', 'no-border' ], {\r\n    pointerEvents: 'stroke',\r\n    stroke: 'white',\r\n    strokeWidth: 10\r\n  });\r\n\r\n  function isCtxSwitch(e) {\r\n    return !e.relatedTarget || e.target.parentNode !== e.relatedTarget.parentNode;\r\n  }\r\n\r\n  function fire(event, baseEvent, eventName) {\r\n    var e = _.extend({}, baseEvent, event);\r\n    events.fire(eventName, e);\r\n  }\r\n\r\n  function makeSelectable(element, gfx, options) {\r\n    var dblclick = options.dblclick,\r\n        type = options.type;\r\n\r\n    var baseEvent = { element: element, gfx: gfx };\r\n\r\n    var visual = GraphicsUtil.getVisual(gfx);\r\n\r\n    var hit;\r\n\r\n    if (type === 'shape') {\r\n      var bbox = visual.getBBox();\r\n      hit = gfx.rect(bbox.x, bbox.y, bbox.width, bbox.height);\r\n    } else {\r\n      hit = visual.select('*').clone().attr('style', '');\r\n    }\r\n\r\n    hit.attr(HIT_STYLE).prependTo(gfx);\r\n\r\n    gfx.hover(function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        /**\r\n         * An event indicating that shape|connection has been hovered\r\n         *\r\n         * shape.hover, connection.hover\r\n         */\r\n        fire(e, baseEvent, type + '.hover');\r\n      }\r\n    }, function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        fire(e, baseEvent, type + '.out');\r\n      }\r\n    });\r\n\r\n    gfx.click(function(e) {\r\n      fire(e, baseEvent, type + '.click');\r\n    });\r\n\r\n    gfx.dblclick(function(e) {\r\n      fire(e, baseEvent, type + '.dblclick');\r\n    });\r\n  }\r\n\r\n  function makeConnectionSelectable(connection, gfx) {\r\n    makeSelectable(connection, gfx, { type: 'connection' });\r\n  }\r\n\r\n  function makeShapeSelectable(shape, gfx) {\r\n    makeSelectable(shape, gfx, { type: 'shape' });\r\n  }\r\n\r\n  function registerEvents(events) {\r\n\r\n    events.on('canvas.init', function(event) {\r\n      var paper = event.paper;\r\n\r\n      // implement direct canvas click\r\n      paper.click(function(event) {\r\n\r\n        /**\r\n         * An event indicating that the canvas has been directly clicked\r\n         *\r\n         * @memberOf InteractionEvents\r\n         *\r\n         * @event canvas.click\r\n         *\r\n         * @type {Object}\r\n         */\r\n        events.fire('canvas.click', _.extend({}, event, { paper: paper }));\r\n      });\r\n    });\r\n\r\n    events.on('shape.added', function(event) {\r\n      makeShapeSelectable(event.element, event.gfx);\r\n    });\r\n\r\n    events.on('connection.added', function(event) {\r\n      makeConnectionSelectable(event.element, event.gfx);\r\n    });\r\n  }\r\n\r\n  registerEvents(events);\r\n}\r\n\r\n\r\nInteractionEvents.$inject = [ 'eventBus', 'styles' ];\r\n\r\nmodule.exports = InteractionEvents;\n},{\"../../util/GraphicsUtil\":57}],51:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'interactionEvents' ],\r\n  interactionEvents: [ 'type', require('./InteractionEvents') ]\r\n};\n},{\"./InteractionEvents\":50}],52:[function(require,module,exports){\n'use strict';\r\n\r\n\r\nvar GraphicsUtil = require('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds an outline to shapes and connections that may be activated and styled\r\n * via CSS classes.\r\n *\r\n * @param {EventBus} events the event bus\r\n */\r\nfunction Outline(events, styles) {\r\n\r\n  var OUTLINE_OFFSET = 5;\r\n\r\n  var OUTLINE_STYLE = styles.cls('djs-outline', [ 'no-fill' ]);\r\n\r\n  function createOutline(gfx) {\r\n    return gfx.rect(0, 0, 0, 0)\r\n            .attr(OUTLINE_STYLE)\r\n            .prependTo(gfx);\r\n  }\r\n\r\n  function updateOutline(outline, bbox) {\r\n\r\n    outline.attr({\r\n      x: bbox.x - OUTLINE_OFFSET,\r\n      y: bbox.y - OUTLINE_OFFSET,\r\n      width: bbox.width + OUTLINE_OFFSET * 2,\r\n      height: bbox.height + OUTLINE_OFFSET * 2\r\n    });\r\n  }\r\n\r\n  events.on('shape.added', function(event) {\r\n    var element = event.element,\r\n        gfx = event.gfx;\r\n\r\n    var outline = createOutline(gfx);\r\n\r\n    updateOutline(outline, GraphicsUtil.getVisual(gfx).getBBox());\r\n  });\r\n\r\n  events.on('connection.change', function(event) {\r\n    // TODO: update connection outline box\r\n  });\r\n\r\n  events.on('shape.change', function(event) {\r\n    // TODO: update shape outline box\r\n  });\r\n}\r\n\r\n\r\nOutline.$inject = ['eventBus', 'styles'];\r\n\r\nmodule.exports = Outline;\n},{\"../../util/GraphicsUtil\":57}],53:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'outline' ],\r\n  outline: [ 'type', require('./Outline') ]\r\n};\n},{\"./Outline\":52}],54:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A service that offers the current selection in a diagram.\r\n * Offers the api to control the selection, too.\r\n *\r\n * @param {EventBus} events the event bus\r\n */\r\nfunction Selection(events) {\r\n\r\n  var selectedElements = [];\r\n\r\n  function getSelection() {\r\n    return selectedElements;\r\n  }\r\n\r\n  function isSelected(shape) {\r\n    return selectedElements.indexOf(shape) !== -1;\r\n  }\r\n\r\n  /**\r\n   * This method selects one or more elements on the diagram.\r\n   *\r\n   * By passing an additional add parameter you can decide whether or not the element(s)\r\n   * should be added to the already existing selection or not.\r\n   *\r\n   * @method Selection#select\r\n   *\r\n   * @param  {Object|Object[]} elements element or array of elements to be selected\r\n   * @param  {boolean} [add] whether the element(s) should be appended to the current selection, defaults to false\r\n   */\r\n  function select(elements, add) {\r\n    var oldSelection = selectedElements.slice();\r\n\r\n    if (!_.isArray(elements)) {\r\n      elements = elements ? [ elements ] : [];\r\n    }\r\n\r\n    // selection may be cleared by passing an empty array or null\r\n    // to the method\r\n    if (elements.length && add) {\r\n      _.forEach(elements, function(element) {\r\n        if (selectedElements.indexOf(element) !== -1) {\r\n          // already selected\r\n          return;\r\n        } else {\r\n          selectedElements.push(element);\r\n        }\r\n      });\r\n    } else {\r\n      selectedElements = elements.slice();\r\n    }\r\n\r\n    events.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\r\n  }\r\n\r\n  function deselect(element) {\r\n    throw new Error('not implemented');\r\n  }\r\n\r\n  return {\r\n    getSelection: getSelection,\r\n    isSelected: isSelected,\r\n    select: select,\r\n    deselect: deselect\r\n  };\r\n}\r\n\r\nSelection.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = Selection;\n},{}],55:[function(require,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds a visible selection UI to shapes and connections\r\n * by appending the <code>hover</code> and <code>selected</code> classes to them.\r\n *\r\n * Makes elements selectable, too.\r\n *\r\n * @param {EventBus} events\r\n * @param {SelectionService} selection\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction SelectionVisuals(events, selection, elementRegistry) {\r\n\r\n  var HOVER_CLS = 'hover',\r\n      SELECTED_CLS = 'selected';\r\n\r\n  function addMarker(gfx, cls) {\r\n    gfx.addClass(cls);\r\n  }\r\n\r\n  function removeMarker(gfx, cls) {\r\n    gfx.removeClass(cls);\r\n  }\r\n\r\n  /**\r\n   * Wire click on shape to select the shape\r\n   *\r\n   * @param  {Object} event the fired event\r\n   */\r\n  events.on('shape.click', function(event) {\r\n    var add = event.shiftKey;\r\n    selection.select(event.element, add);\r\n  });\r\n\r\n  events.on('shape.hover', function(event) {\r\n    addMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('shape.out', function(event) {\r\n    removeMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('selection.changed', function(event) {\r\n\r\n    function deselect(s) {\r\n      addMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    function select(s) {\r\n      removeMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    var oldSelection = event.oldSelection,\r\n        newSelection = event.newSelection;\r\n\r\n    _.forEach(oldSelection, function(e) {\r\n      if (newSelection.indexOf(e) === -1) {\r\n        select(e);\r\n      }\r\n    });\r\n\r\n    _.forEach(newSelection, function(e) {\r\n      if (oldSelection.indexOf(e) === -1) {\r\n        deselect(e);\r\n      }\r\n    });\r\n  });\r\n\r\n  // deselect all selected shapes on canvas click\r\n  events.on('canvas.click', function(event) {\r\n    if (event.srcElement === event.paper.node) {\r\n      selection.select(null);\r\n    }\r\n  });\r\n}\r\n\r\nSelectionVisuals.$inject = [\r\n  'eventBus',\r\n  'selection',\r\n  'elementRegistry'\r\n];\r\n\r\nmodule.exports = SelectionVisuals;\n},{}],56:[function(require,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'selectionVisuals' ],\r\n  __depends__: [\r\n    require('../interaction-events'),\r\n    require('../outline')\r\n  ],\r\n  selection: [ 'type', require('./Selection') ],\r\n  selectionVisuals: [ 'type', require('./SelectionVisuals') ]\r\n};\n},{\"../interaction-events\":51,\"../outline\":53,\"./Selection\":54,\"./SelectionVisuals\":55}],57:[function(require,module,exports){\n'use strict';\r\n\r\n/**\r\n * @module util/GraphicsUtil\r\n */\r\n\r\nfunction is(e, cls) {\r\n  return e.hasClass(cls);\r\n}\r\n\r\n\r\n/**\r\n *\r\n * A note on how SVG elements are structured:\r\n *\r\n * Shape layout:\r\n *\r\n * [group.djs-group.djs-shape]\r\n *  |-> [rect.djs-hit]\r\n *  |-> [rect.djs-visual]\r\n *  |-> [rect.djs-outline]\r\n *  ...\r\n *\r\n * [group.djs-group.djs-connection]\r\n *  |-> [polyline.djs-hit]\r\n *  |-> [polyline.djs-visual]\r\n *  |-> [polyline.djs-outline]\r\n *  ...\r\n *\r\n */\r\n\r\n/**\r\n * Returns the visual part of a diagram element\r\n *\r\n * @param  {snapsvg.Element} gfx\r\n * @return {snapsvg.Element}\r\n */\r\nfunction getVisual(gfx) {\r\n  return gfx.select('.djs-visual');\r\n}\r\n\r\nmodule.exports.getVisual = getVisual;\n},{}],58:[function(require,module,exports){\nvar _ = (window._);\r\n\r\nvar DEFAULT_BOX_PADDING = 5;\r\n\r\nvar DEFAULT_LABEL_SIZE = {\r\n  width: 150,\r\n  height: 50\r\n};\r\n\r\n\r\nfunction parseAlign(align) {\r\n\r\n  var parts = align.split('-');\r\n\r\n  return {\r\n    horizontal: parts[0] || 'center',\r\n    vertical: parts[1] || 'top'\r\n  };\r\n}\r\n\r\nfunction parsePadding(padding) {\r\n\r\n  if (_.isObject(padding)) {\r\n    return _.extend({ top: 0, left: 0, right: 0, bottom: 0 }, padding);\r\n  } else {\r\n    return {\r\n      top: padding,\r\n      left: padding,\r\n      right: padding,\r\n      bottom: padding\r\n    };\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Creates a new label utility\r\n *\r\n * @param {Object} config\r\n * @param {Dimensions} config.size\r\n * @param {Number} config.padding\r\n * @param {Object} config.style\r\n * @param {String} config.align\r\n */\r\nfunction LabelUtil(config) {\r\n\r\n  config = _.extend({}, {\r\n    size: DEFAULT_LABEL_SIZE,\r\n    padding: DEFAULT_BOX_PADDING,\r\n    style: {},\r\n    align: 'center-top'\r\n  }, config || {});\r\n\r\n  /**\r\n   * Create a label in the parent node.\r\n   *\r\n   * @method LabelUtil#createLabel\r\n   *\r\n   * @param {SVGElement} parent the parent to draw the label on\r\n   * @param {String} text the text to render on the label\r\n   * @param {Object} options\r\n   * @param {String} options.align how to align in the bounding box.\r\n   *                             Any of { 'center-middle', 'center-top' }, defaults to 'center-top'.\r\n   * @param {String} options.style style to be applied to the text\r\n   *\r\n   * @return {SVGText} the text element created\r\n   */\r\n  function createLabel(parent, text, options) {\r\n\r\n    var box = _.merge({}, config.size, options.box || {}),\r\n        style = _.merge({}, config.style, options.style || {}),\r\n        align = parseAlign(options.align || config.align),\r\n        padding = parsePadding(options.padding !== undefined ? options.padding : config.padding);\r\n\r\n    var lines = text.split(/\\r?\\n/g),\r\n        layouted = [];\r\n\r\n    var maxWidth = box.width - padding.left - padding.right;\r\n\r\n    /**\r\n     * Layout the next line and return the layouted element.\r\n     *\r\n     * Alters the lines passed.\r\n     *\r\n     * @param  {Array<String>} lines\r\n     * @return {Object} the line descriptor, an object { width, height, text }\r\n     */\r\n    function layoutNext(lines) {\r\n\r\n      var originalLine = lines.shift(),\r\n          fitLine = originalLine;\r\n\r\n      var textBBox;\r\n\r\n      function fit() {\r\n        if (fitLine.length < originalLine.length) {\r\n          var nextLine = lines[0] || '',\r\n              remainder = originalLine.slice(fitLine.length);\r\n\r\n          if (/-\\s*$/.test(remainder)) {\r\n            nextLine = remainder.replace(/-\\s*$/, '') + nextLine.replace(/^\\s+/, '');\r\n          } else {\r\n            nextLine = remainder + ' ' + nextLine;\r\n          }\r\n\r\n          lines[0] = nextLine;\r\n        }\r\n        return { width: textBBox.width, height: textBBox.height, text: fitLine };\r\n      }\r\n\r\n      function getTextBBox(text) {\r\n        var textElement = parent.text(0, 0, fitLine).attr(style);\r\n\r\n        var bbox = textElement.getBBox();\r\n\r\n        textElement.remove();\r\n        return bbox;\r\n      }\r\n\r\n      /**\r\n       * Shortens a line based on spacing and hyphens.\r\n       * Returns the shortened result on success.\r\n       *\r\n       * @param  {String} line\r\n       * @param  {Number} maxLength the maximum characters of the string\r\n       * @return {String} the shortened string\r\n       */\r\n      function semanticShorten(line, maxLength) {\r\n        var parts = line.split(/(\\s|-)/g),\r\n            part,\r\n            shortenedParts = [],\r\n            length = 0;\r\n\r\n        // try to shorten via spaces + hyphens\r\n        if (parts.length > 1) {\r\n          while ((part = parts.shift())) {\r\n\r\n            if (part.length + length < maxLength) {\r\n              shortenedParts.push(part);\r\n              length += part.length;\r\n            } else {\r\n              // remove previous part, too if hyphen does not fit anymore\r\n              if (part === '-') {\r\n                shortenedParts.pop();\r\n              }\r\n\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        return shortenedParts.join('');\r\n      }\r\n\r\n      function shortenLine(line, width, maxWidth) {\r\n        var shortenedLine = '';\r\n\r\n        var approximateLength = line.length * (maxWidth / width);\r\n\r\n        // try to shorten semantically (i.e. based on spaces and hyphens)\r\n        shortenedLine = semanticShorten(line, approximateLength);\r\n\r\n        if (!shortenedLine) {\r\n\r\n          // force shorten by cutting the long word\r\n          shortenedLine = line.slice(0, Math.floor(approximateLength - 1));\r\n        }\r\n\r\n        return shortenedLine;\r\n      }\r\n\r\n\r\n      while (true) {\r\n\r\n        textBBox = getTextBBox(fitLine);\r\n\r\n        // try to fit\r\n        if (textBBox.width < maxWidth) {\r\n          return fit();\r\n        }\r\n\r\n        fitLine = shortenLine(fitLine, textBBox.width, maxWidth);\r\n      }\r\n    }\r\n\r\n    while (lines.length) {\r\n      layouted.push(layoutNext(lines));\r\n    }\r\n\r\n    var totalHeight = _.reduce(layouted, function(sum, line, idx) {\r\n      return sum + line.height;\r\n    }, 0);\r\n\r\n\r\n    // the center x position to align against\r\n    var cx = box.width / 2;\r\n\r\n    // the y position of the next line\r\n    var y, x;\r\n\r\n    switch (align.vertical) {\r\n      case 'middle':\r\n        y = (box.height - totalHeight) / 2 - layouted[0].height / 4;\r\n        break;\r\n\r\n      default:\r\n        y = padding.top;\r\n    }\r\n\r\n    var textElement = parent.group().attr(style);\r\n\r\n    _.forEach(layouted, function(line) {\r\n      y += line.height;\r\n\r\n      switch (align.horizontal) {\r\n        case 'left':\r\n          x = padding.left;\r\n          break;\r\n\r\n        case 'right':\r\n          x = (maxWidth - padding.right - line.width);\r\n          break;\r\n\r\n        default:\r\n          // aka center\r\n          x = (maxWidth - line.width) / 2 + padding.left;\r\n      }\r\n\r\n\r\n      parent.text(x, y, line.text).appendTo(textElement);\r\n    });\r\n\r\n    return textElement;\r\n  }\r\n\r\n  // API\r\n  this.createLabel = createLabel;\r\n}\r\n\r\n\r\nmodule.exports = LabelUtil;\n},{}],59:[function(require,module,exports){\nvar _ = (window._);\r\n\r\n/**\r\n * Adds an element to a collection and returns true if the\r\n * element was added.\r\n *\r\n * @param {Object[]} elements\r\n * @param {Object} e\r\n * @param {Boolean} unique\r\n */\r\nfunction add(elements, e, unique) {\r\n  var canAdd = !unique || elements.indexOf(e) === -1;\r\n\r\n  if (canAdd) {\r\n    elements.push(e);\r\n  }\r\n\r\n  return canAdd;\r\n}\r\n\r\nfunction each(shapes, fn, depth) {\r\n\r\n  depth = depth || 0;\r\n\r\n  _.forEach(shapes, function(s, i) {\r\n    var filter = fn(s, i, depth);\r\n\r\n    if (_.isArray(filter) && filter.length) {\r\n      each(filter, fn, depth + 1);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Collects self + child shapes up to a given depth from a list of shapes.\r\n *\r\n * @param  {djs.ShapeDescriptor[]} shapes the shapes to select the children from\r\n * @param  {Boolean} unique whether to return a unique result set (no duplicates)\r\n * @param  {Number} maxDepth the depth to search through or -1 for infinite\r\n *\r\n * @return {djs.ShapeDescriptor[]} found shapes\r\n */\r\nfunction selfAndChildren(shapes, unique, maxDepth) {\r\n  var result = [],\r\n      processedChildren = [];\r\n\r\n  each(shapes, function(shape, i, depth) {\r\n    add(result, shape, unique);\r\n\r\n    var children = shape.children;\r\n\r\n    // max traversal depth not reached yet\r\n    if (maxDepth === -1 || depth < maxDepth) {\r\n\r\n      // children exist && children not yet processed\r\n      if (children && add(processedChildren, children, unique)) {\r\n        return children;\r\n      }\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Return self + direct children for a number of shapes\r\n *\r\n * @param  {djs.ShapeDescriptor[]} shapes to query\r\n * @param  {Boolean} allowDuplicates to allow duplicates in the result set\r\n *\r\n * @return {djs.ShapeDescriptor[]} the collected shapes\r\n */\r\nfunction selfAndDirectChildren(shapes, allowDuplicates) {\r\n  return selfAndChildren(shapes, !allowDuplicates, 1);\r\n}\r\n\r\n/**\r\n * Return self + ALL children for a number of shapes\r\n *\r\n * @param  {djs.ShapeDescriptor[]} shapes to query\r\n * @param  {Boolean} allowDuplicates to allow duplicates in the result set\r\n *\r\n * @return {djs.ShapeDescriptor[]} the collected shapes\r\n */\r\nfunction selfAndAllChildren(shapes, allowDuplicates) {\r\n  return selfAndChildren(shapes, !allowDuplicates, -1);\r\n}\r\n\r\n/**\r\n * Translate a shape\r\n * Move shape to shape.x + x and shape.y + y\r\n */\r\nfunction translateShape(shape, x, y) {\r\n  'use strict';\r\n\r\n  shape.x += x;\r\n  shape.y += y;\r\n}\r\n\r\nfunction setParent(shape, newParent) {\r\n  // TODO(nre): think about parent->child magic\r\n\r\n  var old = shape.parent;\r\n  if (old && old.children) {\r\n    var idx = old.children.indexOf(shape);\r\n    if (idx !== -1) {\r\n      old.children.splice(idx, 1);\r\n    }\r\n  }\r\n\r\n  if (newParent) {\r\n    if (!newParent.children) {\r\n      newParent.children = [];\r\n    }\r\n\r\n    newParent.children.push(shape);\r\n  }\r\n\r\n  shape.parent = newParent;\r\n\r\n  return old;\r\n}\r\n\r\nmodule.exports.eachShape = each;\r\nmodule.exports.selfAndDirectChildren = selfAndDirectChildren;\r\nmodule.exports.selfAndAllChildren = selfAndAllChildren;\r\nmodule.exports.translateShape = translateShape;\r\nmodule.exports.setParent = setParent;\n},{}],60:[function(require,module,exports){\n\r\nvar isArray = function(obj) {\r\n  return Object.prototype.toString.call(obj) === '[object Array]';\r\n};\r\n\r\nvar annotate = function() {\r\n  var args = Array.prototype.slice.call(arguments);\r\n  \r\n  if (args.length === 1 && isArray(args[0])) {\r\n    args = args[0];\r\n  }\r\n\r\n  var fn = args.pop();\r\n\r\n  fn.$inject = args;\r\n\r\n  return fn;\r\n};\r\n\r\n\r\n// Current limitations:\r\n// - can't put into \"function arg\" comments\r\n// function /* (no parenthesis like this) */ (){}\r\n// function abc( /* xx (no parenthesis like this) */ a, b) {}\r\n//\r\n// Just put the comment before function or inside:\r\n// /* (((this is fine))) */ function(a, b) {}\r\n// function abc(a) { /* (((this is fine))) */}\r\n\r\nvar FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\r\nvar FN_ARG = /\\/\\*([^\\*]*)\\*\\//m;\r\n\r\nvar parse = function(fn) {\r\n  if (typeof fn !== 'function') {\r\n    throw new Error('Cannot annotate \"' + fn + '\". Expected a function!');\r\n  }\r\n\r\n  var match = fn.toString().match(FN_ARGS);\r\n  return match[1] && match[1].split(',').map(function(arg) {\r\n    match = arg.match(FN_ARG);\r\n    return match ? match[1].trim() : arg.trim();\r\n  }) || [];\r\n};\r\n\r\n\r\nexports.annotate = annotate;\r\nexports.parse = parse;\r\nexports.isArray = isArray;\r\n\n},{}],61:[function(require,module,exports){\nmodule.exports = {\r\n  annotate: require('./annotation').annotate,\r\n  Module: require('./module'),\r\n  Injector: require('./injector')\r\n};\r\n\n},{\"./annotation\":60,\"./injector\":62,\"./module\":63}],62:[function(require,module,exports){\nvar Module = require('./module');\r\nvar autoAnnotate = require('./annotation').parse;\r\nvar annotate = require('./annotation').annotate;\r\nvar isArray = require('./annotation').isArray;\r\n\r\n\r\nvar Injector = function(modules, parent) {\r\n  parent = parent || {\r\n    get: function(name) {\r\n      currentlyResolving.push(name);\r\n      throw error('No provider for \"' + name + '\"!');\r\n    }\r\n  };\r\n\r\n  var currentlyResolving = [];\r\n  var providers = this._providers = Object.create(parent._providers || null);\r\n  var instances = this._instances = Object.create(null);\r\n\r\n  var self = instances.injector = this;\r\n\r\n  var error = function(msg) {\r\n    var stack = currentlyResolving.join(' -> ');\r\n    currentlyResolving.length = 0;\r\n    return new Error(stack ? msg + ' (Resolving: ' + stack + ')' : msg);\r\n  };\r\n\r\n  var get = function(name) {\r\n    if (!providers[name] && name.indexOf('.') !== -1) {\r\n      var parts = name.split('.');\r\n      var pivot = get(parts.shift());\r\n\r\n      while(parts.length) {\r\n        pivot = pivot[parts.shift()];\r\n      }\r\n\r\n      return pivot;\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(instances, name)) {\r\n      return instances[name];\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(providers, name)) {\r\n      if (currentlyResolving.indexOf(name) !== -1) {\r\n        currentlyResolving.push(name);\r\n        throw error('Cannot resolve circular dependency!');\r\n      }\r\n\r\n      currentlyResolving.push(name);\r\n      instances[name] = providers[name][0](providers[name][1]);\r\n      currentlyResolving.pop();\r\n\r\n      return instances[name];\r\n    }\r\n\r\n    return parent.get(name);\r\n  };\r\n\r\n  var instantiate = function(Type) {\r\n    var instance = Object.create(Type.prototype);\r\n    var returned = invoke(Type, instance);\r\n\r\n    return typeof returned === 'object' ? returned : instance;\r\n  };\r\n\r\n  var invoke = function(fn, context) {\r\n    if (typeof fn !== 'function') {\r\n      if (isArray(fn)) {\r\n        fn = annotate(fn.slice());\r\n      } else {\r\n        throw new Error('Cannot invoke \"' + fn + '\". Expected a function!');\r\n      }\r\n    }\r\n\r\n    var inject = fn.$inject && fn.$inject || autoAnnotate(fn);\r\n    var dependencies = inject.map(function(dep) {\r\n      return get(dep);\r\n    });\r\n\r\n    // TODO(vojta): optimize without apply\r\n    return fn.apply(context, dependencies);\r\n  };\r\n\r\n\r\n  var createPrivateInjectorFactory = function(privateChildInjector) {\r\n    return annotate(function(key) {\r\n      return privateChildInjector.get(key);\r\n    });\r\n  };\r\n\r\n  var createChild = function(modules, forceNewInstances) {\r\n    if (forceNewInstances && forceNewInstances.length) {\r\n      var fromParentModule = Object.create(null);\r\n      var matchedScopes = Object.create(null);\r\n\r\n      var privateInjectorsCache = [];\r\n      var privateChildInjectors = [];\r\n      var privateChildFactories = [];\r\n\r\n      var provider;\r\n      var cacheIdx;\r\n      var privateChildInjector;\r\n      var privateChildInjectorFactory;\r\n      for (var name in providers) {\r\n        provider = providers[name];\r\n\r\n        if (forceNewInstances.indexOf(name) !== -1) {\r\n          if (provider[2] === 'private') {\r\n            cacheIdx = privateInjectorsCache.indexOf(provider[3]);\r\n            if (cacheIdx === -1) {\r\n              privateChildInjector = provider[3].createChild([], forceNewInstances);\r\n              privateChildInjectorFactory = createPrivateInjectorFactory(privateChildInjector);\r\n              privateInjectorsCache.push(provider[3]);\r\n              privateChildInjectors.push(privateChildInjector);\r\n              privateChildFactories.push(privateChildInjectorFactory);\r\n              fromParentModule[name] = [privateChildInjectorFactory, name, 'private', privateChildInjector];\r\n            } else {\r\n              fromParentModule[name] = [privateChildFactories[cacheIdx], name, 'private', privateChildInjectors[cacheIdx]];\r\n            }\r\n          } else {\r\n            fromParentModule[name] = [provider[2], provider[1]];\r\n          }\r\n          matchedScopes[name] = true;\r\n        }\r\n\r\n        if ((provider[2] === 'factory' || provider[2] === 'type') && provider[1].$scope) {\r\n          forceNewInstances.forEach(function(scope) {\r\n            if (provider[1].$scope.indexOf(scope) !== -1) {\r\n              fromParentModule[name] = [provider[2], provider[1]];\r\n              matchedScopes[scope] = true;\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      forceNewInstances.forEach(function(scope) {\r\n        if (!matchedScopes[scope]) {\r\n          throw new Error('No provider for \"' + scope + '\". Cannot use provider from the parent!');\r\n        }\r\n      });\r\n\r\n      modules.unshift(fromParentModule);\r\n    }\r\n\r\n    return new Injector(modules, self);\r\n  };\r\n\r\n  var factoryMap = {\r\n    factory: invoke,\r\n    type: instantiate,\r\n    value: function(value) {\r\n      return value;\r\n    }\r\n  };\r\n\r\n  modules.forEach(function(module) {\r\n\r\n    function arrayUnwrap(type, value) {\r\n      if (type !== 'value' && isArray(value)) {\r\n        value = annotate(value.slice());\r\n      }\r\n\r\n      return value;\r\n    }\r\n\r\n    // TODO(vojta): handle wrong inputs (modules)\r\n    if (module instanceof Module) {\r\n      module.forEach(function(provider) {\r\n        var name = provider[0];\r\n        var type = provider[1];\r\n        var value = provider[2];\r\n\r\n        providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n      });\r\n    } else if (typeof module === 'object') {\r\n      if (module.__exports__) {\r\n        var clonedModule = Object.keys(module).reduce(function(m, key) {\r\n          if (key.substring(0, 2) !== '__') {\r\n            m[key] = module[key];\r\n          }\r\n          return m;\r\n        }, Object.create(null));\r\n\r\n        var privateInjector = new Injector((module.__modules__ || []).concat([clonedModule]), self);\r\n        var getFromPrivateInjector = annotate(function(key) {\r\n          return privateInjector.get(key);\r\n        });\r\n        module.__exports__.forEach(function(key) {\r\n          providers[key] = [getFromPrivateInjector, key, 'private', privateInjector];\r\n        });\r\n      } else {\r\n        Object.keys(module).forEach(function(name) {\r\n          if (module[name][2] === 'private') {\r\n            providers[name] = module[name];\r\n            return;\r\n          }\r\n\r\n          var type = module[name][0];\r\n          var value = module[name][1];\r\n\r\n          providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  // public API\r\n  this.get = get;\r\n  this.invoke = invoke;\r\n  this.instantiate = instantiate;\r\n  this.createChild = createChild;\r\n};\r\n\r\nmodule.exports = Injector;\r\n\n},{\"./annotation\":60,\"./module\":63}],63:[function(require,module,exports){\nvar Module = function() {\r\n  var providers = [];\r\n\r\n  this.factory = function(name, factory) {\r\n    providers.push([name, 'factory', factory]);\r\n    return this;\r\n  };\r\n\r\n  this.value = function(name, value) {\r\n    providers.push([name, 'value', value]);\r\n    return this;\r\n  };\r\n\r\n  this.type = function(name, type) {\r\n    providers.push([name, 'type', type]);\r\n    return this;\r\n  };\r\n\r\n  this.forEach = function(iterator) {\r\n    providers.forEach(iterator);\r\n  };\r\n};\r\n\r\nmodule.exports = Module;\r\n\n},{}]},{},[])"]}